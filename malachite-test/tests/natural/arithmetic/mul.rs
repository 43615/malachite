use common::test_properties_custom_scale;
use malachite_base::num::{One, Zero};
use malachite_nz::natural::arithmetic::mul::{
    _limbs_mul_to_out_basecase, _limbs_mul_to_out_toom_22, _limbs_mul_to_out_toom_22_scratch_size,
    _limbs_mul_to_out_toom_32, _limbs_mul_to_out_toom_32_scratch_size, MUL_TOOM22_THRESHOLD,
};
use malachite_nz::natural::Natural;
use malachite_test::common::{
    biguint_to_natural, natural_to_biguint, natural_to_rug_integer, rug_integer_to_natural,
};
use malachite_test::inputs::base::{
    pairs_of_unsigneds, triples_of_unsigned_vec_var_10, triples_of_unsigned_vec_var_11,
    triples_of_unsigned_vec_var_12,
};
use malachite_test::inputs::natural::{
    naturals, pairs_of_natural_and_unsigned, pairs_of_naturals, triples_of_naturals,
};
use num::BigUint;
use rug;
use std::str::FromStr;

#[test]
fn test_limbs_mul_to_out() {
    let test = |xs, ys, out_before: &[u32], highest_result_limb, out_after| {
        let mut out = out_before.to_vec();
        assert_eq!(
            _limbs_mul_to_out_basecase(&mut out, xs, ys),
            highest_result_limb
        );
        assert_eq!(out, out_after);
    };
    test(&[2], &[3], &[10, 10, 10], 0, vec![6, 0, 10]);
    test(
        &[1, 1, 1],
        &[1, 2, 3],
        &[5, 5, 5, 5, 5, 5, 5, 5],
        0,
        vec![1, 3, 6, 5, 3, 0, 5, 5],
    );
    test(
        &[1, 2, 3],
        &[6, 7],
        &[0, 0, 0, 0, 0],
        0,
        vec![6, 19, 32, 21, 0],
    );
    test(
        &[100, 101, 102],
        &[102, 101, 100],
        &[10, 10, 10, 10, 10, 10, 10],
        0,
        vec![10_200, 20_402, 30_605, 20_402, 10_200, 0, 10],
    );
    test(
        &[0xffff_ffff],
        &[1],
        &[10, 10, 10],
        0,
        vec![0xffff_ffff, 0, 10],
    );
    test(
        &[0xffff_ffff],
        &[0xffff_ffff],
        &[10, 10, 10, 10],
        0xffff_fffe,
        vec![1, 0xffff_fffe, 10, 10],
    );
    test(
        &[0xffff_ffff, 0xffff_ffff, 0xffff_ffff],
        &[0xffff_ffff, 0xffff_ffff, 0xffff_ffff],
        &[10, 10, 10, 10, 10, 10],
        0xffff_ffff,
        vec![1, 0, 0, 0xffff_fffe, 0xffff_ffff, 0xffff_ffff],
    );
}

#[test]
#[should_panic(expected = "assertion failed: out_limbs.len() >= xs_len + ys_len")]
fn limbs_mul_to_out_fail_1() {
    let mut out = vec![10, 10, 10, 10];
    _limbs_mul_to_out_basecase(&mut out, &[6, 7, 8], &[1, 2]);
}

#[test]
#[should_panic(expected = "assertion failed: xs_len >= ys_len")]
fn limbs_mul_to_out_fail_2() {
    let mut out = vec![10, 10, 10, 10, 10];
    _limbs_mul_to_out_basecase(&mut out, &[6, 7], &[1, 2, 3]);
}

#[test]
#[should_panic(expected = "assertion failed: `(left != right)")]
fn limbs_mul_to_out_fail_3() {
    let mut out = vec![10, 10, 10];
    _limbs_mul_to_out_basecase(&mut out, &[6, 7], &[]);
}

#[test]
fn test_limbs_mul_to_out_toom_22() {
    let test = |xs: Vec<u32>, ys: Vec<u32>, out_before: Vec<u32>, out_after| {
        let mut scratch = vec![0; _limbs_mul_to_out_toom_22_scratch_size(xs.len())];
        let mut out = out_before.to_vec();
        _limbs_mul_to_out_basecase(&mut out, &xs, &ys);
        assert_eq!(out, out_after);
        let mut out = out_before.to_vec();
        _limbs_mul_to_out_toom_22(&mut out, &xs, &ys, &mut scratch);
        assert_eq!(out, out_after);
    };
    // s != n
    // !(xs0[s] == 0 && limbs_cmp_same_length(&xs0[..s], xs1) == Ordering::Less)
    // t != n
    // limbs_test_zero(&ys0[t..]) && limbs_cmp_same_length(&ys0[..t], ys1) != Ordering::Less
    // s <= t
    // !v_neg_1_neg
    // carry <= 2
    test(
        vec![2, 3, 4],
        vec![3, 4, 5],
        vec![10, 10, 10, 10, 10, 10],
        vec![6, 17, 34, 31, 20, 0],
    );
    // xs0[s] == 0 && limbs_cmp_same_length(&xs0[..s], xs1) == Ordering::Less
    // v_neg_1_neg
    //test(&[2, 0, 4], &[3, 4, 5], &[10, 10, 10, 10, 10, 10], vec![6, 8, 22, 16, 20, 0]);
    test(
        vec![1, 1, 1],
        vec![1, 2, 3],
        vec![5, 5, 5, 5, 5, 5, 5, 5],
        vec![1, 3, 6, 5, 3, 0, 5, 5],
    );
    // s == n
    // limbs_cmp_same_length(ys0, ys1) != Ordering::Less
    // t == n
    // limbs_cmp_same_length(ys0, ys1) == Ordering::Less
    test(
        vec![1, 1, 1, 1],
        vec![1, 2, 3, 4],
        vec![5, 5, 5, 5, 5, 5, 5, 5],
        vec![1, 3, 6, 10, 9, 7, 4, 0],
    );
    // limbs_cmp_same_length(&a0[..n], &a1[..n]) == Ordering::Less
    // limbs_cmp_same_length(&b0[..n], &b1[..n]) != Ordering::Less
    test(
        vec![1, 2, 3, 4],
        vec![1, 1, 1, 1],
        vec![5, 5, 5, 5, 5, 5, 5, 5],
        vec![1, 3, 6, 10, 9, 7, 4, 0],
    );
    // limbs_test_zero(&ys0[t..]) && limbs_cmp_same_length(&ys0[..t], ys1) == Ordering::Less
    test(
        vec![1, 2, 3, 4, 5],
        vec![1, 0, 0, 4],
        vec![5, 5, 5, 5, 5, 5, 5, 5, 5],
        vec![1, 2, 3, 8, 13, 12, 16, 20, 0],
    );
    // s > t
    // limbs_mul_to_out_basecase in limbs_mul_to_out_toom_22_recursive
    test(
        vec![1, 1, 1, 1],
        vec![1, 2, 3],
        vec![5, 5, 5, 5, 5, 5, 5, 5],
        vec![1, 3, 6, 6, 5, 3, 0, 5],
    );
    test(
        vec![100, 101, 102],
        vec![102, 101, 100],
        vec![10, 10, 10, 10, 10, 10, 10],
        vec![10_200, 20_402, 30_605, 20_402, 10_200, 0, 10],
    );
    // limbs_mul_to_out_basecase in limbs_mul_same_length_to_out_toom_22_recursive
    test(
        vec![0xffff_ffff, 0xffff_ffff, 0xffff_ffff],
        vec![0xffff_ffff, 0xffff_ffff, 0xffff_ffff],
        vec![10, 10, 10, 10, 10, 10],
        vec![1, 0, 0, 0xffff_fffe, 0xffff_ffff, 0xffff_ffff],
    );
    let xs = vec![
        4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
        4294967295, 4294950911, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
        4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
        4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
        4294967295, 4294967295, 536870911, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,
    ];
    let ys = vec![
        4294967295, 4294967295, 4294963199, 4294967295, 4294967295, 4294967295, 4294967295,
        4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
        4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
        268435455, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0,
    ];
    let out_len = xs.len() + ys.len();
    // carry > 2
    test(
        xs,
        ys,
        vec![10; out_len],
        vec![
            1, 0, 4096, 0, 0, 0, 0, 0, 16384, 0, 67108864, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            4026531840, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
            4294967295, 4294967295, 3758095359, 4294967295, 4294967295, 4294966783, 4294967295,
            4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
            4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
            4294967295, 4294967295, 4294967295, 33554431, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        ],
    );
    let limit = 2 * MUL_TOOM22_THRESHOLD;
    let mut long_xs = Vec::new();
    let mut long_ys = Vec::new();
    for i in 0..limit {
        long_xs.push(i as u32 + 1);
        long_ys.push((limit - i) as u32);
    }
    let long_out_limbs = vec![10; 2 * limit];
    // limbs_mul_to_out_toom_22 in limbs_mul_same_length_to_out_toom_22_recursive
    test(
        long_xs,
        long_ys,
        long_out_limbs,
        vec![
            60, 179, 356, 590, 880, 1225, 1624, 2076, 2580, 3135, 3740, 4394, 5096, 5845, 6640,
            7480, 8364, 9291, 10260, 11270, 12320, 13409, 14536, 15700, 16900, 18135, 19404, 20706,
            22040, 23405, 24800, 26224, 27676, 29155, 30660, 32190, 33744, 35321, 36920, 38540,
            40180, 41839, 43516, 45210, 46920, 48645, 50384, 52136, 53900, 55675, 57460, 59254,
            61056, 62865, 64680, 66500, 68324, 70151, 71980, 73810, 71980, 70151, 68324, 66500,
            64680, 62865, 61056, 59254, 57460, 55675, 53900, 52136, 50384, 48645, 46920, 45210,
            43516, 41839, 40180, 38540, 36920, 35321, 33744, 32190, 30660, 29155, 27676, 26224,
            24800, 23405, 22040, 20706, 19404, 18135, 16900, 15700, 14536, 13409, 12320, 11270,
            10260, 9291, 8364, 7480, 6640, 5845, 5096, 4394, 3740, 3135, 2580, 2076, 1624, 1225,
            880, 590, 356, 179, 60, 0,
        ],
    );
    let mut long_xs = Vec::new();
    let mut long_ys = Vec::new();
    for i in 0..limit + 2 {
        long_xs.push(i as u32 + 1);
    }
    for i in 0..limit + 1 {
        long_ys.push((limit + 1 - i) as u32);
    }
    let long_out_limbs = vec![10; 2 * limit + 3];
    // limbs_mul_to_out_toom_22 in limbs_mul_to_out_toom_22_recursive
    test(
        long_xs,
        long_ys,
        long_out_limbs,
        vec![
            61, 182, 362, 600, 895, 1246, 1652, 2112, 2625, 3190, 3806, 4472, 5187, 5950, 6760,
            7616, 8517, 9462, 10450, 11480, 12551, 13662, 14812, 16000, 17225, 18486, 19782, 21112,
            22475, 23870, 25296, 26752, 28237, 29750, 31290, 32856, 34447, 36062, 37700, 39360,
            41041, 42742, 44462, 46200, 47955, 49726, 51512, 53312, 55125, 56950, 58786, 60632,
            62487, 64350, 66220, 68096, 69977, 71862, 73750, 75640, 77531, 79422, 77470, 75520,
            73573, 71630, 69692, 67760, 65835, 63918, 62010, 60112, 58225, 56350, 54488, 52640,
            50807, 48990, 47190, 45408, 43645, 41902, 40180, 38480, 36803, 35150, 33522, 31920,
            30345, 28798, 27280, 25792, 24335, 22910, 21518, 20160, 18837, 17550, 16300, 15088,
            13915, 12782, 11690, 10640, 9633, 8670, 7752, 6880, 6055, 5278, 4550, 3872, 3245, 2670,
            2148, 1680, 1267, 910, 610, 368, 185, 62, 0,
        ],
    );
    let mut long_xs = Vec::new();
    let mut long_ys = Vec::new();
    assert_eq!(MUL_TOOM22_THRESHOLD, 30);
    // xs_len == 76, ys_len == 68 satisfy s > t && t >= MUL_TOOM22_THRESHOLD && 4 * s >= 5 * t
    for i in 0..76 {
        long_xs.push(i as u32 + 1);
    }
    for i in 0..68 {
        long_ys.push((68 - i) as u32);
    }
    let long_out_limbs = vec![10; 144];
    // limbs_mul_to_out_toom_32 in limbs_mul_to_out_toom_22_recursive
    test(
        long_xs,
        long_ys,
        long_out_limbs,
        vec![
            68, 203, 404, 670, 1000, 1393, 1848, 2364, 2940, 3575, 4268, 5018, 5824, 6685, 7600,
            8568, 9588, 10659, 11780, 12950, 14168, 15433, 16744, 18100, 19500, 20943, 22428,
            23954, 25520, 27125, 28768, 30448, 32164, 33915, 35700, 37518, 39368, 41249, 43160,
            45100, 47068, 49063, 51084, 53130, 55200, 57293, 59408, 61544, 63700, 65875, 68068,
            70278, 72504, 74745, 77000, 79268, 81548, 83839, 86140, 88450, 90768, 93093, 95424,
            97760, 100100, 102443, 104788, 107134, 109480, 111826, 114172, 116518, 118864, 121210,
            123556, 125902, 123012, 120131, 117260, 114400, 111552, 108717, 105896, 103090, 100300,
            97527, 94772, 92036, 89320, 86625, 83952, 81302, 78676, 76075, 73500, 70952, 68432,
            65941, 63480, 61050, 58652, 56287, 53956, 51660, 49400, 47177, 44992, 42846, 40740,
            38675, 36652, 34672, 32736, 30845, 29000, 27202, 25452, 23751, 22100, 20500, 18952,
            17457, 16016, 14630, 13300, 12027, 10812, 9656, 8560, 7525, 6552, 5642, 4796, 4015,
            3300, 2652, 2072, 1561, 1120, 750, 452, 227, 76, 0,
        ],
    );
}

#[test]
#[should_panic(expected = "assertion failed: s > 0 && (s == n || s == n - 1)")]
fn limbs_mul_to_out_toom_22_fail_1() {
    let mut scratch = vec![];
    let mut out = vec![10, 10, 10, 10];
    _limbs_mul_to_out_toom_22(&mut out, &[6], &[1], &mut scratch);
}

#[test]
#[should_panic(expected = "assertion failed: xs_len >= ys_len")]
fn limbs_mul_to_out_toom_22_fail_2() {
    let mut scratch = vec![];
    let mut out = vec![10, 10, 10, 10, 10, 10, 10];
    _limbs_mul_to_out_toom_22(&mut out, &[6, 7, 8], &[1, 2, 3, 4], &mut scratch);
}

#[test]
#[should_panic(expected = "assertion failed: 0 < t && t <= s")]
fn limbs_mul_to_out_toom_22_fail_3() {
    let mut scratch = vec![];
    let mut out = vec![10, 10, 10, 10, 10, 10, 10];
    _limbs_mul_to_out_toom_22(&mut out, &[6, 7, 8, 9], &[1, 2], &mut scratch);
}

#[test]
#[should_panic(expected = "assertion failed: 0 < t && t <= s")]
fn limbs_mul_to_out_toom_22_fail_4() {
    let mut scratch = vec![];
    let mut out = vec![10, 10, 10, 10, 10, 10, 10];
    _limbs_mul_to_out_toom_22(&mut out, &[6, 7, 8], &[1, 2], &mut scratch);
}

#[test]
#[should_panic(expected = "assertion failed: mid <= len")]
fn limbs_mul_to_out_toom_22_fail_5() {
    let mut scratch = vec![];
    let mut out = vec![10, 10, 10, 10];
    _limbs_mul_to_out_toom_22(&mut out, &[6, 7, 8], &[1, 2, 3], &mut scratch);
}

#[test]
#[should_panic(expected = "assertion failed: ys_len >= n")]
fn limbs_mul_to_out_toom_22_fail_6() {
    let mut scratch = vec![];
    let mut out = vec![10, 10, 10, 10];
    _limbs_mul_to_out_toom_22(&mut out, &[6, 7, 8], &[], &mut scratch);
}

#[test]
#[should_panic(expected = "assertion failed: mid <= len")]
fn limbs_mul_to_out_toom_22_fail_7() {
    let mut scratch = vec![];
    let mut out = vec![10, 10, 10, 10];
    _limbs_mul_to_out_toom_22(&mut out, &[6, 7, 8], &[1, 2, 3], &mut scratch);
}

#[test]
fn test_limbs_mul_to_out_toom_32() {
    let test = |xs: Vec<u32>, ys: Vec<u32>, out_before: Vec<u32>, out_after| {
        let mut scratch = vec![0; _limbs_mul_to_out_toom_32_scratch_size(xs.len(), ys.len())];
        let mut out = out_before.to_vec();
        _limbs_mul_to_out_basecase(&mut out, &xs, &ys);
        assert_eq!(out, out_after);
        let mut out = out_before.to_vec();
        _limbs_mul_to_out_toom_32(&mut out, &xs, &ys, &mut scratch);
        assert_eq!(out, out_after);
    };
    // !(ap1_hi == 0 && limbs_cmp_same_length(ap1, xs1) == Ordering::Less)
    // t == n
    // limbs_cmp_same_length(ys0, ys1) == Ordering::Less
    // ap1_hi != 1 and ap1_hi != 2
    // !bp1_hi
    // hi == 0 first time
    // v_neg_1_neg
    // s <= t
    // s + t > n
    // hi >= 0 second time
    test(
        vec![2, 3, 4, 5, 6, 7],
        vec![3, 4, 5, 6],
        vec![10, 10, 10, 10, 10, 10, 10, 10, 10, 10],
        vec![6, 17, 34, 58, 76, 94, 88, 71, 42, 0],
    );
    // limbs_cmp_same_length(ys0, ys1) != Ordering::Less
    // ap1_hi == 2
    // bp1_hi
    // !v_neg_1_neg
    test(
        vec![
            0xffff_ffff,
            0xffff_ffff,
            0xffff_ffff,
            0xffff_ffff,
            0xffff_ffff,
            0xffff_ffff,
        ],
        vec![0xffff_ffff, 0xffff_ffff, 0xffff_ffff, 0xffff_ffff],
        vec![10, 10, 10, 10, 10, 10, 10, 10, 10, 10],
        vec![
            1, 0, 0, 0, 4294967295, 4294967295, 4294967294, 4294967295, 4294967295, 4294967295,
        ],
    );
    // ap1_hi == 0 && limbs_cmp_same_length(ap1, xs1) == Ordering::Less
    test(
        vec![0, 0, 1, 1, 0, 1],
        vec![0, 0, 0, 1],
        vec![10, 10, 10, 10, 10, 10, 10, 10, 10, 10],
        vec![0, 0, 0, 0, 0, 1, 1, 0, 1, 0],
    );
    // t != n
    // limbs_test_zero(&ys0[t..]) && limbs_cmp_same_length(&ys0[..t], ys1) == Ordering::Less
    // s + t <= n
    test(
        vec![0, 0, 0, 0, 0, 0, 1],
        vec![0, 0, 0, 0, 1],
        vec![10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10],
        vec![0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
    );
    // !(limbs_test_zero(&ys0[t..]) && limbs_cmp_same_length(&ys0[..t], ys1) == Ordering::Less)
    test(
        vec![0, 0, 0, 0, 0, 0, 1],
        vec![0, 0, 1, 0, 1],
        vec![10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10],
        vec![0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0],
    );
    // s > t
    test(
        vec![1, 2, 3, 4, 5, 6, 7, 8, 9],
        vec![9, 8, 7, 6, 5],
        vec![10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10],
        vec![9, 26, 50, 80, 115, 150, 185, 220, 255, 200, 146, 94, 45, 0],
    );
    // ap1_hi == 1
    test(
        vec![
            2543705880, 1859419010, 3343322808, 1165039137, 1872701663, 1957510151, 1589243046,
        ],
        vec![1919189400, 1295801997, 354566481, 1212146910, 1886225431],
        vec![10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10],
        vec![
            1753714240, 1114397484, 4100081063, 2352383720, 667557204, 920036609, 2291920497,
            3338154324, 3806846000, 1880963052, 291601955, 697949587, 10, 10,
        ],
    );
    let xs = vec![
        1201566046, 2595928714, 4098593401, 1330522861, 3960990867, 3595271670, 342150461,
        2889833130, 1164464168, 2376365457, 2771389262, 3887942155, 1988238301, 1833338303,
        4014955802, 3995390593, 2188315623, 1183652505, 2672608513, 176996889, 1660507309,
        1751500579, 3889779046, 3415096754, 4282532402, 3093849591, 3327913254, 283043719,
        1171444235, 391416077, 413825816, 1773976620, 2186467953, 751062632, 4254325704,
        3792366163, 1241665898, 3185077976, 1341618388, 1265543956, 4057178815, 1215473296,
        1162863636, 303879845, 3780968523, 941833345, 4100359706, 3467461066, 1146217920,
        246150834, 3145879338, 3690293871, 3251509926, 1372067248, 2964865546, 974393508,
        1572812006, 2707314271, 26353947, 679858893, 1389465468, 2995907844, 1511303960,
        3345307335, 149297985, 2375280203, 1430007944, 1786306409, 1622386906, 4040769147,
        3280028348, 4201321273, 4160859997, 3331153972, 2934071532, 285164432, 298533316,
        1660606632, 3127652273, 811048641, 3005124229, 2544270652, 3349776204, 309114533,
        3824986817, 4245220611, 1106800016, 2370467673, 901160151, 1290814337, 368997805,
        2944671085, 645387256, 2707809477, 1829734617, 2093316259, 436352108, 1616613575,
        1568952939, 217097944, 3916049095, 1731114593, 375324535, 2450608191, 3527144039,
        3942616407, 7795525, 1852207265, 402774520, 3786563615, 1620352828, 317998114, 290867859,
        163836934, 4130574350, 1355138669, 3671965725, 3417699947, 2736306416, 3653024357,
        3253004131, 2742432990, 1015503017, 4190998535, 1701311640, 1910094897, 1713735128,
        3443492572, 4279664931, 30548166, 1537407679, 3798546909, 4289618146, 3968904711,
        539466588, 2926203703, 1914526366, 2689390000, 2090660778, 4052932795, 1968633322,
        2139919558, 1319590416, 3547906480, 2463598728, 1072870169, 3896719482, 601964428,
        1871105567, 159202451, 1786628495, 1687558950, 1584459364, 1767617600, 808811972,
        2476161096, 3302761235, 1230197767, 2845069663, 2998487917, 3036392289, 1817633003,
        228445583, 3016081544, 1597613029, 2393267767, 889238514, 4244303589, 152652264, 569693934,
        2717135638, 4150301309, 659095422, 860019676, 3944788378, 3127362138, 2103944808,
        648170152, 1951813348, 2281501564, 276992062, 3903889664, 1548421059, 3211522217,
        3934312644, 3875429204, 868657211, 1801011178, 4110281689, 3404731539, 1158962046,
        2036659705, 1650299250, 2889118614, 219688946, 2197498963, 118877130, 2145264177,
        3056876820, 43038774, 544790281, 1509845481, 1027462434, 735867372, 1642971145, 4073444573,
        161685823, 101308338, 3823007837, 2862839736, 609122367, 1652321157, 1695762722, 365750503,
        3747694727, 1145260903, 723029359, 1964109500, 3089617692, 259562105, 2304962051,
        973369384, 1318031298, 1244201321, 1716064996, 1419745051, 1184859729, 307503197,
        713667338, 3110482424, 2307088169, 4033820820, 2252442052, 1317305540, 2252055251,
        4094878364, 2183384973, 1436484471, 4262899016, 202937782, 2243530007, 2929300716,
        1409998687, 894022719, 3480434623, 2030892928, 3166141482, 1449933930, 2615020548,
        3306928506, 2023847337, 4273783396, 2916741248, 4164050221, 3143981470, 290469972,
        1284283161, 1953334067, 2872940924, 1537575460, 889308785, 3272929414, 95393558,
        3893044811, 1533064098, 107150042, 219633622, 3914392096, 2101088474, 4070897638,
        1046963104, 103440600, 910037016, 3232411399, 2367840223, 3803147026, 1722035194,
        2395176384, 2952325498, 573648704, 4158757177, 4115672767, 1196544161, 3641158503,
        158924413, 3051842464, 2992169439, 821013443, 937903241, 2094877639, 3088523530,
        2160927127, 3834845070, 3369034449, 1095327942, 183994394, 4244668943, 1803568423,
        3848067296, 309205967, 3315616341, 315508309, 3847329580, 76658664, 2296586975, 4160187410,
        104183053, 3129214127, 1511026683, 2566603427, 4032873916, 314873894, 2973114349,
        3643248627, 3146742193, 1068659656, 307512333, 1610785830, 1117742597, 1517684110,
        4137326825, 4102264163, 3875224071, 927832005, 1434603530, 132381755, 3598974368,
        230312212, 4179947333, 126569729, 3412580545, 2150894626, 2159401550, 2358657547,
        1733759363, 474847226, 3411683110, 3992933519, 3701700273, 2025122165, 680565081,
        2916231557, 97940718, 3535343904, 3804144170, 2777869154, 1704403932, 1253096464,
        354348990, 3145704350, 1791214291, 2547867729, 555904136, 2908677260, 1978972760,
        4268679537, 2815037517, 3003858526, 839417122, 704927331, 999596921, 186986294, 2771013862,
        478876098, 2850830582, 2864729748, 1796726102, 2429320287, 1364425456, 180375138,
        3795825954, 3154425949, 1345311491, 496164244, 3080144511, 1328751878, 1660265574,
        1201069864, 3981612021, 2140838621, 3331044260, 1645267748, 2884046876, 739592600,
        2093099287, 572501578, 1052020975, 1741058931, 2922168381, 3557731247, 1522612772,
        1052485138, 4146419762, 92188037, 4269839264, 1838925610, 3268534094, 2823176547,
        3691605505, 827408628, 3230980734, 1155175586, 3728503160, 1588328766, 2312399789,
        3328117775, 3015688759, 2401850090, 4080041605, 3362449590, 1241818689, 3834949365,
        3767931126, 992405134, 700281721, 1052434880, 2969789535, 1553878104, 2043691654,
        598217452, 756805231, 1532079381, 2877147461, 144178354, 717034660, 452624373, 581290195,
        2957914607, 3416767934, 92267114, 2035020178, 1574461369, 1089779068, 2220442392,
        3728441149, 2519638320, 4063954795, 2020811141, 6801529, 3302975500, 3123981292,
        3962098980, 2217565399, 1207405319, 366456371, 3121923072, 387751748, 1695117940,
        3049321944, 3943288711, 2473707733, 183780230, 103849021, 1104605208, 594262068, 724221295,
        4214388708, 2362449091, 3837597662, 1313385592, 2692150246, 728237817, 3257420777,
        1178587684, 1588301434, 1514032026, 1231074366, 4171329846, 28095441, 4144047844,
        844927877, 3780588266, 3777187075, 855183555, 3349773153, 1329270736, 769784866,
        2549205275, 63768497, 1868663116, 31600118, 790159795, 2427329489, 3976579174, 2792671359,
        693701994, 2164858826, 3885965205, 2683435738, 4182282761, 923441130, 2253555521,
        710192412, 2850309101, 3661400161, 3083022654, 1592924059, 3521738239, 3234864656,
        2036252576, 102657071, 1900173505, 3209762835, 3082090176, 3318368266, 241491038,
        288112905, 125269003, 37953541, 242823529, 2763890608, 3373926654, 2151703162, 884858950,
        1254231898, 1193917192, 2984924767, 1948245858, 3815676572, 2179313352, 3578874410,
        97283865, 4065940695, 2886433308, 161193188, 1411123390, 4235580458, 328561173, 1303179016,
        3770506456, 2521249252, 4047510063, 60126824, 1353599957, 3831481261, 1992359339,
        2287213667, 526649166, 3618637996, 2421246955, 2436040869, 2540890857, 1272361660,
        3107489448, 2510416480, 3495695756, 3859611787, 1213295723, 1411838648, 4031162392,
        3284911803, 2412215468, 703287783, 1536894297, 3963448081, 3083102386, 817468828,
        323359426, 2524837389, 2829651472, 542564196, 674472373, 586692212, 1865948519, 2011364319,
        3009304838, 3726785757, 3325586920, 1465604688, 2332819338, 1751755650, 3931920867,
        1812942829, 3366740805, 2909373814, 3966529034, 2923872690, 258861414, 1614941508,
        2222111734, 501269380, 2081917522, 2351779087, 3612294732, 2176028326, 4206156080,
        2809414724, 1014630508, 3332422027, 4092277100, 3501942206, 1794205982, 1671176478,
        2295019579, 1639630625, 4076389560, 3764864340, 1588842140, 493572112, 1579355367,
        3153600249, 1217265429, 2829584014, 1832288418, 973013812, 2901503264, 3566821684,
        2798381916, 82182427, 1323815701, 1162578762, 55772116, 3526352958, 3502110398, 244925136,
        327918367, 152535424, 3082603980, 1129853129, 2882907150, 643778778, 3901805292,
        4031163730, 580398991, 3577911396, 1108573079, 4156521329, 1253779894, 690844236,
        4042845036, 3151677926, 2761020746, 3527918757, 1490765171, 3043438140, 1297638736,
        2187356038, 3227145038, 877760, 3030526336, 1551308332, 1845408917, 1270491315, 2556743384,
        1252087237, 3365747296, 1178861864, 2322820610, 1172369753, 2202311570, 863465473,
        1764540278, 13877022, 394719448, 1103203238, 818103102, 1452076871, 3139752824, 2142070069,
        1422492510, 486780221, 1460454720, 3512593276, 2777736170, 2987127841, 1787006997,
        2622728922, 1801826394, 1867204490, 1553014983, 18912332, 4007646565, 1012151888,
        3708667615, 3742700733, 574052709, 4251182501, 4294834331, 137131915, 2871114563,
        2105361868, 1942726991, 1770263014, 1637762511, 2953098060, 2235725644, 3834663173,
        2604889202, 3764016182, 2718947171, 3171281090, 756407781, 4273986702, 3792241512,
        3599579006, 2423275831, 690365339, 3321349305, 553661753, 2787757144, 1163618190,
        1454108386, 2580290202, 504265224, 2877823176, 2304313852, 4032222372, 1133693269,
        1197106002, 3322921529, 1749417821, 338436881, 2859793414, 4497138, 3077113960, 1356609133,
        663777191, 3771130928, 435176336, 173693046, 1270731877, 4044179815, 955672146, 501060759,
        2933180589, 3614911505, 3140329619, 3657632925, 264730001, 2714839893, 25177333,
        1742566447, 1738889378, 1946547428, 1179049468, 1489520446, 4066127443, 2853858093,
        3085624982, 2219031016, 3561428839, 1984355570, 4160498381, 2194911869, 3866718826,
        3999901128, 3341348387, 3319989386, 979896013, 291862136, 3536610347, 1943009060,
        463764210, 2047858202, 2191023360, 1217564521, 3834101646, 2983698213, 3003992896,
        1399685862, 3416425336, 2594743555, 686960725, 952684412, 360338288, 2431094466,
        1735817825, 2413661817, 246038443, 3148004501, 2436609582, 1029015030, 1260951647,
        2821904972, 3799928090, 1560627531, 2827159116, 1079083370, 947052846, 3379781912,
        1702870874, 315581840, 3059528885, 2512515071, 2120429073, 4104891098, 4204761314,
        741496111, 873599400, 355199800, 3545528206, 2774677422, 1210639941, 483110271, 1564602543,
        1295031625, 3383067962, 4259764325, 2973903800, 4180349188, 2723242650, 2375659769,
        1846789716, 3998030243, 4057800857, 25252009, 2808579065, 2079355109, 4156575403,
        1755978877, 176082231, 535385910, 3740300924, 1228633229, 2299789551, 3397148860,
        1972072353, 1738319455, 3399314503, 4148314946, 2547518604, 2523261795, 1869759069,
        1634850934, 4206529680, 2915388931, 2668964724, 727755221, 2482220220, 2707153387,
        3612546349, 2169778453, 2039651643, 4208578659, 187768628, 1487060397, 317479779,
        1054030181, 50324749, 676108233, 3351735851, 1061140439, 4149276814, 3768699233,
        3042178663, 639341677, 1055587054, 815583728, 3255890260, 3393271045, 4186766347,
        2520098500, 2145561976, 1788095338, 1956811808, 3966616178, 1411493803, 4248548624,
        3093147174, 426786774, 1406576099, 733944616, 738058813, 1743713901, 2105087409,
        1251988724, 3687431678, 58198739, 2178079666, 2401242584, 3037668936, 1376222051,
        1303463040, 2903230091, 3775438316, 1350932523, 3512140827, 1614201567, 3314255703,
        1685763690, 289619083, 4146171662, 2056822378, 982553607, 3579469100, 4202780757,
        966928300, 1562658067, 1584735594, 269329835, 3142106703, 2554868785, 1847425874,
        3043452894, 3578786610, 180569828, 2959077487, 2669414083, 529342750, 4157784171,
        862577945, 2380217711, 1954459129, 2514593403, 3563129381, 4271667223, 819862039,
        179206153, 379576319, 2477233005, 1431354519, 2840356513, 2238649924, 1588603809,
        966407480, 1672315628, 3248395939, 2635255762, 2017241277, 4002347994, 2215806520,
        3212973707, 464150612, 121592807, 1941447870, 1331121178, 3261842499, 3924131236,
        3088475425, 3447161349, 3570758449, 125281267, 2307067331, 1835748034, 1174265678,
        129356285, 685996782, 3901136421, 908228326, 2455043369, 807316850, 730024536, 1745436285,
        1420589646, 2212713675, 855948395, 2267588146, 1143522741, 3390777385, 151995487,
        3025498609, 3500007112, 574576804, 1050982804, 122215037, 2562956739, 3631005173,
        694472451, 3592335461, 1493007270, 63192513, 2714444014, 2654008106, 436558108, 1820311535,
        167068397, 60580509, 918662461, 851589129, 3054285066, 3924316323, 3657862688, 2269950004,
        2256521310, 3844365212, 3910757089, 2357791617, 690714223, 2203862737, 3854807931,
        3817681010, 3185265196, 1477848619, 1739636453, 2990852975, 1305124682, 3159694713,
        263957826, 4099471801, 1392775979, 1267792137, 2802049391, 1264056427, 1047631971,
        1844313887, 1881379637, 2856354143, 2227203632, 3872676272, 3121114873, 2351294552,
        2189482713, 3524028206, 3894370957, 3875201299, 2316167332, 2817789587, 430539859,
        1115176197, 3081638976, 600488496, 2526191261, 2489429120, 3597468886, 482592705,
        2219002995, 1770318100, 1771483206, 1521917057, 2038092259, 1536770071, 2741473927,
        262534097, 4051031007, 3732554814, 4050604275, 2870287053, 1435024634, 823170593,
        1987512541, 1609694179, 416952726, 2102345, 73640877, 3072695056, 777724825, 2356223352,
        3458224540, 3580645758, 992441033, 800487417, 3881999580, 1663835518, 2512357110,
        2223773332, 522148219, 4246352874, 345156802, 1267210385, 2820311214, 624419147,
        2209064621, 884611942, 663090288, 233937492, 816551017, 2134706522, 724682240, 3233137404,
        2387324599, 2041567323, 2316343882, 2700860236, 953189374, 2017559675, 684856964,
        776787052, 271538169, 4127806770, 3400752225, 4062521676, 2067872069, 1779221198,
        4153058857, 622806600, 1338487195, 348361181, 1502336574, 3528873943, 3211796474,
        302290942, 1394514853, 604923937, 164436428, 370432917, 1981346086, 1368244829, 1360546905,
        3812284761, 390343115, 759982286, 2161967934, 1199972278, 1867091421, 3186810495,
        3136220358, 516794051, 2691285799, 4113162691, 287428780, 2007200692, 3192696089,
        311451420, 1133340463, 3914341679, 2676870721, 2659758422, 428138298, 2327907929,
        2625367832, 426687038, 1007116376, 2673078927, 3014609415, 543303010, 3721996858,
        2091502549, 1585712049, 3980948149, 3472052816, 4240630204, 426794645, 316233554,
        248561196, 786033640, 3775582284, 376950426, 904168741, 136304624, 2489673931, 1172457240,
        785210073, 3657354077, 1524549872, 3099627208, 4082896692, 1222763455, 4270102181,
        1827453184, 3569327099, 3156704005, 4033508465, 2411357081, 92278893, 4191973591,
        3503635496, 3612865906, 3846075749, 1049164717, 4165676072, 601000778, 3147530137,
        1675620670, 1027294698, 2404406737, 741711940, 3983963132, 2619301821, 3409172002,
        4129377491, 3919001139, 2815367395, 43466298, 4114860307, 2415310265, 3783207623,
        4063133179, 4010960656, 3047227008, 2936666444, 593499468, 2030010173, 551874291,
        1334782568, 1774716839, 2247931812, 135981186, 3817678266, 757429317, 771525388,
        1714057069, 1012644952, 929958201, 3374456320, 3047374676, 1745221200, 2633395651,
        621344649, 3588586662, 3807498514, 1734019332, 3762729728, 3672814591, 4026762034,
        1532313394, 2536755553, 4072158432, 785599890, 2920461484, 1047913937, 1926343799,
        3878942763, 3384138141, 1810065341, 2044734393, 3667142496, 3462707977, 2963937006,
        70980368, 2929274285, 678413409, 839039229, 870642468, 4026742528, 3991809124, 2335847744,
        3411161899, 241441626, 451308460, 3839513491, 2688369195, 404333301, 3028050970, 800619604,
        1989331409, 2173207272, 746491815, 386229540, 1797905067, 2341597045, 4293560646,
        3713572185, 2805678957, 2161512904, 4135816392, 2984933037,
    ];
    let ys = vec![
        782652504, 916163140, 310173353, 1802664004, 3003575182, 994714958, 2454505832, 1901957297,
        3402803536, 1747659191, 1291557938, 2039529363, 3515731612, 2933453508, 2583845290,
        2759100862, 2902806784, 4095392461, 1611071641, 2379845637, 2269592411, 1495198365,
        3022662021, 1685971751, 1883803743, 1447977675, 1785632060, 153304859, 3054736112,
        4244472323, 3366342271, 2270456917, 2188972812, 1284837283, 305265373, 1955426664,
        1791721366, 1970893709, 3903712190, 1024292529, 2232749789, 2570562202, 944583170,
        121097092, 913708092, 37775971, 2332076456, 1023386677, 4282023250, 2765385612, 1811247738,
        2038868926, 2736598936, 3195403704, 1952451499, 3492379619, 867325320, 2241962566,
        1374462737, 1973744441, 1655671568, 399459141, 4215085258, 1508033618, 22198235,
        2383222855, 4167413708, 3588023719, 2745896908, 1387857989, 556693290, 4194613073,
        2988716566, 812795621, 2148134708, 2660731594, 2650816085, 86568983, 3145388652,
        2641804613, 870721226, 3252319612, 993027270, 1658215851, 3541899390, 235494842,
        4049046320, 2178188633, 1498017154, 1981199422, 3134613758, 2942080436, 251854633,
        2255385748, 1633516013, 942618698, 62433842, 773903410, 1700398136, 3145599908, 1331593286,
        2051770157, 1510922652, 3582918675, 2992536895, 3661574974, 3878488800, 3655435184,
        3548172621, 2162061086, 4030628522, 564420488, 1769697953, 1632649889, 3074979104,
        2133450478, 2306833529, 4068560818, 740735000, 2360043113, 368759366, 1561835406,
        2074549960, 3389926242, 4115747670, 586398338, 3721898215, 280790067, 3001501338,
        264900132, 2001858684, 3739097825, 2427961327, 1240427037, 620351698, 621391076,
        3722468879, 1042663425, 66612835, 1482407006, 2347351308, 1459172788, 3957457668,
        1588181312, 3801356259, 1850451089, 3435120477, 2623648711, 3538251722, 3897005335,
        2754364990, 2945450233, 4011049935, 3348154059, 1819612672, 2844849373, 3241485916,
        3063122881, 3300170054, 3282667970, 2629333506, 3760292650, 712847010, 257661263,
        1777343300, 2427808650, 3878293918, 511824846, 2886526769, 3792622065, 179282207,
        1604355356, 1228769304, 604281394, 2201448145, 4234685352, 4238020651, 1378433962,
        4117408546, 31972441, 663081633, 2563688535, 2382031417, 701267988, 707736938, 1991489288,
        129959799, 3297810142, 1243343136, 2678463178, 897048751, 4048481356, 1259186574, 89157406,
        367615531, 2055258921, 1902003428, 4007162629, 2133696102, 4149190621, 1195466891,
        431794989, 446641294, 4232416906, 190711601, 947432339, 2941636118, 2787558974, 2147611998,
        1820380291, 2711178610, 2843135890, 568578158, 2708993855, 1925583907, 1517441780,
        2334353268, 4284929926, 2831827986, 188028899, 1780502934, 1692135110, 1215307454,
        1428844526, 2054098651, 2054024406, 3305463128, 2695814721, 754034286, 2804289863,
        395870766, 1995737841, 1624498358, 1564094760, 1097232450, 2841900272, 2645457672,
        3154307360, 4003265617, 2977555345, 270407513, 121824624, 3267754169, 318354283, 42192607,
        4284697715, 3186258555, 3828119669, 447440617, 2593034423, 890059121, 1164728744,
        475228196, 322476659, 16845108, 1865037774, 1502806079, 3008409318, 1665760087, 75417174,
        979335887, 3024090444, 178961246, 1220535957, 3865615158, 3519406660, 462875056,
        3576553991, 3180112124, 3301187523, 2055446042, 1106483481, 142344991, 2685456899,
        2598629949, 3423763873, 4294446736, 2794553697, 2875502077, 4109061140, 56672439,
        1336028007, 4057494777, 2675983021, 3141402426, 1557976997, 2951781918, 1881126396,
        1865951601, 75390111, 1291784356, 1577865697, 1404099385, 119392556, 1537454571,
        2602457899, 985168658, 3023382690, 3520232395, 1718077517, 1454065483, 1312395248,
        1466804008, 294214115, 3539613696, 3899249364, 611270119, 1556549949, 1865292558,
        784367406, 3156556591, 1218471721, 740445066, 2553963486, 2920697770, 2317026821,
        3245911130, 130054384, 2013367175, 3051273823, 1247897284, 3127626360, 2287402403,
        2325207729, 219897695, 258941659, 1503080235, 2929232556, 2351373519, 1140349502,
        4124924711, 3017813482, 1029445988, 2141397941, 4045283855, 2319179395, 2095147072,
        3825044148, 2346933482, 1500926659, 176290765, 478792726, 4250736616, 1759351637,
        707712004, 1550808545, 1161315336, 1396803415, 3806565964, 4038648347, 1737296139,
        412187254, 851906241, 702758406, 1534170197, 3227856247, 94019437, 2213451948, 12399446,
        2676533982, 3401920119, 899317995, 1423708229, 2347308570, 2731465646, 2393343590, 318797,
        2077688740, 1634770064, 881903148, 3439590615, 2833458456, 2305969933, 3792908090,
        325304830, 4167235914, 3337836956, 2812027573, 2457542835, 2176719619, 2129404930,
        3038301098, 637946718, 395806559, 1816332026, 3671412247, 854182532, 1517515807, 501464101,
        837326507, 1757126678, 1545956561, 713108213, 2075548750, 2678328594, 975190032,
        1409291859, 978030087, 795400824, 3492610506, 1792620078, 3868709610, 312729764,
        2977581974, 2140205723, 3198060351, 733370495, 562509193, 1524153695, 250277484,
        2623431152, 331254774, 1124637833, 3273010677, 3167986385, 3996197675, 3137383031,
        714309606, 1089753194, 495300873, 282672597, 558631181, 793155407, 4114619175, 2776492220,
        3019402275, 443050080, 2352512443, 2426174212, 233794572, 803882993, 1770802299, 675399391,
        1207686167, 3292728167, 2941472541, 151240039, 2539326898, 3328779981, 724651018, 7730498,
        1292256295, 540415714, 4260511314, 2914746604, 594577862, 2633414885, 1175030878,
        1925540647, 2490996436, 198474908, 519657985, 1762176164, 33899575, 263996128, 4198474519,
        1637446193, 2537084087, 2422570843, 3660886616, 4293786258, 2810435476, 2454851050,
        3445120109, 2167218113, 2631718958, 1757828543, 2200485955, 3534410555, 2680563903,
        494555053, 150294236, 4294144925, 2523349235, 3717232762, 2583987925, 549029954,
        2200646588, 1396286075, 3755828714, 55295391, 1078160489, 3802379174, 771120571,
        1433123097, 2170350410, 1682977580, 2869636901, 2459669736, 1365012189, 1143998390,
        1073921504, 449033710, 3667305108, 339681249, 4231983396, 2790590960, 4093947211,
        4023140540, 613085617, 2364009914, 2322458906, 3185641789, 3775200059, 664675674,
        3909487278, 1714708615, 477229812, 2606115328, 3052361470, 1385976227, 1600872883,
        593037817, 1205012681, 4116103108, 583330373, 3370365679, 3696062198, 2399816963,
        2278735946, 1339665011, 3688148814, 4102555792, 1293250546, 2500983708, 3732318380,
        1317673049, 293804189, 647998584, 2810565606, 1833299339, 1077304881, 2406927022,
        3769978615, 2111169681, 2216950466, 2200038967, 2686121798, 19106208, 3705407421,
        840880428, 4140146852, 682648740, 548792303, 691293019, 4284934958, 2455107201, 4249568391,
        214188821, 1925431879, 1670990382, 4092110392, 2001938441, 3987947303, 2515014479,
        2261759665, 1361797998, 2203669808, 2800684642, 981038140, 3481019509, 2676178184,
        226823630, 2378485288, 2148496287, 3940081655, 4165846092, 3955876940, 3668242868,
        1790713394, 2070557777, 1096062743, 3178683548, 2304311337, 304593788, 1200700378,
        2704874688, 4187286203, 2644453662, 520613843, 3803562856, 2317601175, 67636423,
        1227016999, 759421480, 2298923639, 2627427636, 1254732326, 2520127342, 2001976446,
        1094223918, 2080157682, 1998693375, 1353000242, 969001142, 1935680201, 2496103017,
        2796525581, 3696751068, 2960089773, 3287552787, 2274671037, 2034192850, 955699269,
        656122253, 3411863827, 3346003011, 2178866457, 643489032, 3988129482, 2483633409,
        3271922995, 4134579520, 540680663, 3602564212, 421487939, 3837205450, 1203541142,
        1173951782, 2929930012, 1464529646, 4144292698, 3169127447, 2028860108, 373991472,
        2174586327, 936489306,
    ];
    let out_len = xs.len() + ys.len();
    // hi != 0 first time
    test(
        xs,
        ys,
        vec![10; out_len],
        vec![
            43896912, 722153757, 2904514153, 2962648185, 2693303043, 3832129918, 498797259,
            1973947790, 3684236951, 2632729245, 3130335584, 1289838513, 2601531864, 93158009,
            71164264, 1191283571, 473183576, 1586817409, 638400142, 931522640, 241159888,
            1731633026, 3130189681, 3677386560, 930768184, 430483605, 2470256505, 1227467794,
            667342765, 1705489958, 3828337778, 2455715003, 1501063870, 3662421166, 324036598,
            1658119070, 4034035672, 856616761, 2746428701, 3799891355, 4224258383, 3827083024,
            4294433562, 2274023060, 3560776488, 3973959346, 1375952586, 1728275850, 919768614,
            2841325181, 1790708445, 651031634, 1413370781, 1125557096, 95022265, 2009349426,
            4065184977, 1371530322, 2623688430, 1309537014, 3082131948, 1559135603, 3724048100,
            532410086, 967562236, 902867787, 3927816448, 1464804220, 4105528427, 326545621,
            1490119349, 776580250, 3685731651, 3390569581, 2134504179, 576797306, 2561561474,
            1669085595, 2695459874, 3134602821, 3128266247, 3846894980, 1644781581, 3283121969,
            3338927648, 1282985633, 1355350648, 699921375, 1235221150, 30357345, 3480605968,
            1753227849, 3783806332, 3177010272, 2850120854, 2284733235, 3810178032, 3013413392,
            2702949978, 1931579418, 3683167633, 3711842364, 2705977753, 157858798, 4156030514,
            3518998769, 2546961833, 1582974588, 2746976504, 82618102, 3418297727, 2220918700,
            690722195, 1168863120, 3400573839, 735707550, 1628927980, 3881763306, 274223640,
            3120741763, 1947030776, 3464411934, 2400712435, 2643771133, 429147702, 1211383551,
            1168333602, 1521768741, 2696554804, 3862472780, 1678914922, 1487159276, 3448640142,
            2139966440, 967413141, 408419948, 3494928929, 831069357, 1518943770, 3554430409,
            141143457, 557611388, 3119995999, 255997121, 2913110265, 2122459966, 2607137219,
            3062802697, 1981412968, 1800941499, 810407355, 3969564988, 1493945057, 795982508,
            72402361, 2614782309, 14425950, 2867013331, 3419778457, 564428786, 3659574148,
            3399411039, 4078777671, 2314894174, 238966587, 2558537666, 2863350344, 3292013141,
            3259304761, 3819557177, 2637636805, 2325663805, 1227702269, 4024798408, 3648470260,
            1619364594, 567511419, 989061735, 1983176807, 1444435325, 2778124871, 65046046,
            3381350259, 888342685, 2736931690, 240109772, 1194403219, 101333638, 2763861943,
            31506080, 3025727689, 3333231599, 2131640574, 3259599936, 3518798649, 4270803572,
            1575812846, 1424032578, 3487441835, 1810062119, 2296494695, 298711170, 785039049,
            569566345, 3198792166, 166882758, 3624849268, 484817004, 1077339709, 3632779682,
            1663140228, 3043434946, 2253932570, 1663189368, 2617026420, 871292027, 693517343,
            2485522139, 2327506680, 4065656195, 215030713, 544361003, 3895395848, 2202414410,
            2819536023, 3652130081, 2313032060, 3956501588, 927210930, 1714946546, 4089866041,
            129242651, 3634554918, 2171141540, 2852275258, 836652152, 3353090198, 252574690,
            3851397734, 879876750, 3577419691, 1864146406, 1323842741, 1248147657, 3591895139,
            2912925559, 1094432040, 2691512853, 561263565, 2764323669, 1062354118, 2715725270,
            2101968739, 2631882678, 3975475840, 920884772, 3517522750, 4041753092, 2707331182,
            2026671123, 3965308144, 2165135412, 2560386556, 2269458694, 1454307009, 2168888337,
            169412545, 863922787, 3752717950, 1066248832, 784194759, 958819605, 3260506420,
            2927556405, 2897075609, 1939699237, 379951592, 1275827808, 1876953701, 613276975,
            1621155049, 963567144, 3973976335, 2978885053, 3828532922, 593620097, 2279717158,
            2842180396, 2317082799, 51857022, 3533419644, 2286705483, 847368413, 2925840616,
            127159266, 3520255959, 2637827508, 3251166128, 1568570505, 2520728539, 421671335,
            283185493, 677145730, 811378315, 4111566241, 2848201582, 1596284096, 3788606112,
            4196735842, 1481512760, 916081939, 2301936004, 2598893445, 1452140751, 321321133,
            2138088525, 721301308, 1370990861, 1122725289, 1323923907, 466413673, 3642302062,
            242431900, 1951204964, 1800413100, 941742289, 2512219752, 3082857203, 202013012,
            3023529612, 3764350920, 265584225, 1296889694, 4152015069, 655055806, 3206986813,
            2892066762, 753253440, 613066837, 2116589114, 893956082, 218972313, 1353775750,
            2852412413, 2066199097, 3297295316, 1881794937, 1104981872, 3597818607, 3030024285,
            1838248114, 1256667544, 2396751794, 2994282737, 1805917608, 3430488619, 3368174205,
            3136558082, 965385346, 1145722670, 4182372769, 1051821396, 1651437240, 2647975514,
            987265844, 1635614698, 2417188475, 3291493708, 1893519406, 2658571676, 1270420383,
            3261838745, 586977738, 1771704189, 1642280463, 2531103406, 2471403031, 2206480360,
            2603576242, 791610677, 2182101191, 143660592, 3977124091, 255459970, 1685978363,
            479361182, 483964457, 4073218995, 1160071683, 2043016887, 558945315, 2630420623,
            4221010714, 2318362127, 456168592, 544494843, 4161579936, 404838877, 2625232656,
            271661390, 41157851, 3295899953, 3649947241, 4254513250, 1037783936, 1701055235,
            709802555, 548213262, 1495993654, 3394669731, 230517428, 556992736, 663294802,
            54196470, 2793299304, 2688938455, 2218393578, 3062933069, 2895165922, 1491894674,
            2338200782, 3728548853, 3245955975, 1366603560, 4164925595, 416535133, 103586276,
            234793075, 1103443596, 1572605051, 1831153788, 1985754459, 1659774560, 2038631525,
            3915573704, 738597864, 2859375650, 2712438971, 3944116599, 3534992194, 3324175400,
            4044136516, 317070385, 2447061605, 1330845293, 775261546, 224401764, 885367835,
            1465729559, 1967537749, 560385221, 311026878, 3300463191, 2915390273, 3145009576,
            1737251173, 3393137370, 2929121750, 1329420214, 2911599942, 2731979447, 588833149,
            3001024746, 4242957919, 1037081043, 4040791674, 3479837079, 264116143, 45243260,
            1950343884, 760652577, 1308239196, 1100561811, 3326170668, 3263381138, 3506394757,
            544041626, 2256622173, 594251500, 3374297780, 2753977003, 2788013483, 3334741233,
            715028953, 2770424163, 2150738806, 1447766605, 4082487914, 3041138380, 1265155578,
            3635737935, 1900364173, 1795183481, 2196803450, 1642977288, 269020843, 2813909487,
            201910738, 4198211227, 766774163, 2442727357, 3038414078, 2952254859, 1609403878,
            3741429991, 3809999109, 2829947793, 3841755132, 3905432747, 1483033329, 1867370717,
            728386119, 1027802925, 3680931662, 1797028741, 3913591084, 2093717438, 3384197775,
            2560256583, 227230896, 2648435712, 1981532500, 554083551, 340834506, 2729346415,
            2798068241, 1612572861, 1780917626, 115863329, 1240955089, 1101864931, 2236856608,
            3260719407, 4087935685, 4060471156, 1860939427, 2790368658, 2658642666, 3105426634,
            990147996, 3890804879, 1013664807, 1604600168, 2266982302, 1738112836, 3118014352,
            3182092371, 3067088255, 901865520, 2700009994, 4270464143, 2356757757, 290752603,
            3156708143, 1678720557, 1122102939, 3854415146, 1717211714, 3952952166, 169839958,
            2866378699, 3403789133, 326893443, 3806468482, 486031278, 689613438, 3862858058,
            1650447932, 405977802, 522222729, 3784340469, 1410572737, 1304702755, 2469736464,
            2029354741, 2812549966, 2698443052, 4029193299, 3375003869, 2905845660, 2481333798,
            3824951334, 3398790113, 84502740, 3298955333, 758730531, 824172906, 3603688602,
            955418875, 3934407642, 338509914, 3210762917, 2873518644, 4250424615, 685588314,
            2186227982, 627228040, 242250511, 4214309503, 660272031, 1369504265, 2618887222,
            3586987730, 852582044, 124748192, 3612989396, 78009961, 3313557043, 3897709238,
            1944500480, 1701576357, 1514137462, 2274025574, 1141585864, 1624417019, 3442128379,
            2639380991, 1223737404, 3137422882, 2408791750, 3656376553, 1483698394, 313843025,
            1310942280, 2082116019, 1219568094, 1969314332, 3397804080, 1959491455, 1689954074,
            771873344, 335299470, 3602759263, 2836206042, 971632883, 3680948535, 960740848,
            3732729485, 3351246327, 2372499634, 246830242, 3287875984, 2107623362, 4027379627,
            1219061313, 509841820, 3225819229, 1436700552, 3669294346, 284612053, 1189151547,
            2827494899, 3475685424, 3788025678, 1514083454, 305512212, 298837472, 3795689141,
            1024476728, 505648251, 3272604494, 106436045, 672461352, 2786679820, 721869088,
            2751946276, 688259228, 155876135, 2351433263, 380216642, 1777949322, 1225287267,
            3075759959, 1640060026, 1598663774, 3892079517, 2086533544, 379793457, 3326036506,
            2667098181, 3645789064, 3650657985, 2229281791, 2017541104, 15577612, 1721992199,
            721820638, 2352988219, 1296541263, 415507094, 1442252129, 2893312206, 287315443,
            1186818594, 2138268732, 2714174058, 1632846557, 2113141629, 3107164093, 2116191517,
            3910918663, 2840919189, 125143015, 3733368138, 4628752, 2162534871, 1942491846,
            3463715151, 4017418998, 940073557, 171035819, 882228129, 10841742, 2403095078,
            2863629521, 3559669743, 2841934461, 3067362708, 1547847888, 359016821, 3273570930,
            777636192, 363745172, 85474720, 1413600442, 305501174, 989736493, 94014589, 867629791,
            3217335907, 652335555, 109939952, 3661212545, 1566759441, 589457114, 295633139,
            1557694756, 186434336, 2092433518, 2211072511, 4095809316, 4176274912, 4235018436,
            2787810106, 1289678799, 1527813900, 63028058, 3504286703, 1498407959, 3797571298,
            1694240539, 1673601453, 1457713754, 2282814183, 3903979221, 3418200541, 1233421929,
            2190597268, 1627273107, 2586428380, 865612196, 2104420717, 2430957717, 1260092589,
            805015012, 3668641109, 1164257760, 1813904594, 1343636801, 1137255472, 1307285783,
            532813064, 1787525839, 1957620498, 3033799600, 1292553249, 1807844529, 2396916127,
            3757297226, 1652952940, 997253919, 1751737495, 1334537564, 721964489, 1956998015,
            643814637, 1670648826, 2219713279, 1598003495, 113276314, 4273357098, 1152691510,
            2245563096, 4089848863, 1786105129, 113434783, 3322939891, 2454829005, 2362369081,
            2662063816, 400399594, 1166516106, 3074356449, 2854101812, 2880293287, 1807846875,
            3134252635, 1186533111, 4222463005, 1384090054, 2885932997, 404226949, 2114289403,
            977987804, 4093259604, 268658146, 991760839, 2374637329, 487675246, 3686380609,
            355344408, 3987585783, 847779095, 1595999730, 2404832363, 2856935279, 1896675115,
            1749128957, 3905651082, 2661579530, 1455807478, 3068172290, 2866206423, 3932665589,
            3054676719, 2251425972, 530784826, 1138983473, 2207073041, 862515596, 1010713411,
            264584793, 3664303583, 3908232414, 1415336779, 2534921406, 2794095816, 3296363456,
            3568803926, 3330418981, 1621169499, 2923616042, 2459996570, 166583270, 3630886614,
            415350556, 560109821, 36736400, 2622970088, 1402640738, 2752504041, 4286192177,
            1185433358, 2576434880, 1457737073, 636424610, 2776954372, 1937670350, 11622403,
            1746008222, 917311880, 678073167, 2019781197, 4247347770, 382487940, 4044504014,
            2664520903, 265329956, 3758243338, 1796481360, 3685238677, 4132028645, 588250743,
            2983465454, 2293877086, 715068382, 283684591, 526519058, 2541681999, 1870717571,
            2873852224, 511565591, 2849772383, 1075696509, 2623456048, 1838663283, 3993823479,
            3101034495, 664334448, 3300328645, 431855384, 608157459, 3323411310, 1550278289,
            3015853227, 1481002452, 2046224600, 2367925257, 3781380644, 3513536604, 2930130196,
            3945759811, 1457564729, 3719858395, 3011180511, 22005911, 1138754984, 2439047927,
            2782380894, 3300768656, 4120750514, 3712748843, 3133004976, 3424258425, 3034647245,
            2601276185, 1275788981, 83778509, 2033860589, 2927289043, 3730999703, 2380320819,
            3278024477, 1901373592, 240662535, 3275893068, 2457440287, 3326536483, 3260888089,
            562303193, 3296613044, 2187885804, 4093144309, 3896444054, 2342197482, 4057393848,
            1273308140, 113077898, 918234583, 3903249951, 46729149, 4099951893, 3406316613,
            829630808, 2867600738, 2447581803, 3578308939, 3264844899, 1283562627, 2109294411,
            1617426917, 2138879840, 111852830, 1947386571, 2936670078, 1817055359, 2634663599,
            1049377270, 3765333508, 2074875986, 2612635688, 893300225, 3534087801, 3823601378,
            1097276475, 4130046453, 2686693833, 2866027026, 846874380, 1380673246, 561711809,
            2743424481, 1675638496, 2680488701, 3375897068, 2604054029, 2100446080, 963103290,
            3887500785, 3145724092, 3906520829, 3546982317, 4183058155, 128106603, 4081328626,
            1186861319, 3070517111, 432653784, 1358999056, 2633465118, 3137208585, 1851856615,
            2277048381, 1033679425, 2257272715, 3684551304, 1535062284, 2770664661, 3847942344,
            682292417, 3115573082, 3487595261, 3856220257, 2140643744, 3116814529, 4015674093,
            559185380, 26283396, 2131900025, 4064545827, 1234435659, 2141581988, 3679585394,
            3759987499, 4023208757, 373116550, 1153157697, 4192708577, 3119945676, 3687671403,
            946114892, 1788822777, 777443867, 4120253107, 3270908465, 334569748, 3797961187,
            579994853, 2102622747, 1983808410, 633164958, 478874910, 4234741030, 896661401,
            520330951, 963329697, 1049780832, 4260124342, 4182390687, 1832790606, 3504435068,
            3402982813, 473933412, 1535418370, 3627627464, 3595267590, 3399620239, 2793816649,
            3513639877, 4120832247, 3703975014, 93028159, 605232744, 2418950775, 136573276,
            3986245913, 2266899894, 1030648363, 3754288559, 3397543943, 1835412331, 473937317,
            4217441553, 847685526, 4180276409, 564049123, 1787173171, 3559331149, 1597223719,
            2825617327, 1988395315, 500621724, 3677565415, 779448974, 1418305722, 312881033,
            369930359, 2843046292, 3157293703, 2397193784, 1465988117, 743254017, 1728959228,
            529303043, 2311612828, 73301789, 2470046556, 2256848348, 207350057, 2675621581,
            1772058933, 1126210454, 86825495, 3215438400, 1517563371, 3929329026, 948316476,
            3519744034, 1501985607, 879008636, 3060934040, 974499872, 3460620448, 1931296698,
            3819330329, 251390044, 3166929533, 2857688959, 1986227081, 3958607553, 2250207831,
            4060234390, 528570907, 3213844311, 1327563613, 1757755679, 1427667546, 1329928184,
            2572398738, 1503218265, 3809524899, 2543648294, 4025456794, 744265898, 492392535,
            3234605201, 3825310980, 2917277973, 690647792, 1781503679, 758188974, 1190372663,
            2138258946, 3450845100, 2604334045, 2479937467, 2852910896, 692982803, 1959783208,
            1162048900, 2139071445, 3095717957, 2506625402, 3892695785, 985938215, 3040599230,
            3035238573, 1001730011, 1665963996, 265963953, 1500227800, 882931788, 2119600572,
            493700365, 3186551562, 3992098836, 4029822184, 286644701, 3748986037, 2072215400,
            1048945090, 3361491407, 402311794, 1787250737, 3361407089, 3499671290, 4140416551,
            1175038939, 529760109, 61125033, 3626250508, 4203509871, 2150615296, 3993945138,
            3336354942, 2542703207, 203300283, 573495772, 533309337, 1020478524, 813902985,
            4025873774, 3201663427, 3071495353, 2302318900, 2316279404, 2147696294, 2396632773,
            635830405, 610554644, 3553522545, 2098868253, 2260910183, 3646351340, 2833755488,
            2362875012, 3017637371, 259397216, 3527119353, 816456067, 2596242063, 3433355612,
            3303494568, 265216864, 2821367656, 1039069407, 1109549963, 659078389, 4229014288,
            2079296109, 1307379998, 1423572287, 3062101114, 4153201878, 544384816, 1708361132,
            2969632228, 514485994, 2112052734, 3566748475, 2348145525, 972366560, 2203741640,
            3229302227, 1571089825, 3058444098, 62232117, 974314662, 1126564149, 2110078689,
            564298485, 1716573551, 3675104998, 3834944914, 3930066904, 3888816765, 4193963070,
            2766318845, 3763091911, 1015812135, 1370849394, 1309377691, 2521347714, 1764320557,
            1625672585, 3337564588, 3008704828, 465824926, 540578978, 1517261961, 585981827,
            1459695233, 4039038433, 107814533, 2625704617, 1937261071, 1174011620, 1054625998,
            1146044934, 2052370849, 491786092, 3284308632, 3625154739, 2476390970, 3698400452,
            1426608831, 397281335, 2568704232, 4182327610, 1168989107, 3035852072, 1976564648,
            3694255117, 2640485099, 20119079, 2721712921, 989776368, 264791185, 447332852,
            3248954449, 1591933075, 1062732546, 3996123507, 1240203156, 3588461691, 3849151834,
            509582230, 33498501, 41976012, 2889714681, 3982325760, 2443383154, 3308433954,
            3524167083, 2691770274, 2145801017, 1382338876, 1816395455, 575067684, 416944773,
            565768540, 530519527, 866555008, 4033144673, 1498360883, 2158659019, 3195181530,
            1717417347, 2625132111, 3402410491, 2383012153, 1663225902, 1861965380, 3534768481,
            740901288, 1284381545, 1040640996, 12672342, 3020321852, 3598363289, 3852764170,
            2540275584, 4036169880, 1126337593, 3832864698, 4087483624, 685731021, 1650654661,
            837726905, 4113873082, 2706331788, 3044951431, 1101328758, 52798888, 4188719158,
            2387881041, 4079055719, 3706376282, 1958344549, 3092902611, 1657025836, 1909991702,
            2961027370, 4214597330, 3890446710, 968429420, 3969952728, 3685461541, 2476605027,
            3663768193, 3073702602, 2475285224, 3454906685, 3203160232, 1219215459, 1574473068,
            311742428, 41526543, 21865926, 4238925978, 1533653772, 2928657762, 1022148213,
            1210954084, 2068658075, 1780821694, 3440958739, 1455098163, 460258197, 968444714,
            3683528713, 721005740, 818284173, 4089658182, 881586619, 3426940133, 3203291573,
            2559050264, 2672786835, 3568278387, 3053101993, 578596225, 293122606, 2281308800,
            126868369, 1766759833, 1899322033, 903029658, 3110519451, 1889573011, 2299767456,
            3511758772, 2017969197, 1562089839, 2620511635, 3519411198, 2051052089, 3788673395,
            1347694691, 2724251381, 1332743495, 204413284, 2700987352, 257610864, 1976982016,
            2653003753, 4042133001, 2773739161, 4193560031, 1993810567, 2321051251, 133817466,
            2395670651, 1273969054, 559260869, 1484207369, 3683409566, 4221417893, 2776544936,
            2069072372, 1639310734, 2191051646, 966516045, 2727220633, 2724358137, 1974242265,
            2115122718, 1317111449, 1633535121, 2390207657, 1374888373, 1082955415, 1430885569,
            1635529833, 116717010, 2204934182, 2856921596, 1215108703, 1040976906, 2982947827,
            3475564102, 4256191271, 2771425401, 2865543248, 3381266797, 3537559979, 1937471529,
            1113386791, 1412045287, 3893957121, 1221802054, 1348392191, 1429213058, 3203983635,
            2122951090, 2906054240, 3604352992, 1804199858, 109283371, 2375909675, 3850766321,
            68856196, 785890139, 2133740062, 539358045, 2217383636, 1015597614, 1848523584,
            1280049994, 1035835257, 371244413, 3932537458, 2603712840, 1293024327, 2043784639,
            2226362968, 3248405624, 3306158736, 2572287475, 971010182, 3778948704, 3245432185,
            1441286761, 2533748780, 2353218159, 436271325, 4172937266, 2404730548, 3644144370,
            2474594706, 950384797, 1507496261, 2741935774, 4113430106, 3957825176, 1230724060,
            2158025258, 3775469605, 591537852, 929823703, 3768179657, 2570347381, 3258596970,
            575120755, 989799926, 3488377788, 214790551, 3040592776, 662900289, 1197966317,
            896913265, 1249927017, 1803637568, 3162694652, 3366839305, 829780935, 720578912,
            3536382359, 3116394120, 2892713946, 3475098530, 1328021545, 3799011295, 3924373934,
            3869617449, 2131148082, 3948357040, 1235998670, 1816478862, 835546974, 3624596644,
            3949956457, 2497714908, 3200403786, 1253101923, 647105421, 491605407, 2082916431,
            352826803, 1177224921, 2115391069, 2995189920, 2804619347, 2277026573, 3404296500,
            3444471650, 1254222152, 3284869740, 3779789857, 1588712463, 320848563, 2567665679,
            385038923, 3702813492, 143781680, 1956465801, 1428169525, 3369978997, 1887401787,
            3382272327, 3756767530, 353806174, 3259011963, 4097871053, 2202544185, 730437422,
            2848941752, 4128136708, 977380487, 958970927, 197432218, 2248829380, 1150822951,
            2818262864, 1794551495, 1064902317, 721872772, 1408421650, 2976938909, 3157594692,
            133531050, 489886669, 2862495422, 2324047568, 1982178871, 2815462651, 1310580198,
            3782111014, 1954078802, 1159954017, 2783533298, 2386970632, 714019600, 2429614222,
            195036073, 1064750084, 3739991673, 1251521853, 978207908, 4243950416, 1633755463,
            2713111223, 2333649407, 180991450, 1960485586, 1861436738, 1671273807, 2241611363,
            3886146770, 2049016813, 4258263847, 3023310857, 1042503877, 3172308008, 1101382816,
            1123655183, 2202842901, 4077675905, 863688535, 1529756723, 2629967226, 2417825228,
            2951740514, 787754842, 794896037, 1740611711, 3034741040, 2714588029, 2673538120,
            756964652, 2210201761, 1822160845, 2887659120, 2245315780, 3403419067, 110925716,
            2533993936, 407580335, 1302016462, 603653542, 2815146700, 442586726, 1878951479,
            3631362764, 3566285081, 2918704404, 2438359702, 1108087369, 671278823, 1783697112,
            527429334, 3775554794, 3069227695, 3038572319, 1488651139, 3574754102, 1944381551,
            239058969, 3603247763, 1511883452, 57111429, 3324777654, 1202916235, 4139322559,
            98342387, 2681667418, 970807093, 2853689198, 3046565478, 1613854189, 232147046,
            3633140542, 2966299705, 2883749913, 1557861988, 3055414992, 2285773768, 3916860723,
            2739063580, 2939592152, 3116102113, 1499093003, 1161625818, 2630286810, 1213433291,
            2026863890, 788502408, 721554282, 3524591477, 1896789429, 4003319599, 3903684478,
            704347650, 679569146, 3257889094, 2358224412, 709521443, 3694584212, 2533650488,
            1757213509, 4138619177, 2936200098, 942663265, 2697159050, 3102677048, 479083883,
            487120989, 703414067, 3272488572, 39639873, 2837203564, 2935500301, 2762801972,
            721536408, 3523882239, 1582795702, 153033293, 1813016131, 946029181, 2579731719,
            1506044729, 1828831394, 2176528418, 917859978, 3705873504, 623050779, 3276728349,
            921290985, 2201907776, 713394124, 3456297928, 3200617584, 1752838689, 3072883149,
            3358590595, 1830145903, 700935467, 3560916088, 2866123620, 4273386404, 239927181,
            4141826809, 1636435706, 3116714836, 1029386577, 3178323745, 3566326403, 1338595609,
            2303106235, 2184499467, 3999205986, 1261821799, 3274347037, 470534579, 2374524330,
            106535722, 688825059, 1729352444, 890016953, 2717485478, 1887961549, 501146254,
            484765313, 4068017945, 3102373697, 1447666102, 3572943803, 86504458, 3585461716,
            1670924040, 2539716485, 2597187945, 2569887141, 3016684575, 4051641571, 1805403305,
            813566347, 1027530495, 71534896, 3362964870, 766330446, 1989547593, 125944469,
            2072261404, 2794639844, 3559177822, 2140614919, 2291765605, 3558654668, 1519918986,
            3129791072, 1392059361, 390448293, 609805129, 775945172, 2748569522, 3065181692,
            1749082941, 3906565636, 388198710, 2918760998, 2762839406, 2727438965, 2535873631,
            118356140, 1753346397, 924732992, 4082291755, 3807661343, 1612043808, 1083756609,
            1834459855, 3800908264, 564617605, 1426560021, 2883247271, 3210517479, 2283985975,
            2936866899, 1836945848, 3787338355, 4010769101, 2612800983, 3668792598, 1026509680,
            660384280, 3152997054, 3373838661, 3788226926, 2997249189, 3743813573, 3096069424,
            690326025, 1457421765, 1247743667, 3169260256, 2376991954, 3573140940, 203664252,
            267995288, 2397907058, 4283097356, 982233387, 2314486989, 3580574174, 1740462531,
            2267677202, 1682620716, 1587227916, 2593197462, 2997045891, 1183656554, 650844972,
        ],
    );
}

#[test]
#[should_panic(expected = "assertion failed: ys_len + 2 <= xs_len && xs_len + 6 <= 3 * ys_len")]
fn limbs_mul_to_out_toom_32_fail_1() {
    let mut scratch = vec![0; _limbs_mul_to_out_toom_32_scratch_size(1, 1)];
    let mut out = vec![10, 10, 10, 10];
    _limbs_mul_to_out_toom_32(&mut out, &[6], &[1], &mut scratch);
}

#[test]
#[should_panic(expected = "assertion failed: xs_len >= ys_len")]
fn limbs_mul_to_out_toom_32_fail_2() {
    let mut scratch = vec![0; _limbs_mul_to_out_toom_32_scratch_size(3, 4)];
    let mut out = vec![10, 10, 10, 10, 10, 10, 10];
    _limbs_mul_to_out_toom_32(&mut out, &[6, 7, 8], &[1, 2, 3, 4], &mut scratch);
}

#[test]
#[should_panic(expected = "assertion failed: ys_len + 2 <= xs_len && xs_len + 6 <= 3 * ys_len")]
fn limbs_mul_to_out_toom_32_fail_3() {
    let mut scratch = vec![0; _limbs_mul_to_out_toom_32_scratch_size(5, 4)];
    let mut out = vec![10, 10, 10, 10, 10, 10, 10, 10, 10];
    _limbs_mul_to_out_toom_32(&mut out, &[6, 7, 8, 9, 10], &[1, 2, 3, 4], &mut scratch);
}

#[test]
#[should_panic(expected = "assertion failed: ys_len + 2 <= xs_len && xs_len + 6 <= 3 * ys_len")]
fn limbs_mul_to_out_toom_32_fail_4() {
    let mut scratch = vec![0; _limbs_mul_to_out_toom_32_scratch_size(6, 3)];
    let mut out = vec![10, 10, 10, 10, 10, 10, 10, 10, 10];
    _limbs_mul_to_out_toom_32(&mut out, &[6, 7, 8, 9, 10, 11], &[1, 2, 3], &mut scratch);
}

#[test]
#[should_panic(expected = "assertion failed: ys_len + 2 <= xs_len && xs_len + 6 <= 3 * ys_len")]
fn limbs_mul_to_out_toom_32_fail_5() {
    let mut scratch = vec![0; _limbs_mul_to_out_toom_32_scratch_size(3, 0)];
    let mut out = vec![10, 10, 10, 10];
    _limbs_mul_to_out_toom_32(&mut out, &[6, 7, 8], &[], &mut scratch);
}

#[test]
#[should_panic(expected = "assertion failed: out_limbs.len() >= xs_len + ys_len")]
fn limbs_mul_to_out_toom_32_fail_6() {
    let mut scratch = vec![0; _limbs_mul_to_out_toom_32_scratch_size(6, 4)];
    let mut out = vec![10, 10, 10, 10, 10, 10, 10, 10, 10];
    _limbs_mul_to_out_toom_32(&mut out, &[6, 7, 8, 9, 10, 11], &[1, 2, 3, 4], &mut scratch);
}

#[test]
fn test_mul() {
    let test = |u, v, out| {
        let mut n = Natural::from_str(u).unwrap();
        n *= Natural::from_str(v).unwrap();
        assert_eq!(n.to_string(), out);
        assert!(n.is_valid());

        let mut n = Natural::from_str(u).unwrap();
        n *= &Natural::from_str(v).unwrap();
        assert_eq!(n.to_string(), out);
        assert!(n.is_valid());

        let mut n = Natural::from_str(u).unwrap();
        n._mul_assign_basecase_mem_opt(Natural::from_str(v).unwrap());
        assert_eq!(n.to_string(), out);
        assert!(n.is_valid());

        let n = Natural::from_str(u).unwrap() * Natural::from_str(v).unwrap();
        assert_eq!(n.to_string(), out);
        assert!(n.is_valid());

        let n = &Natural::from_str(u).unwrap() * Natural::from_str(v).unwrap();
        assert_eq!(n.to_string(), out);
        assert!(n.is_valid());

        let n = Natural::from_str(u).unwrap() * &Natural::from_str(v).unwrap();
        assert_eq!(n.to_string(), out);
        assert!(n.is_valid());

        let n = &Natural::from_str(u).unwrap() * &Natural::from_str(v).unwrap();
        assert_eq!(n.to_string(), out);
        assert!(n.is_valid());

        let n = BigUint::from_str(u).unwrap() * BigUint::from_str(v).unwrap();
        assert_eq!(n.to_string(), out);

        let n = rug::Integer::from_str(u).unwrap() * rug::Integer::from_str(v).unwrap();
        assert_eq!(n.to_string(), out);
    };
    test("0", "0", "0");
    test("0", "123", "0");
    test("123", "0", "0");
    test("1", "123", "123");
    test("123", "1", "123");
    test("123", "456", "56088");
    test("0", "1000000000000", "0");
    test("1000000000000", "0", "0");
    test("1", "1000000000000", "1000000000000");
    test("1000000000000", "1", "1000000000000");
    test("1000000000000", "123", "123000000000000");
    test("123", "1000000000000", "123000000000000");
    test("123456789000", "987654321000", "121932631112635269000000");
    test("4294967295", "2", "8589934590");
    test("4294967295", "4294967295", "18446744065119617025");
    test(
        "147502279655636565600250358452694051893980186696958535174009956523855720107322638159749368\
        0808217479494744305876890972595771484769733857514529616096199394092858302265998260483416016\
        5763904522044264005938281072568140883513713255548643044250086110483617215935636533809248102\
        6926590789142079805638445494760177551776636747830014495012489743990407355232286842071418922\
        9921358409573480901624487977319782755422730834468673438076805532952821406024399006814390166\
        6949827530796971086011267864607814906313334525518102221919643040440267323688341889035864376\
        1377246644579088153222669672271414315240318439843720039808993886410874969340996645010795670\
        2133518716987668865936529827437388042190084309005369564717390726257594902619365180097509576\
        6240189037770619308206906414128686856349950952623970023039440323701643457411485666776354448\
        186307133288106956593939073729500658176632828099789",
        "577397114388109712462006371470162814529304445639807296878809567953200969820156259914159240\
        9106139481288193067515284601342023565222679498917484131095648263181800618990427694244342686\
        4412105186059052689237237088193855584354278755933606296018800151986520872701706693002473648\
        4330061421236425747083307907706860804054565348593527605104495080560663025897787060638154303\
        7631781316565710346299551930891169154491973589315700505458672804104869879731391323700304",
        "851673906388325341550957943071111911557800036845129556099360938813259608650267079456739978\
        1156959952275409185911771336067392377245918291754269000751186715279414560474882570499082990\
        4913122978897463970860833616251189242098804876664368441608727895141238953179204529256780277\
        5978105200286025161944212712977056343127682601975191673217459602567633602198262568921008081\
        9448556670912575287371251190800855926311768876808375177446530243635212748346921654224589861\
        0625170426812525829689862407515510419445335472631905610235915226032848323874067128872385291\
        3730739275467227364692195226129501338887049710586931141309357190341064532366013123280106098\
        6468151628797945455179649866890394481799639832540978091736379482964522229064478167730317490\
        8194108506704480750395054067032502530392147690725919399930683143510771646869931527123340650\
        0547649792331568913460415939722111305270588701531404490040034302102101083691706550376288655\
        2667382899390792494118931379237432071316543313379792218794371176529684614085109418328963817\
        0601432767270419229719490809539776535671938041618536196941370647945336401901450921413823163\
        4059991707077834107830876756821880651429748186401020760113859498185638133726165286481741014\
        9079906337286599226335508424466369316294442004040440528589582239717042654541745348050157252\
        3448224036804997350851153108395928780441635856",
    );
}

fn limbs_mul_helper(out_limbs: &Vec<u32>, xs: &Vec<u32>, ys: &Vec<u32>) -> Vec<u32> {
    let mut out_limbs = out_limbs.to_vec();
    let old_out_limbs = out_limbs.clone();
    let highest_result_limb = _limbs_mul_to_out_basecase(&mut out_limbs, xs, ys);
    let n = Natural::from_limbs_asc(xs) * Natural::from_limbs_asc(ys);
    let len = xs.len() + ys.len();
    let mut limbs = n.into_limbs_asc();
    assert_eq!(highest_result_limb, out_limbs[len - 1]);
    assert_eq!(highest_result_limb == 0, limbs.len() < len);
    limbs.resize(len, 0);
    assert_eq!(limbs, &out_limbs[..len]);
    assert_eq!(&out_limbs[len..], &old_out_limbs[len..]);
    out_limbs
}

#[test]
fn limbs_mul_to_out_properties() {
    test_properties_custom_scale(
        2_048,
        triples_of_unsigned_vec_var_10,
        |&(ref out_limbs, ref xs, ref ys)| {
            limbs_mul_helper(out_limbs, xs, ys);
        },
    );
}

#[test]
fn limbs_mul_to_out_toom_22_properties() {
    test_properties_custom_scale(
        2_048,
        triples_of_unsigned_vec_var_11,
        |&(ref out_limbs, ref xs, ref ys)| {
            let expected_out_limbs = limbs_mul_helper(out_limbs, xs, ys);
            let mut out_limbs = out_limbs.to_vec();
            let mut scratch = vec![0; _limbs_mul_to_out_toom_22_scratch_size(xs.len())];
            _limbs_mul_to_out_toom_22(&mut out_limbs, xs, ys, &mut scratch);
            assert_eq!(out_limbs, expected_out_limbs);
        },
    );
}

#[test]
fn limbs_mul_to_out_toom_32_properties() {
    test_properties_custom_scale(
        2_048,
        triples_of_unsigned_vec_var_12,
        |&(ref out_limbs, ref xs, ref ys)| {
            let expected_out_limbs = limbs_mul_helper(out_limbs, xs, ys);
            let mut out_limbs = out_limbs.to_vec();
            let mut scratch = vec![0; _limbs_mul_to_out_toom_32_scratch_size(xs.len(), ys.len())];
            _limbs_mul_to_out_toom_32(&mut out_limbs, xs, ys, &mut scratch);
            assert_eq!(out_limbs, expected_out_limbs);
        },
    );
}

#[test]
fn mul_properties() {
    test_properties_custom_scale(2_048, pairs_of_naturals, |&(ref x, ref y)| {
        let product_val_val = x.clone() * y.clone();
        let product_val_ref = x.clone() * y;
        let product_ref_val = x * y.clone();
        let product = x * y;
        assert!(product_val_val.is_valid());
        assert!(product_val_ref.is_valid());
        assert!(product_ref_val.is_valid());
        assert!(product.is_valid());
        assert_eq!(product_val_val, product);
        assert_eq!(product_val_ref, product);
        assert_eq!(product_ref_val, product);

        let mut mut_x = x.clone();
        mut_x *= y.clone();
        assert!(mut_x.is_valid());
        assert_eq!(mut_x, product);

        let mut mut_x = x.clone();
        mut_x *= y;
        assert_eq!(mut_x, product);
        assert!(mut_x.is_valid());

        let mut mut_x = x.clone();
        mut_x._mul_assign_basecase_mem_opt(y.clone());
        assert!(mut_x.is_valid());
        assert_eq!(mut_x, product);

        let mut mut_x = natural_to_rug_integer(x);
        mut_x *= natural_to_rug_integer(y);
        assert_eq!(rug_integer_to_natural(&mut_x), product);

        assert_eq!(
            biguint_to_natural(&(natural_to_biguint(x) * natural_to_biguint(y))),
            product
        );
        assert_eq!(
            rug_integer_to_natural(&(natural_to_rug_integer(x) * natural_to_rug_integer(y))),
            product
        );
        assert_eq!(y * x, product);
        //TODO assert_eq!((product / x).unwrap(), *y);
        //TODO assert_eq!((product / y).unwrap(), *x);

        if *x != 0 && *y != 0 {
            assert!(product >= *x);
            assert!(product >= *y);
        }
    });

    test_properties_custom_scale(
        2_048,
        pairs_of_natural_and_unsigned,
        |&(ref x, y): &(Natural, u32)| {
            let product = x * Natural::from(y);
            assert_eq!(x * y, product);
            assert_eq!(y * x, product);
        },
    );

    test_properties_custom_scale(
        2_048,
        pairs_of_natural_and_unsigned::<u32>,
        |&(ref x, y)| {
            let product = x * Natural::from(y);
            assert_eq!(x * y, product);
            assert_eq!(y * x, product);
        },
    );

    test_properties_custom_scale(2_048, pairs_of_unsigneds::<u32>, |&(x, y)| {
        assert_eq!(
            Natural::from(u64::from(x) * u64::from(y)),
            Natural::from(x) * Natural::from(y)
        );
    });

    #[allow(unknown_lints, erasing_op)]
    test_properties_custom_scale(2_048, naturals, |x| {
        assert_eq!(x * Natural::ZERO, 0);
        assert_eq!(Natural::ZERO * 0, 0);
        assert_eq!(x * Natural::ONE, *x);
        assert_eq!(Natural::ONE * x, *x);
        //TODO assert_eq!(x * x, x.pow(2));
    });

    test_properties_custom_scale(2_048, triples_of_naturals, |&(ref x, ref y, ref z)| {
        assert_eq!((x * y) * z, x * (y * z));
        assert_eq!(x * (y + z), x * y + x * z);
        assert_eq!((x + y) * z, x * z + y * z);
    });
}
