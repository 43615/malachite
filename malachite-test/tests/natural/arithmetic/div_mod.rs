use common::{test_properties, test_properties_custom_scale};
use malachite_base::num::arithmetic::traits::{
    CeilingDivAssignNegMod, CeilingDivNegMod, DivAssignMod, DivAssignRem, DivMod, DivRem,
};
use malachite_base::num::basic::integers::PrimitiveInteger;
use malachite_base::num::basic::traits::{One, Zero};
use malachite_base::num::conversion::traits::JoinHalves;
#[cfg(not(feature = "32_bit_limbs"))]
use malachite_nz::natural::arithmetic::div_mod::mpn_tdiv_qr;
use malachite_nz::natural::arithmetic::div_mod::{
    _limbs_div_mod_divide_and_conquer, _limbs_div_mod_divide_and_conquer_helper,
    _limbs_div_mod_schoolbook, limbs_div_mod_by_two_limb, limbs_div_mod_three_limb_by_two_limb,
    limbs_two_limb_inverse_helper,
};
use malachite_nz::natural::Natural;
use malachite_nz::platform::{DoubleLimb, Limb};
use malachite_test::common::{
    biguint_to_natural, natural_to_biguint, natural_to_rug_integer, rug_integer_to_natural,
};
use malachite_test::inputs::base::{
    pairs_of_unsigneds_var_2, quadruples_of_three_unsigned_vecs_and_unsigned_var_1,
    quadruples_of_three_unsigned_vecs_and_unsigned_var_2,
    quintuples_of_three_unsigned_vecs_unsigned_and_unsigned_vec_var_1, sextuples_of_limbs_var_1,
    triples_of_unsigned_vec_var_37,
};
use malachite_test::inputs::natural::{
    naturals, pairs_of_natural_and_positive_natural, pairs_of_natural_and_positive_natural_var_1,
    positive_naturals,
};
use malachite_test::natural::arithmetic::div_mod::rug_ceiling_div_neg_mod;
use num::{BigUint, Integer};
use rug;
use std::str::FromStr;

fn verify_limbs_two_limb_inverse_helper(hi: Limb, lo: Limb, result: Limb) {
    let b = Natural::ONE << Limb::WIDTH;
    let b_cubed_minus_1 = (Natural::ONE << (Limb::WIDTH * 3)) - 1 as Limb;
    let x = Natural::from(DoubleLimb::join_halves(hi, lo));
    //TODO use /
    let expected_result = (&b_cubed_minus_1).div_mod(&x).0 - &b;
    assert_eq!(result, expected_result);
    assert!(b_cubed_minus_1 - (result + b) * &x < x);
}

#[cfg(feature = "32_bit_limbs")]
#[test]
fn test_limbs_two_limb_inverse_helper() {
    let test = |hi, lo, result| {
        assert_eq!(limbs_two_limb_inverse_helper(hi, lo), result);
        verify_limbs_two_limb_inverse_helper(hi, lo, result);
    };
    // hi_product >= lo
    // hi_product >= lo_product_hi
    test(0x8000_0000, 0, 0xffff_ffff);
    test(0x8000_0000, 123, 0xffff_ffff);
    test(0x8000_0123, 1, 0xffff_fb74);
    test(0xffff_ffff, 0, 1);
    // hi_product < lo
    test(0xffff_ffff, 123, 0);
    test(0xffff_f123, 1, 0xedd);
    test(0xffff_ffff, 0xffff_ffff, 0);
    // hi_product < lo_product_hi
    // !(hi_product > hi || hi_product == hi && lo_product_lo >= lo)
    test(0x8000_0001, 3, 0xffff_fffb);
    // hi_product > hi || hi_product == hi && lo_product_lo >= lo
    test(2325651385, 3907343530, 3636893938);
}

#[test]
#[should_panic]
fn limbs_two_limb_inverse_helper_fail() {
    limbs_two_limb_inverse_helper(0, 10);
}

fn verify_limbs_div_mod_three_limb_by_two_limb(
    n_2: Limb,
    n_1: Limb,
    n_0: Limb,
    d_1: Limb,
    d_0: Limb,
    q: Limb,
    r: DoubleLimb,
) {
    let n = Natural::from_owned_limbs_asc(vec![n_0, n_1, n_2]);
    let d = Natural::from(DoubleLimb::join_halves(d_1, d_0));
    let r = Natural::from(r);
    assert_eq!((&n).div_mod(&d), (Natural::from(q), r.clone()));
    assert!(r < d);
    assert_eq!(q * d + r, n);
}

#[cfg(feature = "32_bit_limbs")]
#[test]
fn test_limbs_div_mod_three_limb_by_two_limb() {
    let test = |n_2, n_1, n_0, d_1, d_0, q, r| {
        assert_eq!(
            limbs_div_mod_three_limb_by_two_limb(
                n_2,
                n_1,
                n_0,
                d_1,
                d_0,
                limbs_two_limb_inverse_helper(d_1, d_0)
            ),
            (q, r)
        );
        verify_limbs_div_mod_three_limb_by_two_limb(n_2, n_1, n_0, d_1, d_0, q, r);
    };
    // r < d
    // r.upper_half() >= q_0
    test(1, 2, 3, 0x8000_0004, 5, 1, 0x7fff_fffd_ffff_fffe);
    test(2, 0x4000_0000, 4, 0x8000_0000, 0, 4, 0x4000_0000_0000_0004);
    // r >= d
    // r.upper_half() < q_0
    test(
        1614123406,
        3687984980,
        2695202596,
        2258238141,
        1642523191,
        3069918587,
        274277675918877623,
    );
}

fn verify_limbs_div_mod_by_two_limb(
    quotient_limbs_in: &[Limb],
    numerator_limbs_in: &[Limb],
    denominator_limbs: &[Limb],
    quotient_hi: bool,
    quotient_limbs_out: &[Limb],
    numerator_limbs_out: &[Limb],
) {
    let numerator = Natural::from_limbs_asc(numerator_limbs_in);
    let denominator = Natural::from_limbs_asc(denominator_limbs);
    let (expected_quotient, expected_remainder) = (&numerator).div_mod(&denominator);
    let base_quotient_length = numerator_limbs_in.len() - 2;
    let mut quotient_limbs = quotient_limbs_out[..base_quotient_length].to_vec();
    if quotient_hi {
        quotient_limbs.push(1);
    }
    let quotient = Natural::from_owned_limbs_asc(quotient_limbs);
    let remainder = Natural::from_limbs_asc(&numerator_limbs_out[..2]);
    assert_eq!(quotient, expected_quotient);
    assert_eq!(remainder, expected_remainder);
    assert_eq!(
        &quotient_limbs_in[base_quotient_length..],
        &quotient_limbs_out[base_quotient_length..]
    );
    assert_eq!(&numerator_limbs_in[2..], &numerator_limbs_out[2..]);

    assert!(remainder < denominator);
    assert_eq!(quotient * denominator + remainder, numerator);
}

#[cfg(feature = "32_bit_limbs")]
#[test]
fn test_limbs_div_mod_by_two_limb() {
    let test = |quotient_limbs_in: &[Limb],
                numerator_limbs_in: &[Limb],
                denominator_limbs,
                quotient_hi,
                quotient_limbs_out: &[Limb],
                numerator_limbs_out: &[Limb]| {
        let mut quotient_limbs = quotient_limbs_in.to_vec();
        let mut numerator_limbs = numerator_limbs_in.to_vec();
        assert_eq!(
            limbs_div_mod_by_two_limb(&mut quotient_limbs, &mut numerator_limbs, denominator_limbs),
            quotient_hi
        );
        assert_eq!(quotient_limbs, quotient_limbs_out);
        assert_eq!(numerator_limbs, numerator_limbs_out);
        verify_limbs_div_mod_by_two_limb(
            quotient_limbs_in,
            numerator_limbs_in,
            denominator_limbs,
            quotient_hi,
            &quotient_limbs,
            &numerator_limbs,
        );
    };
    // !most_significant_quotient_limb
    test(&[10], &[1, 2], &[3, 0x8000_0000], false, &[10], &[1, 2]);
    test(
        &[10, 10, 10, 10],
        &[1, 2, 3, 4, 5],
        &[3, 0x8000_0000],
        false,
        &[4294967241, 7, 10, 10],
        &[166, 2147483626, 3, 4, 5],
    );
    // most_significant_quotient_limb
    test(
        &[0, 0],
        &[4142767597, 2922703399, 3921445909],
        &[2952867570, 2530544119],
        true,
        &[2360708771, 0],
        &[3037232599, 1218898013, 3921445909],
    );
}

#[test]
#[should_panic]
fn limbs_div_mod_by_two_limb_fail_1() {
    limbs_div_mod_by_two_limb(&mut [10], &mut [1, 2], &[3, 4]);
}

#[test]
#[should_panic]
fn limbs_div_mod_by_two_limb_fail_2() {
    limbs_div_mod_by_two_limb(&mut [10], &mut [1, 2], &[3, 0x8000_0000, 4]);
}

#[test]
#[should_panic]
fn limbs_div_mod_by_two_limb_fail_3() {
    limbs_div_mod_by_two_limb(&mut [10], &mut [1, 2, 3, 4], &[3, 0x8000_0000]);
}

fn verify_limbs_div_mod(
    quotient_limbs_in: &[Limb],
    numerator_limbs_in: &[Limb],
    denominator_limbs: &[Limb],
    quotient_hi: Limb,
    quotient_limbs_out: &[Limb],
    numerator_limbs_out: &[Limb],
) {
    let numerator = Natural::from_limbs_asc(numerator_limbs_in);
    let denominator = Natural::from_limbs_asc(denominator_limbs);
    let (expected_quotient, expected_remainder) = (&numerator).div_mod(&denominator);
    let base_quotient_length = numerator_limbs_in.len() - denominator_limbs.len();
    let mut quotient_limbs = quotient_limbs_out[..base_quotient_length].to_vec();
    if quotient_hi != 0 {
        quotient_limbs.push(quotient_hi);
    }
    let quotient = Natural::from_owned_limbs_asc(quotient_limbs);
    let remainder = Natural::from_limbs_asc(&numerator_limbs_out[..denominator_limbs.len()]);
    assert_eq!(quotient, expected_quotient);
    assert_eq!(remainder, expected_remainder,);
    assert_eq!(
        &quotient_limbs_in[base_quotient_length..],
        &quotient_limbs_out[base_quotient_length..]
    );
    assert!(remainder < denominator);
    assert_eq!(quotient * denominator + remainder, numerator);
}

#[test]
fn test_limbs_div_mod_schoolbook() {
    let test = |quotient_limbs_in: &[Limb],
                numerator_limbs_in: &[Limb],
                denominator_limbs: &[Limb],
                quotient_hi,
                quotient_limbs_out: &[Limb],
                numerator_limbs_out: &[Limb]| {
        let mut quotient_limbs = quotient_limbs_in.to_vec();
        let mut numerator_limbs = numerator_limbs_in.to_vec();
        let inverse = limbs_two_limb_inverse_helper(
            denominator_limbs[denominator_limbs.len() - 1],
            denominator_limbs[denominator_limbs.len() - 2],
        );
        assert_eq!(
            _limbs_div_mod_schoolbook(
                &mut quotient_limbs,
                &mut numerator_limbs,
                denominator_limbs,
                inverse
            ),
            quotient_hi
        );
        assert_eq!(quotient_limbs, quotient_limbs_out);
        assert_eq!(numerator_limbs, numerator_limbs_out);
        verify_limbs_div_mod(
            quotient_limbs_in,
            numerator_limbs_in,
            denominator_limbs,
            if quotient_hi { 1 } else { 0 },
            &quotient_limbs,
            &numerator_limbs,
        );
    };
    #[cfg(feature = "32_bit_limbs")]
    {
        // !most_significant_quotient_limb
        test(
            &[10],
            &[1, 2, 3],
            &[3, 4, 0x8000_0000],
            false,
            &[10],
            &[1, 2, 3],
        );
        // !(n_1 == d_1 && numerator_limbs[i - 1] == d_0)
        // !carry
        test(
            &[10, 10, 10, 10],
            &[1, 2, 3, 4, 5, 6],
            &[3, 4, 0x8000_0000],
            false,
            &[4294967207, 9, 12, 10],
            &[268, 328, 2147483575, 4294967251, 5, 6],
        );
        // carry
        test(
            &[10],
            &[0, 0, 0, 1],
            &[1, 0, 2147483648],
            false,
            &[1],
            &[4294967295, 4294967295, 2147483647, 1],
        );
        // most_significant_quotient_limb
        test(
            &[10; 10],
            &[
                2460989955, 642673607, 1971681331, 2338977519, 475442971, 2516527409, 3470931196,
                4262052990,
            ],
            &[
                1430162564, 1873089879, 3090281851, 2861182896, 2502166555, 2486624904, 960387080,
                3073064701,
            ],
            true,
            &[10, 10, 10, 10, 10, 10, 10, 10, 10, 10],
            &[
                1030827391, 3064551024, 3176366775, 3772761918, 2268243711, 29902504, 2510544116,
                1188988289,
            ],
        );
        // n_1 == d_1 && numerator_limbs[i - 1] == d_0
        test(
            &[10; 8],
            &[
                0, 67108864, 4294963200, 63, 4294443008, 4294967295, 4294967295, 8388575,
                4294836224, 1073741823,
            ],
            &[33554304, 4294443008, 4294967295],
            false,
            &[
                0, 4294443008, 4294967295, 4294967295, 4294967295, 4294967295, 1073741823, 10,
            ],
            &[
                0, 0, 0, 4294443072, 4293918720, 4294967295, 4294967295, 4294967295, 4294836224,
                1073741823,
            ],
        );
    }
    #[cfg(not(feature = "32_bit_limbs"))]
    {
        test(
            &[10; 17],
            &[
                9995257893114397114,
                9401504468144459131,
                558615837638945228,
                10733662027974786928,
                18295107704289976677,
                1814706268673753787,
                12474943759854623335,
                8814778832826774208,
                9159057654048965906,
                4451260977376821357,
                18241701617364042056,
                6169989192350218482,
                15071965537117101028,
                13509168527678537782,
                12224278653171635329,
                16077066393714953826,
                1433938684868066489,
                13014970036232570373,
                899282336249563956,
                3089487642230339536,
                3787737519477527148,
                16667686214395942740,
                8787122953224574943,
                7841835218775877827,
                9693303502025838409,
                16122224776459879427,
                144327425397945219,
            ],
            &[
                2350654041004706911,
                7834348511584604247,
                12756796070221345724,
                3842923787777653903,
                12373799197090248752,
                9712029403347085570,
                1426676505264168302,
                10586232903332693517,
                8387833601131974459,
                6290888746273553243,
                9503969704425173615,
            ],
            false,
            &[
                89235393247566392,
                5198286616477507104,
                15671556528191444298,
                6642842185819876016,
                1703950202232719208,
                6620591674460885314,
                9897211438557358662,
                12382449603707212210,
                13586842887558233290,
                11884313943008627054,
                3205830138969300059,
                4257812936318957065,
                11084100237971796628,
                13937343901544333624,
                11743372027422931451,
                280132530083052382,
                10,
            ],
            &[
                12688955427180652274,
                7641660693922643933,
                8789985477567049482,
                5698832637416200787,
                14684840547760545685,
                2822100467869581421,
                3557573565928866957,
                4409631974409684922,
                16994214656621423610,
                4513108841166793667,
                9009005527785483287,
                4330767427200269309,
                11409205475757922767,
                12430752173702915207,
                11990819624778098799,
                4145020291153594556,
                7099200056207569977,
                3510167930325480168,
                4731667122118327121,
                10720310942075546738,
                5799804483118787221,
                17268037247251138479,
                13305947798457087249,
                1405091439325174594,
                13072181651983436371,
                16122224776459879427,
                144327425397945219,
            ],
        )
    }
}

#[test]
fn test_limbs_div_mod_divide_and_conquer_helper() {
    let test = |quotient_limbs_in: &[Limb],
                numerator_limbs_in: &[Limb],
                denominator_limbs: &[Limb],
                scratch_in: &[Limb],
                quotient_hi,
                quotient_limbs_out: &[Limb],
                numerator_limbs_out: &[Limb],
                scratch_out: &[Limb]| {
        let mut quotient_limbs = quotient_limbs_in.to_vec();
        let mut numerator_limbs = numerator_limbs_in.to_vec();
        let mut scratch = scratch_in.to_vec();
        let inverse = limbs_two_limb_inverse_helper(
            denominator_limbs[denominator_limbs.len() - 1],
            denominator_limbs[denominator_limbs.len() - 2],
        );
        assert_eq!(
            _limbs_div_mod_divide_and_conquer_helper(
                &mut quotient_limbs,
                &mut numerator_limbs,
                denominator_limbs,
                inverse,
                &mut scratch
            ),
            quotient_hi
        );
        assert_eq!(quotient_limbs, quotient_limbs_out);
        assert_eq!(numerator_limbs, numerator_limbs_out);
        assert_eq!(scratch, scratch_out);
    };
    #[cfg(feature = "32_bit_limbs")]
    {
        // hi < DC_DIV_QR_THRESHOLD
        // most_significant_quotient_limb == 0
        // lo < DC_DIV_QR_THRESHOLD
        // !quotient_lo
        test(
            &[10; 6],
            &[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12],
            &[13, 14, 15, 16, 17, 0x8000_0000],
            &[5; 6],
            0,
            &[75085, 25656, 4294965798, 4294966499, 21, 24],
            &[
                4293991192, 4293582579, 4293501313, 4293412419, 4293313687, 2147082789, 37543,
                12845, 2147482899, 4294966897, 11, 12,
            ],
            &[976105, 1384718, 1465985, 363881, 4294944840, 14],
        );
        // carry != 0 first time
        // carry != 0 second time
        test(
            &[
                3650075163, 404462426, 2376958342, 648230142, 2692507541, 4254097613, 1837852164,
                3159945071, 3076827174, 1746393581, 848862043,
            ],
            &[
                1454965277, 156018042, 1386304234, 3933017003, 1840527397, 4169420651, 3343338814,
                1487329926, 3897306601, 3401241545, 3117994664, 2264466925, 3843062712, 3688462745,
                2751679318, 2963108470, 1519717633, 1232770303, 2194740901,
            ],
            &[
                881479879, 1942294987, 2496800868, 3046752185, 3774873792, 2622161570, 566787739,
                1447674683, 2410287828,
            ],
            &[
                4244462898, 2669959604, 1812876641, 540444868, 370935699, 3785539585, 3780133203,
                1773663273, 1379840789, 1410566894,
            ],
            0,
            &[
                4200257899, 3153780761, 4089908189, 4114439647, 2799123152, 4201558754, 3905055721,
                1211637777, 2196711975, 1746393581, 848862043,
            ],
            &[
                1719308272, 2140366608, 603584626, 4153497816, 2390323322, 1104162273, 2593179664,
                1832710243, 1641806016, 3807959572, 4011228742, 704173432, 2308977722, 3864948954,
                391140865, 637314672, 1519717633, 1232770303, 2194740901,
            ],
            &[
                1498616763, 1900241408, 1481354048, 1578056262, 3110801788, 2810296474, 3131608484,
                1900021275, 3616206906, 1410566894,
            ],
        );
        // most_significant_quotient_limb != 0
        test(
            &[
                1160649470, 1230989586, 512562924, 1373938734, 3299208920, 3401055209, 42251693,
                2288005213, 3343756354, 954674868, 3527744494, 1930721795, 3001821203, 3573297662,
                4048916297,
            ],
            &[
                2057148366, 583267941, 379603263, 1865015969, 1062830871, 2288359129, 3742364509,
                672116401, 3779321685, 3524939949, 68128087, 4130811928, 3561664791, 3396354675,
                2634760529, 2501767046,
            ],
            &[
                143145757, 1928526231, 53490016, 4085239653, 3537190597, 2299226070, 3077712915,
            ],
            &[
                3464102302, 114904991, 3306074524, 4090773383, 4268119608, 3155351764, 3566536963,
            ],
            1,
            &[
                32959004, 4135046788, 271859649, 290785547, 2160143013, 2409308839, 444666535,
                2288005213, 3343756354, 954674868, 3527744494, 1930721795, 3001821203, 3573297662,
                4048916297,
            ],
            &[
                449879714, 2878803964, 610959982, 3980950674, 2921132068, 1744272022, 1577940436,
                3129245204, 1125263020, 194810786, 58533608, 3405394822, 1262438721, 318641760,
                2634760529, 2501767046,
            ],
            &[
                1607268652, 1999431273, 4063610576, 3427915471, 871357890, 1653319155, 258584465,
            ],
        );
        // hi >= DC_DIV_QR_THRESHOLD
        // lo >= DC_DIV_QR_THRESHOLD
        test(
            &[
                1925999587, 3310842987, 1943880039, 3068623696, 3394859190, 3593884525, 2759145989,
                4181168246, 1640302881, 3837720411, 660860204, 511270360, 2627995609, 1809849060,
                615191647, 836844414, 1828195297, 3749120985, 159179676, 129309193, 3123771746,
                1011690856, 3278099944, 2517344232, 2914547791, 1835191081, 576624965, 561250890,
                582440631, 318411661, 1060428917, 4237290203, 901501900, 1855747497, 371007244,
                3283537081, 3237063803, 1485593014, 193923221, 1981929294, 617652486, 290656393,
                3013470276, 1031354037, 1068739322, 32355658, 1886082024, 1222490526, 4021843027,
                2253785709, 1514545130, 3968550004, 2129532850, 384056389, 3303449199, 3030639197,
                1693728619, 3379721754, 2596206443, 1207906168, 3133034696, 2249085793, 2830694631,
                614897762, 3616300986, 1800418887, 1586049611, 2456467232, 1932579993, 462953139,
                686240231, 1587148042, 2714049545, 3997401795, 1583798572, 1444461065, 78015599,
                1509108530, 2363890341, 489830073, 2786979498, 4081947412, 3376874670, 1104007584,
                1591646211, 905224254, 334699922, 246635559, 1617636730, 748018649, 889143140,
                50373080, 3351342053, 572744072, 2901371037, 2106149692, 2547050367, 4287383464,
                4054800630, 1542073428, 1479008428, 818312892, 3950789462, 3241273259, 2293449065,
                797464662, 3063425238, 2155388055, 1481420947, 780106530, 579092029, 3836696522,
                79494402, 4058534010, 81681058, 808971893, 3033983673, 994913191, 1497913790,
                3318581487, 1234677646, 2348191231, 2297107745, 1756885812, 3967547420, 68938920,
                2792342109, 2564431912, 3710061649, 3066477507, 906692329, 971192593, 3433101239,
                3781329010, 1467921514, 1245491152, 3954261867, 236530141, 3914896416, 2096194762,
                299508578, 3493226751, 2414573261, 571354822, 1841867387, 970344149, 2085042560,
                1299362491, 1913753608, 738639249, 519874939, 3157732274, 1274874879, 3613110677,
                218812728, 4172579643, 3707816606, 528702087, 3551605386, 3555196151, 3539938289,
                1651879332, 3758444796, 1660600737, 3929222748, 2687928169, 1693437382, 3375533994,
                1598030053, 2835638091, 4271135853, 1004799928, 3706096603, 1223481056, 2614484262,
                2428782661, 122045041, 872251822, 2976520080, 320209896, 1430353573, 634796284,
                889713253, 2553345511, 3154718773, 1573587943, 3434149495, 1222439451, 3818391276,
                127882650, 3428266099, 839828009, 2917982642, 185416346, 670838205, 2637097959,
                2412931975, 1023425398, 980612561, 3107345275, 1299250195, 490635258, 3006121984,
                50586217, 2933423714, 1867098753, 251360814, 1816611565, 3503934781, 3855566329,
                1359056046, 1308856656, 3023221749, 227767551, 1032521295, 1735360000, 2365425843,
                1790921994, 4233038373, 1104084146, 728221746, 516926849, 2830235548, 2385455431,
                3560186517, 1456935907, 1474184516, 502223446, 691936748, 2027265070, 894241983,
                873923167, 3424411519, 233264854, 2467955093, 4234157407, 1508466304, 3286062356,
                2103147761, 3756678995, 825011197, 3128974643, 566824549, 3707345735, 131619312,
                2097353521, 3403879978, 2480175805, 1774923780, 393188903, 3222896292, 3562618019,
                234890772, 269316353, 1244143512, 267234244, 1311937427, 1362450988, 3975430908,
                1341444418, 3661958165, 3280060275, 3434130706, 1634318561, 4001988842, 2557536012,
                2146387651, 366290469, 1567001566, 1906564439,
            ],
            &[
                3864356172, 3759381088, 2973528858, 2207455883, 732791701, 959776149, 1052386573,
                2824021630, 3684158041, 4010955233, 2478036554, 2187901343, 3473883669, 1023916572,
                2342296567, 3066200661, 3296348546, 1114875627, 2934381479, 965977792, 3325321732,
                1869113191, 1293287891, 234880387, 2363256950, 734980829, 3381052369, 3890916149,
                1507752332, 3706381054, 3000684807, 2692608749, 3079243818, 1150916836, 3597434333,
                2577669234, 1383975831, 3673206517, 1077349628, 1531911672, 2048337060, 2752975066,
                911330952, 2101916653, 2098438263, 692817608, 1963389070, 945853163, 4137185243,
                3365235006, 162365445, 3757197634, 4288009265, 3346989831, 2812645596, 2241243583,
                311409474, 309471809, 3734000471, 3279839897, 1784333811, 3742338102, 3090885922,
                3902729466, 1063897326, 3260202651, 1395583903, 2230814045, 3154157813, 681254595,
                2789364947, 1239697201, 1849094194, 3672550338, 2925244065, 2491726527, 3974757591,
                3637660426, 767266756, 342943790, 1514863857, 3696418128, 2289616199, 1080110765,
                2399874059, 1288187596, 3981167427, 2985020981, 1534252240, 834702605, 517058206,
                551155694, 3325477153, 529442223, 1235456447, 1673397767, 2570531045, 2008957863,
                3839734453, 217179525, 2289590545, 118556579, 2138198803, 3240930704, 423985756,
                919433365, 2413247431, 1326809927, 1050933124, 1171458752, 556638692, 1664760920,
                2066149017, 2734305302, 3547707974, 1146490588, 166261628, 2543286296, 2472240402,
                2899403086, 1236758247, 2763492890, 798872987, 4055743058, 1630048344, 1711683208,
                2284440083, 2687594846, 2123310497, 1766118060, 1863014906, 3090503150, 559682382,
                749002481, 93168939, 3845351806, 3980043053, 1082302073, 3319301996, 564557175,
                1134479415, 864519271, 15952534, 3870948540, 1476355737, 2906040107, 1475951003,
                4189242780, 1657835614, 875761744, 3303203991, 2055370463, 703818440, 3946618417,
                2362162988, 1145068984, 770075133, 2762848273, 2457395245, 3257099434, 1763674141,
                1048533761, 3324029711, 2215085101, 188721084, 1101206321, 1413552611, 3989124328,
                3245744575, 885799233, 157308456, 1009714551, 4171598186, 3712689058, 664264259,
                3136378549, 954651654, 3077652643, 2096370948, 3122137900, 846376481, 243460017,
                3279702973, 2498977610, 3450393668, 1342262115, 2153130849, 2548762656, 2045516031,
                3392083608, 437330999, 3208776510, 3255398260, 3039778968, 3834676913, 2341776769,
                3714246070, 1743879297, 2942875317, 1642861085, 3193299966, 3305922985, 1094448889,
                3660580610, 1403362070, 4087236678, 621757536, 4142175861, 3934265976, 3058211919,
                1933982930, 4098837027, 4262215692, 2543267144, 3599285623, 2690770583, 2560943533,
                3589362432, 1439594559, 1790843457, 2816863086, 2560203281, 4171268859, 4156495540,
                549481065, 588661706, 3734713219, 1718857187, 4077742963, 971147536, 304511891,
                1368071520, 1601135726, 1436491346, 4170216492, 24075886, 1827767778, 1475511461,
                3320082545, 3247035446, 860400612, 4101890332, 1144650504, 276381979, 2717227940,
                148915751, 3836567991, 894190981, 3372642972, 2347280146, 430786206, 3070947846,
                1015360917, 2876208241, 3729940888, 3312507046, 3964105260, 3302890651, 1551566982,
                2082707586, 1556752259, 712427501, 2787839272, 2532321455, 3821995818, 3759680619,
                2970609617, 1412878837, 4085093861, 1503114689, 1685033479, 1412547642, 2831775952,
                2252024073, 2397779547, 2785476981, 223469779, 3640682284, 2368770987, 3260202199,
                348005452, 284315017, 379596743, 2720275440, 4058254572, 3654872147, 862399395,
                884009544, 3294601468, 1502442710, 98535153, 2608517920, 2300062382, 595230163,
                156997626, 3453234161, 2112307240, 198621770, 813368639, 229919951, 2986892448,
                37462817, 38857061, 2092485960, 3933936383, 597198297, 3032161805, 3032057222,
                2851948600, 3756580086, 1415523836, 1561345455, 3382211445, 2231315801,
            ],
            &[
                1940168977, 3230556788, 502228327, 687551695, 1837528416, 249254226, 20556871,
                1097227383, 1638530275, 4238302571, 1363251303, 2884628582, 1148429609, 61756119,
                1339804173, 1701944412, 3899025312, 820356765, 4193218236, 1916851, 3850849488,
                2684839307, 2963197137, 4021704957, 3353103231, 3636867888, 1255779572, 179772025,
                1268126926, 3113942956, 1308847407, 1659345082, 2741511343, 4280255705, 3874307034,
                644996159, 4190266717, 4255232181, 4086073202, 1655671151, 3311062699, 2620080067,
                150957949, 777173218, 3837215271, 2254110731, 1823765742, 2094445810, 1586502495,
                2354640272, 3635181666, 2686911611, 2530269646, 260580809, 2279701129, 4212647912,
                92873470, 1932506312, 2396516716, 3591357295, 3104084946, 3666131683, 2150965270,
                1015611727, 3692113500, 3201683697, 4152861011, 2214725007, 50924182, 3487300677,
                4164147175, 3593899586, 1571047157, 4275272285, 2266962913, 804354334, 1453516832,
                1332289252, 1888746125, 238481662, 2083773928, 897004921, 84594192, 3388861096,
                1187590829, 4037296342, 2311181146, 1168097801, 1461061849, 3572733459, 2759766390,
                3438057323, 3942595917, 1938663436, 3809649742, 767622277, 4145960711, 3475107536,
                631263540, 3085991526, 1701735861, 1265437957, 4280125298, 3578736872, 4176326278,
            ],
            &[
                406867658, 3405381036, 808018256, 2223614431, 2145171509, 3518742808, 250514275,
                3753705906, 3013812157, 3829477829, 1935716824, 3301475982, 3661466979, 3499002209,
                3967281545, 3633902194, 171046725, 3240899935, 947932436, 2424617811, 2938983289,
                3075742045, 1532319545, 2814518237, 2004531065, 1442849553, 756868801, 2512647721,
                3087911835, 3536820547, 1254121250, 3430651256, 1462727031, 1620652198, 1782267394,
                1355400836, 1896196900, 2707292069, 237927955, 2059311737, 833978303, 3579333605,
                3406595195, 2943811271, 4155553905, 1125988217, 573477537, 1161469892, 2230750582,
                3136147356, 4193456800, 955009875, 483204329, 2979505953, 549147849, 4178779119,
                4129365930, 132806718, 3009551892, 3304131634, 327713775, 2203696611, 1213644639,
                2845904123, 1141657026, 2070910484, 164241079, 119040092, 1669073017, 1556830443,
                139047001, 3125245844, 94641812, 3419619495, 130528087, 448555838, 3094400611,
                3129300152, 58940216, 1834305685, 3756963570, 1106430083, 2525438147, 3349271607,
                4037149655, 4227379014, 3666952486, 1128402069, 752745132, 383044625, 3799831396,
                4212483272, 635376793, 2423257815, 1104432102, 576078145, 920054080, 1643179928,
                3042449076, 2003856809, 3454892373, 1759226539, 3304584552, 286216878, 4012534432,
                2710529232, 1141374999, 2700046055, 2902668677, 1400993854, 268299471, 1589090515,
                911988301, 2151160727, 1161140045, 2845388811, 2394066714, 461982038, 531607890,
                1617768892, 2229320447, 4009293808, 345437455, 2891080494, 589568254, 3444895727,
                1426691531, 3670662893, 2912725629, 4154201926, 1510269998, 2043871488, 2216683376,
                441581006, 1485888456, 760592633, 4138362099, 789863623, 2322873479, 546975672,
                3396104257, 369041505, 1834801989, 3723602184, 3889531017, 1472233087,
            ],
            0,
            &[
                17173825, 108042902, 3268218522, 2077287814, 2586341653, 4000033719, 728115586,
                4001266677, 2972089267, 4063721631, 2176226304, 3453763686, 3986789007, 661755479,
                906862843, 2753152000, 2417656423, 2974034126, 359365706, 510242545, 74006754,
                49102790, 3875409273, 618298780, 2397713953, 1154290753, 1091884725, 198746303,
                3589247215, 3658111370, 800898532, 814378888, 1928524512, 2353040310, 2080695898,
                2396321959, 792031536, 1027035676, 2965261468, 683665442, 319719623, 3469336861,
                368308673, 284540973, 3851033448, 796392523, 283241674, 3660958674, 3753830211,
                3775307142, 918902278, 2827679966, 3635219649, 4043872879, 3083059094, 2719285819,
                2206202145, 402788013, 300254578, 2235964887, 2300529629, 921152093, 3796445053,
                1626790462, 2917665209, 3576186670, 1029594824, 4198785964, 1550896469, 3235089997,
                585010100, 3016490054, 135547421, 2810520363, 164483360, 4079775000, 57269257,
                2220102573, 4282245180, 838819943, 4162726035, 2996481807, 1421083611, 881862265,
                4009915928, 230804290, 2656124443, 2341988975, 3845407707, 3526071560, 134345937,
                1962912136, 1506674643, 2726832740, 1153556711, 1011435279, 3828302594, 2736615491,
                3233850936, 2007915681, 2820599964, 1572989616, 451610424, 1609043148, 3145089560,
                797464662, 3063425238, 2155388055, 1481420947, 780106530, 579092029, 3836696522,
                79494402, 4058534010, 81681058, 808971893, 3033983673, 994913191, 1497913790,
                3318581487, 1234677646, 2348191231, 2297107745, 1756885812, 3967547420, 68938920,
                2792342109, 2564431912, 3710061649, 3066477507, 906692329, 971192593, 3433101239,
                3781329010, 1467921514, 1245491152, 3954261867, 236530141, 3914896416, 2096194762,
                299508578, 3493226751, 2414573261, 571354822, 1841867387, 970344149, 2085042560,
                1299362491, 1913753608, 738639249, 519874939, 3157732274, 1274874879, 3613110677,
                218812728, 4172579643, 3707816606, 528702087, 3551605386, 3555196151, 3539938289,
                1651879332, 3758444796, 1660600737, 3929222748, 2687928169, 1693437382, 3375533994,
                1598030053, 2835638091, 4271135853, 1004799928, 3706096603, 1223481056, 2614484262,
                2428782661, 122045041, 872251822, 2976520080, 320209896, 1430353573, 634796284,
                889713253, 2553345511, 3154718773, 1573587943, 3434149495, 1222439451, 3818391276,
                127882650, 3428266099, 839828009, 2917982642, 185416346, 670838205, 2637097959,
                2412931975, 1023425398, 980612561, 3107345275, 1299250195, 490635258, 3006121984,
                50586217, 2933423714, 1867098753, 251360814, 1816611565, 3503934781, 3855566329,
                1359056046, 1308856656, 3023221749, 227767551, 1032521295, 1735360000, 2365425843,
                1790921994, 4233038373, 1104084146, 728221746, 516926849, 2830235548, 2385455431,
                3560186517, 1456935907, 1474184516, 502223446, 691936748, 2027265070, 894241983,
                873923167, 3424411519, 233264854, 2467955093, 4234157407, 1508466304, 3286062356,
                2103147761, 3756678995, 825011197, 3128974643, 566824549, 3707345735, 131619312,
                2097353521, 3403879978, 2480175805, 1774923780, 393188903, 3222896292, 3562618019,
                234890772, 269316353, 1244143512, 267234244, 1311937427, 1362450988, 3975430908,
                1341444418, 3661958165, 3280060275, 3434130706, 1634318561, 4001988842, 2557536012,
                2146387651, 366290469, 1567001566, 1906564439,
            ],
            &[
                1442095867, 1425259645, 1884903791, 1777903625, 3175769087, 3807598758, 762514608,
                2628241683, 2084076649, 2060089344, 2624901677, 1621900217, 1707153566, 3577011923,
                1541004439, 1886484210, 3260086307, 2227090668, 3107722150, 477655641, 1202597635,
                953231660, 1681598198, 866048426, 3273941270, 1109725082, 521571384, 7742194,
                3862109316, 3658450737, 3037639171, 2012203251, 3171115038, 1831832931, 1807210774,
                1597488621, 3664077634, 3454103999, 3661201384, 874866833, 4223535116, 668055932,
                1005264184, 1838301981, 4277552452, 3554262023, 641553690, 954124858, 226894863,
                165265274, 3203114657, 135449553, 55362086, 1862739834, 433509723, 1759059070,
                3373456730, 3059791826, 1374478332, 2797147610, 1456358652, 1587227145, 3720068854,
                2046928661, 3363019938, 2244711194, 2118936570, 2822640163, 3101352371, 3218263532,
                2318402149, 2882896828, 622486543, 298561760, 3914883643, 526690601, 3361553597,
                3970670614, 3141459956, 3031460970, 4050183357, 4017772453, 2030298849, 3839055614,
                3042343018, 446833229, 3003902139, 1272068786, 173053130, 4090926829, 4052557131,
                1139284674, 1102707331, 3627992954, 3034622508, 3659010656, 3548662253, 2057502601,
                1881942227, 2627523832, 434242875, 1542454014, 3991883391, 2343729585, 1640968092,
                1530748226, 3026731173, 1023268612, 793845803, 2550982790, 2433297913, 3643977563,
                1249063196, 2790066999, 1506091162, 220612379, 4173355440, 1478340551, 307271052,
                2583703244, 193017786, 2482201803, 3279357412, 1535228581, 4222296231, 2861585095,
                175746686, 880512092, 2933569786, 3818211073, 1122405474, 2459990655, 1123199959,
                1153265312, 3988497069, 3624545847, 3030008208, 3571450059, 2687168177, 1857154957,
                76602940, 697930765, 3068498274, 1770346452, 2051970411, 3009167677, 4010609560,
                2388957577, 4092838901, 2792912169, 2288959372, 2958571738, 1858165290, 2191937932,
                1203999286, 3843879353, 2749570214, 532861077, 1846219350, 2430607946, 1997198152,
                3105192053, 2141396849, 3548006510, 1399065173, 3057434715, 3284854281, 3519461629,
                3850820305, 3284351296, 3311466997, 1845218280, 3199029323, 156014642, 295920886,
                3603164923, 1869049205, 4158087923, 1267663018, 2395412305, 412695731, 2854190757,
                2158776092, 3899086337, 1456459857, 3203161022, 1591182881, 3519585282, 1443466957,
                4220521144, 1325854930, 4058082820, 3220277229, 3900844075, 1978837052, 523987694,
                1847133024, 2641015611, 2575900656, 581020248, 2179157442, 2676548852, 920711706,
                7182797, 3902652740, 2542657919, 912170953, 3474703690, 3934265976, 3058211919,
                1933982930, 4098837027, 4262215692, 2543267144, 3599285623, 2690770583, 2560943533,
                3589362432, 1439594559, 1790843457, 2816863086, 2560203281, 4171268859, 4156495540,
                549481065, 588661706, 3734713219, 1718857187, 4077742963, 971147536, 304511891,
                1368071520, 1601135726, 1436491346, 4170216492, 24075886, 1827767778, 1475511461,
                3320082545, 3247035446, 860400612, 4101890332, 1144650504, 276381979, 2717227940,
                148915751, 3836567991, 894190981, 3372642972, 2347280146, 430786206, 3070947846,
                1015360917, 2876208241, 3729940888, 3312507046, 3964105260, 3302890651, 1551566982,
                2082707586, 1556752259, 712427501, 2787839272, 2532321455, 3821995818, 3759680619,
                2970609617, 1412878837, 4085093861, 1503114689, 1685033479, 1412547642, 2831775952,
                2252024073, 2397779547, 2785476981, 223469779, 3640682284, 2368770987, 3260202199,
                348005452, 284315017, 379596743, 2720275440, 4058254572, 3654872147, 862399395,
                884009544, 3294601468, 1502442710, 98535153, 2608517920, 2300062382, 595230163,
                156997626, 3453234161, 2112307240, 198621770, 813368639, 229919951, 2986892448,
                37462817, 38857061, 2092485960, 3933936383, 597198297, 3032161805, 3032057222,
                2851948600, 3756580086, 1415523836, 1561345455, 3382211445, 2231315801,
            ],
            &[
                2422260305, 2334121443, 1088625067, 429552258, 1851989910, 1447144686, 289871964,
                195779947, 1600081392, 1950865889, 4148102173, 566001125, 1766730103, 1741871945,
                801292127, 1179716451, 36262239, 3182752255, 4121626624, 488322150, 2122724097,
                915881531, 3906656989, 3663799256, 3384282975, 3920223042, 2859480984, 3883173955,
                1940610312, 47930316, 4258012932, 680405497, 4203096076, 3614051200, 1790223558,
                980180613, 2014865493, 219102517, 1711115540, 657044838, 2119769240, 2084919133,
                4201034064, 263614671, 2115853107, 1433522880, 1321835379, 4286695601, 3910290379,
                3199969732, 1254218084, 3621748080, 3844200506, 4164698311, 3502226552, 865341111,
                540925471, 757591793, 1430063306, 4129093409, 2383842279, 4278252470, 3063505514,
                429106204, 3522947207, 1678028967, 828832434, 170284812, 2462261564, 4056737020,
                1079922015, 1109994240, 239815824, 2610194785, 2061084469, 2620112404, 134907464,
                2686871017, 1270744298, 1309713827, 2212132498, 970028981, 916446327, 1259611281,
                999199468, 3274822347, 3775383526, 2218503902, 1592101059, 585488370, 2625072423,
                1503465265, 893164758, 4888580, 1852474847, 77875921, 2930969263, 1691577674,
                2627212818, 4267036794, 1006033654, 992470411, 3347926021, 1054690213, 1665855010,
                2710529232, 1141374999, 2700046055, 2902668677, 1400993854, 268299471, 1589090515,
                911988301, 2151160727, 1161140045, 2845388811, 2394066714, 461982038, 531607890,
                1617768892, 2229320447, 4009293808, 345437455, 2891080494, 589568254, 3444895727,
                1426691531, 3670662893, 2912725629, 4154201926, 1510269998, 2043871488, 2216683376,
                441581006, 1485888456, 760592633, 4138362099, 789863623, 2322873479, 546975672,
                3396104257, 369041505, 1834801989, 3723602184, 3889531017, 1472233087,
            ],
        );
    }
    #[cfg(not(feature = "32_bit_limbs"))]
    {
        test(
            &[
                17572162751360544244,
                8819660083286717264,
                69135776031233389,
                9998360095371859020,
                1528928997031509791,
                12805160204156629031,
                8189615704171780683,
                2467675461409164019,
                782953727844991423,
                6355321416294201810,
                3548418573913501932,
                1385195069445654350,
                13512602943141297700,
                3524217759662463436,
                15981277851376785202,
                12068598413178807016,
                18233498041601520144,
                2375502627693604799,
                16956133502968527252,
                11788850786377567039,
                11202538381248983997,
                17482018504857740095,
                9943113291088195605,
                5416385292050986207,
                8819536346488991181,
                1598965950294021235,
                7882433753150467476,
                11743953932529749849,
                10411233691475182105,
                17683252058144329516,
                2922512632182218442,
                2382866619354154085,
                9172180753684645874,
            ],
            &[
                10105659428154830950,
                16080122897863747159,
                6673547445599414511,
                11590428152693613362,
                15656796674143758153,
                13854182285237220276,
                17678343821108802601,
                4369330246412531640,
                9259631508948401460,
                12754317407998722916,
                14030093772258243923,
                12445528589737756681,
                12390141941180011208,
                17818097568992876719,
                12989074377855915831,
                15055008450343622597,
                11775717793939542741,
                9833777944799450829,
                1788609959115009762,
                10560041894305231808,
                9536970158738359525,
                1647965462344397494,
                4996752293272243711,
                13137844160192969508,
                2796962560281872214,
                643321940596004625,
                13724093349212267288,
                514656857224167647,
                17466700348969860335,
                1993575779441570801,
                8868832811893337322,
                15570108310943406655,
                4603018448416072746,
                7200423584330501685,
                16017076175667054324,
                5847681228393669991,
            ],
            &[
                2828382444363234501,
                14019650302598222399,
                7149153771500111721,
                5808789510078375243,
                11746020933581287784,
                13963712573526024090,
                7948303882471336756,
                1363675852130084180,
                6084755510768204882,
                1350344795057047203,
                9774965847686534495,
                3240922473188564283,
                15530555198365657320,
                10072507218045872484,
            ],
            &[
                3916176418979954809,
                13668445226587840112,
                4649545877528018706,
                4592844313008508560,
                1015698297474974096,
                4103788998158380965,
                3916718682939004578,
                15207100641670612500,
                17177134784967667913,
                11566641647595164661,
                9169819837968929550,
                3912314602443680574,
                4920758471477644048,
                1409530806025278074,
                5510606243797201171,
                12655419700909080809,
                17478621877874030166,
                15321181022827604413,
                13764600376461182213,
                13135951171767226708,
                11464308217997836339,
                3414688123447059622,
                3041528540948075342,
                10902064393009370906,
                2740240708380754029,
                16105489040588988796,
                232349632301822035,
                3740450900174558001,
                10226882414186792277,
                2705057468055419157,
                18212106751345336709,
                10131854424711804281,
                10927936284107448631,
                17500260223554361358,
                9690107344320395824,
                8855064790737373332,
                16595409933208348428,
                2736868038549555369,
                14216258614790256085,
                14646314481214938667,
                3856845432180453767,
                13546822972661162095,
                12602514397777370047,
                5549225470399653441,
                15257956181957241657,
                1262811690033316268,
                377255999899508731,
                8164999116021155449,
                6826996163805010560,
                14629381018204188454,
                16811818456558675342,
                4062419164792366769,
                18281154867218769619,
                13583126012283138362,
                4914318060782464332,
                8615549598564119112,
                640338775759859639,
                9509768036321096174,
                11037969681096120955,
                16326637696328881868,
                7831855429776928274,
                2076088851521012520,
                3886895293499168336,
                9280832655729778289,
                3296617758093253096,
                2171889737571423791,
                16237656590956752013,
                1726250002529405870,
                11764897685228775022,
                15958943103426875449,
                17812138286701900961,
                9450057600621232816,
                9049650057365475277,
                5301777602331001564,
                15381606785008766966,
                9846985188738170204,
                13702195215462452787,
                1958995251130615636,
                16946083440253521233,
            ],
            0,
            &[
                17268182715902625458,
                3814961318301672608,
                4833680902046068822,
                2553855042388431665,
                6335398859967270264,
                446578878991365047,
                5919639150554682533,
                10143632221624494847,
                14332968394883847715,
                8864237429404827524,
                13971809979410591917,
                16532475063079451499,
                10834877969562798827,
                942540236058102443,
                15981277851376785202,
                12068598413178807016,
                18233498041601520144,
                2375502627693604799,
                16956133502968527252,
                11788850786377567039,
                11202538381248983997,
                17482018504857740095,
                9943113291088195605,
                5416385292050986207,
                8819536346488991181,
                1598965950294021235,
                7882433753150467476,
                11743953932529749849,
                10411233691475182105,
                17683252058144329516,
                2922512632182218442,
                2382866619354154085,
                9172180753684645874,
            ],
            &[
                14289061310848733548,
                17326460337073238260,
                9482030193369049155,
                1477555057769672694,
                1804695980665651852,
                13858465374526238772,
                12818143718428350308,
                17383203216393145613,
                12431083803667516452,
                15204035285285328576,
                15162781106599025416,
                113739810898596116,
                14880106289005993152,
                2559762150634107201,
                3545649299581479587,
                57120415063081580,
                11158277808456361419,
                788522906312422007,
                17454553103090554802,
                16954386397459924245,
                3232310690381825941,
                14115784819037932758,
                12858150114133136365,
                17102774791488490622,
                5971027607386938639,
                9323860546443201055,
                13724093349212267288,
                514656857224167647,
                17466700348969860335,
                1993575779441570801,
                8868832811893337322,
                15570108310943406655,
                4603018448416072746,
                7200423584330501685,
                16017076175667054324,
                5847681228393669991,
            ],
            &[
                14263342191015649018,
                17200406634500060514,
                15638261325939916971,
                10112873094923940667,
                13852100693478106301,
                18442460984420533120,
                4860200102680452292,
                7401158214689776648,
                9458499398374568987,
                6308354756610538129,
                5084248657548615762,
                1957203375634754042,
                2040165737909650984,
                2550644745499597578,
                5510606243797201171,
                12655419700909080809,
                17478621877874030166,
                15321181022827604413,
                13764600376461182213,
                13135951171767226708,
                11464308217997836339,
                3414688123447059622,
                3041528540948075342,
                10902064393009370906,
                2740240708380754029,
                16105489040588988796,
                232349632301822035,
                3740450900174558001,
                10226882414186792277,
                2705057468055419157,
                18212106751345336709,
                10131854424711804281,
                10927936284107448631,
                17500260223554361358,
                9690107344320395824,
                8855064790737373332,
                16595409933208348428,
                2736868038549555369,
                14216258614790256085,
                14646314481214938667,
                3856845432180453767,
                13546822972661162095,
                12602514397777370047,
                5549225470399653441,
                15257956181957241657,
                1262811690033316268,
                377255999899508731,
                8164999116021155449,
                6826996163805010560,
                14629381018204188454,
                16811818456558675342,
                4062419164792366769,
                18281154867218769619,
                13583126012283138362,
                4914318060782464332,
                8615549598564119112,
                640338775759859639,
                9509768036321096174,
                11037969681096120955,
                16326637696328881868,
                7831855429776928274,
                2076088851521012520,
                3886895293499168336,
                9280832655729778289,
                3296617758093253096,
                2171889737571423791,
                16237656590956752013,
                1726250002529405870,
                11764897685228775022,
                15958943103426875449,
                17812138286701900961,
                9450057600621232816,
                9049650057365475277,
                5301777602331001564,
                15381606785008766966,
                9846985188738170204,
                13702195215462452787,
                1958995251130615636,
                16946083440253521233,
            ],
        )
    }
}

#[cfg(feature = "32_bit_limbs")]
#[test]
fn test_limbs_div_mod_divide_and_conquer() {
    let test = |quotient_limbs_in: &[Limb],
                numerator_limbs_in: &[Limb],
                denominator_limbs: &[Limb],
                quotient_hi,
                quotient_limbs_out: &[Limb],
                numerator_limbs_out: &[Limb]| {
        let mut quotient_limbs = quotient_limbs_in.to_vec();
        let mut numerator_limbs = numerator_limbs_in.to_vec();
        let inverse = limbs_two_limb_inverse_helper(
            denominator_limbs[denominator_limbs.len() - 1],
            denominator_limbs[denominator_limbs.len() - 2],
        );
        assert_eq!(
            _limbs_div_mod_divide_and_conquer(
                &mut quotient_limbs,
                &mut numerator_limbs,
                denominator_limbs,
                inverse
            ),
            quotient_hi
        );
        assert_eq!(quotient_limbs, quotient_limbs_out);
        assert_eq!(numerator_limbs, numerator_limbs_out);
        verify_limbs_div_mod(
            quotient_limbs_in,
            numerator_limbs_in,
            denominator_limbs,
            quotient_hi,
            &quotient_limbs,
            &numerator_limbs,
        );
    };
    // qn <= dn
    // qn < DC_DIV_QR_THRESHOLD
    // qn != dn second time
    test(
        &[10, 10, 10, 10],
        &[1, 2, 3, 4, 5, 6, 7, 8, 9],
        &[3, 4, 5, 6, 7, 0x8000_0000],
        0,
        &[4294967057, 15, 18, 10],
        &[718, 910, 1080, 1286, 1492, 2147483434, 4294967176, 8, 9],
    );
    // cy != 0 third time
    test(
        &[0, 0, 0],
        &[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
        &[0, 0, 0, 0, 1, 0, 0, 2147483648],
        0,
        &[1, 0, 0],
        &[
            0, 0, 0, 0, 4294967295, 4294967295, 4294967295, 2147483647, 1, 0, 0,
        ],
    );
    // qh != 0 third time
    test(
        &[
            1341443830, 680228019, 2358294753, 4240552485, 4220791420, 3445360969, 1267691556,
            3340881424, 992535572, 1421700486, 4136881179,
        ],
        &[
            342694080, 2041952014, 1126110022, 386493367, 2712278177, 1646877232, 868323005,
            1128141558, 2508964077, 2270408768, 413397861, 276293957, 2413870149, 3904853505,
            1276303079, 2556190902, 3967785388, 2803311564, 1963309088, 2281251697, 108392083,
            3821172642, 2048710986, 445614759, 2901896991, 3601903082, 1748962330, 658337341,
            3756770944, 2926642090, 7482898, 2241569433, 3381544088, 3275875595, 3036252835,
            2075586864, 1267727773, 221607050, 3946214050, 921175728, 655433083, 3594825352,
            1857831165, 3460211778, 2710641188, 1271591399, 263125866, 3619333728, 1041602820,
            3231202083, 259949419, 4156557841, 3419638674, 3270070813, 2084018311, 2951772182,
            860428573, 1138531819, 71044931, 3406637788, 3662652535, 3741808197, 86584983,
            1543795459, 160951322, 1039367499, 2428548772, 3604743617, 1138310711, 2881638514,
            2899388867, 3501166651, 161644747, 2395978477, 2682256494, 3417971200, 624066885,
            1772236754, 48275686, 3979745914, 2458268763, 2470110876, 3143857674, 3359279240,
            46246098, 2912257532, 2916568936,
        ],
        &[
            4267671814, 3181376526, 4204274026, 2772982826, 171341955, 3239339748, 83269891,
            2325049318, 746305994, 1290717192, 1805639230, 1856363646, 3445599715, 1388597950,
            2699498310, 246990054, 1396771726, 265087723, 3372840761, 3260397695, 2010115470,
            2211074582, 1883962263, 256363687, 4012920099, 2367091978, 1485341992, 1836339208,
            1434180757, 2616877872, 1145425491, 1261399773, 3926766027, 3115015865, 1741783714,
            3802513218, 4081750672, 3856503286, 2137512595, 1192985123, 1863041957, 700637154,
            2503934926, 2021744810, 157763047, 453501781, 1898727251, 3741166728, 105996483,
            3390681922, 1127471458, 4229032301, 254843851, 2729237155, 1707011850, 1756734415,
            1864969309, 96539023, 220456923, 3061776324, 1741151628, 1199010536, 2099212259,
            3095715999, 1369052975, 2575251120, 1821995904, 4169452262, 3299830336, 666854626,
            3647011057, 3965571435, 1551218489, 726151433, 1730753749, 750433250, 2084548637,
            475638490, 3209308986, 1536371286, 3458731894, 451976715, 1463077982, 2401462738,
        ],
        1,
        &[
            4074815036, 3472841870, 921256965, 4240552485, 4220791420, 3445360969, 1267691556,
            3340881424, 992535572, 1421700486, 4136881179,
        ],
        &[
            50882392, 3543059939, 2606418187, 171797978, 3702339267, 3400795540, 1675838746,
            3131956910, 3246773095, 2366066134, 1942572319, 200951604, 2751524401, 2229461380,
            953596498, 2149080321, 992246008, 2665146762, 3598754770, 101403369, 2364937647,
            3687287854, 3518388658, 3773344884, 2952272227, 2179289728, 3985568008, 2985468384,
            1733586261, 4006520661, 592636589, 1738983882, 3771432433, 334405279, 30528997,
            3353300809, 3694124666, 1257341879, 1142716002, 3178475445, 1431232435, 2733787829,
            2350134046, 162973337, 604966704, 1355497537, 2006066960, 1053669332, 2166548589,
            1297102232, 878976420, 1030095675, 3202690801, 955256572, 1487108550, 2945568597,
            3875785235, 1390419282, 1216776596, 786261001, 3784540042, 1845909951, 1777517834,
            12237310, 475982412, 3059699536, 4125207911, 2924612871, 3238196381, 2479221661,
            1483884124, 433754513, 447002430, 2684532044, 3494064078, 619277683, 2680056541,
            538552294, 1984267024, 700348592, 1278341418, 1614761367, 3944408375, 1269851701,
            1378535283, 1449179549, 515106198,
        ],
    );
    // qn > dn
    // qn != 1
    // 2 < qn < DC_DIV_QR_THRESHOLD
    // qn != dn first time
    // qh != 0 second time
    // cy != 0 second time
    test(
        &[
            3656551823, 3383257247, 550091805, 1932339117, 3279901067, 2864941409, 3440756420,
            466783416, 651341619, 2318022162, 1201487629, 3064175522, 2345469826, 3581748650,
            2606599593, 3742095121,
        ],
        &[
            3689695988, 3117118992, 1237207334, 1180101208, 2947083336, 2827697081, 221923985,
            2507264800, 619323315, 1516562901, 3186068769, 1013769776, 1271582351, 1669896397,
            2497959088, 3504047880, 4212568439, 1608150067, 4150555892, 374787916, 889323122,
            3833122938, 4262272989,
        ],
        &[
            3226059476, 722714803, 1915993039, 2160412527, 1484228011, 1715426198, 1611850737,
            3097214810,
        ],
        1,
        &[
            3948774568, 277233294, 951139522, 4214130560, 3551225641, 3386184722, 1565143611,
            2922369553, 2764255027, 5466750, 2823931470, 3552636955, 545484857, 803194457,
            1615608566, 3742095121,
        ],
        &[
            1074470868, 2174113464, 1715956530, 3963027838, 1871758691, 1809783936, 3173233408,
            1926929270, 2546329711, 2236304006, 2535063576, 3038921296, 3928703410, 2916570154,
            3615123448, 2107398179, 3674294182, 2421499571, 4129994368, 240790525, 49599891,
            2221272200, 1165058179,
        ],
    );
    // qn >= DC_DIV_QR_THRESHOLD first time
    test(
        &[
            2108009976, 2838126990, 827008974, 4157613011, 3782799311, 839921672, 879731301,
            1926496935, 3712149888, 2363043408, 3863476261, 1703718215, 499165670, 2993223230,
            4279694017, 2976095205, 2193242813, 3593708162, 586354096, 296757650, 242624274,
            199363552, 2802933005, 2759687879, 3925865458, 4217980786, 621040829, 4008464542,
            3795907109, 270168250, 3625538473, 759155103, 3959828159, 1835721901, 1818377089,
            114690984, 2967220963, 2377698568, 2241245638, 2252300906, 3116551983, 3644576818,
            2608501946, 2181270779, 1815210824, 1268283136, 484429506, 1180516809, 559610343,
            2543044915, 3719740023, 558939794, 3989231279, 1089033996, 3509826828, 3545449066,
            3353643945, 2822587915, 2300900020, 309191900, 2371088678, 1169317833, 2688462322,
            704882387, 1429447898, 2514029776, 1955158460, 3862686818, 1584130288, 482000750,
            4224830364, 2104097699, 1183456674, 2270729014, 2607655660, 2966545947, 2931252595,
            759652385, 3970839358, 2487392344, 1507124762, 758697388, 3840603988, 1293583672,
            252424514, 646352064, 1756992845, 2309291248, 3392597937, 2946557682, 3659552460,
            1720311830, 3395887210, 2674135679, 3196424053, 2895118562, 1256983146, 2482795730,
            1922474903, 2105232035, 3692384401, 2891711374, 3496171341, 515080177, 4073860792,
            2051799135, 2279442367, 3258846627, 70977295, 1937954703, 2800340027, 1760719187,
            646417623, 3158839049, 3176203007, 213391749, 869819866, 3906922929, 1586646665,
            1614123406, 3687984980, 1177302158, 272342927, 1441818617, 2083855650, 1541781406,
            3311904586, 106907162, 4108429222, 662974012, 4140594255, 1984524179, 3259771450,
            3863443649, 3307256449, 3597197635, 3771753969, 3551628070, 3550518548, 2546464879,
            3812123817, 2299164636, 2258249267, 815945886, 3725185601, 738801212, 3862546442,
            207778311, 1535617953, 2150997157, 729581295, 143725958, 1410055499, 4204574368,
            2185442793, 3653861199, 1767186378, 3537808267, 1766021033, 2239408696, 1986025224,
            3625288948, 4046347844, 2490523057, 3491861717, 1312039469, 597857291, 206880668,
            1812928615, 3684502664, 3820772609, 1327777451, 1237379465, 764273090, 3594853086,
            2859643842, 1243019386, 3444655918, 1596721727, 2221238575, 2483346164, 2064518283,
            2282844430, 1960424205, 4028198846, 2342293800, 1645322170, 3508868511, 2376856302,
            1764497492, 2461899059, 3430260828, 1083983032, 1448541077, 2081767380, 1131293272,
            2121152826, 4212689224, 2039367869, 2193844060, 1864700761, 1182989130, 1481869846,
            969270162, 3997775597, 1483663077, 394034269, 1586435653, 2281434261, 1937512315,
            836935557, 59742568, 1854699653, 2116629465, 328821302, 1999851100, 604863759,
            556389113, 2057620108, 1992554416, 427465103, 813735424, 487055225, 402647361,
            3006998394, 2146302389, 2308517156, 1063328348, 2382344201, 2665908320, 481118926,
            2376219143, 1164055989, 128362737, 2711666601, 1898018298, 2928344090, 3862251511,
            749517272, 2790599579, 3506539103, 2592038317, 1682088920, 1332639030, 3053921374,
            3066891587, 242466377, 3536065834, 2016487096, 1321862427, 2409873623, 3088797737,
            2840818323, 2052021858, 4079299898, 452968540, 3880575723, 2680668784, 1502544423,
            1619882634, 1068420458, 3236073318, 1740351058, 1183565882, 2761799103, 246817911,
            2967032269, 4003972840, 969974269, 3193561842, 1002645557, 2347161653, 4272895273,
            1522072178, 972383725, 3026624523, 434293193, 2855690795, 2455822196, 2413168892,
            2999634230, 784531194, 249556803, 2559695464, 3131798530, 668810109, 2114036394,
            2861740558, 370716909, 2126014070, 3913884200, 1577476936, 855642956, 2074597201,
            3461659621, 3292762038, 2153122643, 1658901071, 1562860969, 501980289, 1611843440,
            2433026108, 3791871978,
        ],
        &[
            2325147333, 1406197332, 1502532645, 137754493, 1488912421, 1014222449, 1678300831,
            2078887154, 2311629707, 3855402290, 1904906031, 1350026944, 314061674, 919972212,
            1429252796, 544807358, 2607111216, 3001219316, 160533550, 2875169678, 1402474615,
            3234840532, 1662112023, 1943050521, 4132256985, 2915369430, 699620367, 59590583,
            2461837586, 3986106860, 2659659366, 3589796255, 4168995860, 2337625655, 4292546333,
            1793085295, 2647770730, 2871508164, 2660729400, 3630964395, 3874212033, 1240042620,
            1713051992, 2105061240, 968807145, 3026819276, 2442427316, 2718248469, 2572140009,
            1793916894, 2112926236, 1058005225, 1528978151, 98430379, 3348888463, 2121431457,
            3545708238, 3975070402, 764453596, 192861224, 2698588322, 1493819664, 2502294971,
            3139295505, 1318649192, 1552623529, 2989328476, 1592829691, 1175278450, 182489613,
            1858350437, 2440903999, 1622786339, 162763913, 4106583944, 609833788, 1344925844,
            3910333895, 1369398307, 51929280, 2214052160, 78601532, 642016948, 3966440550,
            4161875340, 3764174238, 2944905670, 832634369, 2082700552, 3444794582, 962611192,
            38510846, 2733538376, 2141542785, 621670923, 3130866640, 1666281368, 3628581169,
            3965100367, 2889091703, 762371524, 3752935086, 656901001, 2374421435, 3084212494,
            1186140919, 3420046356, 775236355, 1337865306, 2051118555, 713071112, 1946850844,
            1427068060, 3949026319, 3075128554, 438166063, 3975561046, 858907746, 26964870,
            3843362808, 1461820702, 3090970200, 1037540471, 289966660, 2768763862, 50890120,
            580189324, 2911422550, 3684738914, 2025034397, 414622319, 2287243961, 3268939669,
            3547523099, 4011963324, 1768695320, 1859343614, 2123856143, 4141054481, 765801396,
            359993985, 3668605792, 3613648266, 1778728280, 2547397231, 2456061149, 2562918666,
            2903450513, 1994190773, 99234624, 3722083920, 4262323306, 202219441, 4201857695,
            3988878636, 1533308334, 401400520, 1069756554, 2457773969, 2892388936, 3423117995,
            1944069442, 492036629, 3426800580, 2282483359, 4006366620, 1695364515, 2555180845,
            1669287836, 349290429, 778467450, 2020203604, 2218159817, 1450404019, 1278304750,
            2412695340, 1592154884, 3868182043, 2240370481, 3859902860, 1008825116, 412233394,
            2475457637, 3664379433, 4204584226, 2750684469, 4113507475, 2916584959, 285955744,
            739598569, 18278051, 3768126932, 2181905109, 2612988076, 1827656088, 1160380415,
            4160443718, 1846086671, 3050604645, 2547108010, 2828666778, 3252702258, 3885923576,
            2331974758, 730724707, 1528859315, 4288784328, 3677151116, 445199233, 3304488688,
            3566979465, 3541025426, 2491779846, 3112990742, 2583249486, 3403111749, 1930721237,
            3428792463, 2896462048, 2985885576, 1819460734, 21206096, 3560441846, 987100555,
            2844904275, 84854892, 1268249628, 3963306788, 3338670067, 2504599089, 65588657,
            321493327, 4249673617, 4150876068, 721566898, 2186945060, 922948272, 1502464627,
            1426914435, 2906888275, 3454987739, 2609132626, 2073366782, 1058809001, 1226951003,
            2624503637, 282722778, 1407178266, 3304346308, 3613017687, 2397594777, 161128076,
            1938083248, 3042822216, 3958145306, 1431161184, 4147630074, 1744618540, 3729847703,
            2366216428, 2101731625, 2812677939, 3587016062, 1626785569, 3117017254, 3720581461,
            4254564252, 2400911475, 750362271, 3062375802, 2182368701, 268751862, 2682134876,
            274793576, 2417658182, 2321240923, 4200603818, 1349142841, 4066976957, 1043247680,
            679021323, 2933095037, 1621487581, 225868669, 1030678959, 1236344244, 972640788,
            1784301152, 578117349, 3509551550, 214420003, 3786992737, 802372148, 3562194086,
            2187046946, 3600373521, 4275090943, 2120016813, 4177241875, 3185774231, 2397692077,
            1015362399, 2178889151, 3433916223, 1688082118, 1971242178, 236388706, 3802829765,
            521309115, 2299816689, 3207614143, 1053195464, 3584561145, 1178690670, 2940812254,
            3321982035, 2754825123, 3073598062, 202404806, 547895545, 1188944547, 1056841779,
            529463805, 204665384, 850370055, 2063320161, 3724100092, 1180272690, 1398467003,
            2814052449, 1311768018, 659771105, 3226477227, 4230080238, 2134344405, 1461172705,
            2728018383, 1816821358, 3231137250, 2012377728, 2206916761, 3121807673, 3037967028,
            3653505029, 4164239058, 1337501466, 2487452346, 428839025, 3321493092, 2920064796,
            2750126813, 3635762100, 2659829309, 1992243088, 2359420187, 861816585, 4182313312,
            1389528266, 2890138969, 2195001695, 576635805, 1974585967, 851480113, 1896534852,
            3143828462, 4276040597, 3921135859, 2394233682, 2692972118, 2103941456, 3931376544,
            3790764632, 2278428793, 3381340311, 3516241824, 2923157557, 1276268033, 3471729699,
            2370137091, 2637023305, 4027814477, 3711009696, 3667995314, 459819000, 1002878772,
            2658190707, 1189561796, 1831813150, 2874008201,
        ],
        &[
            1703326352, 1625259628, 3642322228, 911402341, 2158835226, 939248485, 3607511108,
            2863853568, 1611642161, 1312857772, 1839433327, 567060478, 3139863681, 3642698184,
            3744632443, 712538472, 2692932947, 576185818, 156934113, 518107105, 2803035863,
            2284220097, 3447382922, 2400125006, 3565062840, 160044186, 3644393084, 4196433258,
            3391883838, 1115703759, 2380388002, 962895870, 4001772616, 2311278419, 2620271020,
            3047789793, 3229254302, 3182628087, 2718480927, 2872538422, 1963990826, 2856537226,
            1729736384, 372544200, 1482170753, 3370665422, 305555060, 4060802437, 1456459795,
            2848113958, 1036273297, 3245835346, 3355862097, 3242734427, 3313897419, 4230036415,
            1425594704, 2428756491, 420147714, 3218149930, 1791217142, 2881741659, 3231612869,
            845372829, 1635665046, 1525482197, 3779462557, 2279005731, 626908159, 2963734610,
            215448882, 2517668355, 3294128769, 1167990371, 2344651228, 2882002195, 3350056381,
            3749638142, 476010196, 2304276366, 1088082897, 1927672185, 3316329053, 1174989749,
            1101596429, 3054511229, 1685228241, 2301284206, 2526016461, 684171580, 3869889559,
            2606492401, 2114658735, 1419214215, 2779052449, 2594333668, 2225446358, 1211258458,
            4029343999, 2816277230, 4098142949, 1987363952, 2732004911, 2516355975, 2365350298,
            1747416524, 3951513077, 3526462790,
        ],
        0,
        &[
            1303670916, 3965736473, 654490008, 3337248200, 112312312, 2506678400, 713192736,
            901474194, 2359721047, 1133557120, 3068598661, 3136858413, 4095957211, 3057328754,
            1900588230, 1315930687, 3273808327, 2821746043, 4255148500, 3072995291, 1472014781,
            922081554, 1759317078, 149072645, 2712091402, 2134310281, 708105323, 3703209145,
            2071594694, 8111834, 3766831226, 2182956891, 2525476614, 1478202223, 4199311113,
            3813148212, 316780911, 1396844257, 2321402831, 1151134318, 848673799, 735789140,
            1092813310, 738412079, 1895091662, 2947844274, 31103395, 2559694049, 1194304023,
            3260126654, 1118043028, 1552558623, 3016599055, 1053142289, 446041643, 2615854004,
            2105823819, 3769707039, 2784177611, 9564629, 580911617, 1979035813, 1479556681,
            2599744262, 3097426153, 4195176293, 3497554127, 3484306250, 2114827319, 2314051712,
            1210812068, 4158781103, 478301760, 2027533091, 1682020897, 129914624, 2066167843,
            3989890251, 1378700448, 170057876, 3992582209, 1541347967, 3421610776, 697014638,
            2834243941, 3504973679, 630519426, 1551901326, 3092678418, 1136389639, 1806538485,
            2208151411, 1598302001, 4041410193, 3574334276, 2340664244, 1624426425, 1200740723,
            2912910258, 671197404, 2272603994, 909857936, 792804858, 3083891114, 3143045405,
            2389563439, 115312858, 1445242760, 2065820105, 256586994, 1432132569, 1549619424,
            2631865338, 1674212272, 2599765330, 3713129178, 1590556325, 3610491293, 709987753,
            3230113618, 1606099993, 3453954266, 3501213811, 3278809492, 3770342657, 1534951916,
            1366321311, 3149479124, 3987513652, 2108936446, 1162972378, 279205823, 3711325879,
            2278557694, 2305274058, 3709507652, 3805940202, 3778288085, 1061153771, 491180471,
            479623642, 2960728114, 553156023, 1863065855, 2253455830, 14222934, 2488687289,
            3378176628, 1136227234, 3805644784, 3175842224, 463501844, 2100687360, 2025076951,
            4064921772, 1000043802, 2482142143, 1463585061, 1044328896, 3966669663, 1023595412,
            2689537057, 685044345, 2599439954, 3302022962, 2669841238, 3358991646, 351579450,
            2303934592, 2098132645, 2239011851, 1623838039, 790570033, 2288992150, 2252675624,
            2479618080, 3624986625, 2129338944, 3796999988, 465518072, 620957443, 1836556967,
            2894771224, 2904933718, 287211723, 1386209013, 2288387719, 162551270, 370319691,
            2924564913, 2947669880, 3390862854, 1797811, 3097227838, 2245950593, 1664498395,
            3380635348, 3536484871, 1217287925, 3149066538, 154911037, 1960867817, 4238493382,
            1991791660, 509572665, 3386968719, 3880405816, 2335816696, 2519967410, 3482574698,
            1501302597, 2415671279, 715902305, 1920401004, 3735445496, 1792155851, 2110622431,
            3695395614, 3311496726, 4035668560, 187609524, 3743601469, 2990357125, 3084998227,
            767424914, 1388627321, 1381810466, 3799640235, 1423360242, 3375037167, 979951340,
            3463933333, 387599460, 229837304, 1394766077, 1068156038, 1135935924, 86516134,
            142150630, 448211640, 3205606056, 1420159909, 4203558153, 2816235778, 4188064475,
            1490981561, 2934083684, 2693435736, 1351552613, 962789901, 1071201732, 3244341475,
            1855681940, 4210620238, 2129345127, 2909949483, 3992748944, 3928807766, 2014533910,
            3099391001, 3112195816, 4009296318, 1247610431, 1474512546, 2530880557, 3597268331,
            764359883, 4198267775, 1228639730, 736768887, 396797847, 799410613, 582496441,
            2658423343, 1643853660, 1258585041, 3767032705, 3709454541, 892807168, 1443895160,
            3500326521, 784531194, 249556803, 2559695464, 3131798530, 668810109, 2114036394,
            2861740558, 370716909, 2126014070, 3913884200, 1577476936, 855642956, 2074597201,
            3461659621, 3292762038, 2153122643, 1658901071, 1562860969, 501980289, 1611843440,
            2433026108, 3791871978,
        ],
        &[
            1707334789, 979340170, 3926273349, 2029694660, 686358037, 1260123629, 689471236,
            4127009836, 1697317324, 3024229658, 3968952300, 2265029759, 733830093, 2234057965,
            799627406, 1641742523, 2511563041, 678204198, 60484965, 1732955108, 1348641815,
            1389334445, 3762643904, 3914179461, 4076462931, 3234877741, 2806715190, 3058911852,
            3068848122, 80861952, 660210165, 2035863667, 3882844515, 2652987274, 207029959,
            4170201248, 1224653886, 3554890284, 323203565, 969583090, 2280910221, 2548241625,
            2048045350, 3691775573, 3750377304, 2623340073, 1726676400, 2551234664, 3420452119,
            1785849707, 3581615935, 3521097022, 4008380099, 4200557552, 3795120169, 488463511,
            3784467967, 2462685342, 1684084055, 1072125823, 765304928, 2900468163, 3209242917,
            399160769, 3897765190, 3241572534, 1027203705, 4127226109, 154941175, 1755153596,
            4225252328, 1209101989, 2906888698, 1481930532, 2884731435, 2416462752, 553651049,
            2247421040, 3347507436, 1936621186, 3156059073, 4059864280, 3191940359, 3872902453,
            783002816, 3711047515, 1471051688, 357992570, 1061754510, 3765779801, 4106840335,
            3213049794, 1824410844, 2555550067, 1066295382, 3248869963, 4006861446, 3297772017,
            3418388327, 2284151457, 766215224, 1091253635, 2070830666, 1435103841, 1408352671,
            338399542, 2946293497, 412804347, 3352476767, 1191730627, 1410260029, 2471070815,
            633945109, 3340227506, 3566364850, 3028746, 2628679931, 678745148, 2734365382,
            1537708542, 4061335259, 2093460149, 511093922, 2816244182, 3205167820, 1361791447,
            2576542802, 469800674, 987047791, 3796722635, 2053630437, 1814971117, 4121688214,
            2704575916, 581403047, 3621053217, 2548847264, 2410522785, 851972689, 3529748993,
            1520815168, 3472702310, 1202631522, 1219224397, 2460751008, 321870538, 4224759915,
            1874359575, 1247275984, 892950916, 830843824, 2764594491, 2803871713, 2559609369,
            3910488627, 1450672030, 2220952314, 4137130206, 1891942328, 1996012238, 3926053551,
            864702066, 2998324779, 1834770578, 3093025304, 3955038152, 380064273, 3982433450,
            1174603042, 796230262, 2415142934, 4198487299, 1045945386, 1238100947, 1351107109,
            3204903633, 927338411, 3055083170, 561509518, 4038896674, 2038194811, 3718021361,
            4100445162, 855726940, 2783433890, 1695906793, 2891668731, 2043379570, 3278183890,
            3381671923, 2808633031, 3802537556, 910470983, 4085168178, 1798677697, 2752231576,
            713026109, 2268053634, 531502484, 206600354, 1212856709, 3504657813, 3971613100,
            1504589358, 1828792417, 3696199164, 1475244552, 382913034, 1920592084, 601140403,
            386785313, 2182162734, 2113260465, 2155740972, 3023673185, 1186643451, 3023538768,
            2328488575, 2097182081, 2248427080, 744522785, 3748761423, 2625648742, 4189092696,
            3124937010, 340599313, 3999863550, 2701036470, 3863081663, 3307679309, 2686698329,
            3980125764, 2814237932, 953619375, 3612320240, 163518608, 4239469017, 1335290688,
            3540855274, 4208285255, 3447470455, 659642463, 1892788147, 2132754986, 2075328786,
            1635737917, 2479115387, 190014532, 3745629792, 3195156609, 193561885, 350235262,
            4116396076, 3358167240, 3503568551, 2466932773, 2407497682, 4096447539, 1808393184,
            3471563733, 1503178420, 2795804843, 2814507311, 420733558, 2515016466, 1515441838,
            3174627796, 518303307, 362553547, 2208294430, 2862458476, 3437785699, 4121475273,
            2195346824, 4061473174, 1331095662, 3814000418, 2103888279, 260961575, 2745607904,
            1885202241, 2206416902, 1976074207, 3736904218, 1788164961, 811805304, 188646685,
            1552113725, 1985859257, 3025555278, 2758979792, 1175229106, 2793122577, 1017775702,
            1534410966, 3448550574, 304057870, 1769327112, 3190059484, 3485962461, 1121821414,
            3738680857, 2992331345, 1932259545, 2840319239, 3414794280, 1729059330, 420366862,
            539082956, 3047532402, 1842821425, 3263993740, 1281695221, 4194535710, 2261273029,
            1837284032, 638869193, 1330501295, 3665208885, 3391397188, 2913991065, 2108031513,
            3614880612, 1471482898, 3976920844, 720292363, 140271647, 1105423876, 2164570826,
            513830077, 999429594, 1852418445, 2188359082, 117089769, 4113854779, 4115783053,
            3262291412, 3649717848, 1567759965, 858734608, 3548181760, 902779234, 2137738148,
            2742285538, 1553844331, 4222906971, 1834891484, 968151793, 3883914886, 4254072751,
            1490076511, 3139100605, 3654190247, 813482145, 1561655237, 2211495513, 3198280134,
            550262169, 2786141227, 3424819958, 1408218448, 839484799, 2790469526, 3748672896,
            2085089428, 3310408106, 3715348700, 2646026429, 597045725, 2056298402, 754537401,
            2609729995, 4257271030, 3490591818, 2575288845, 2476705576, 3702642666, 1838684287,
            262552550, 1303188238, 1549513541, 352996202, 3051669142, 3784056161, 3316230498,
            2090640559, 3458945226, 1831813150, 2874008201,
        ],
    );
    // qn >= DC_DIV_QR_THRESHOLD second time
    test(
        &[
            3333140561, 2349469031, 666934289, 3646788197, 3373340607, 3062489357, 1781577064,
            3971231072, 2027939726, 18149756, 461121573, 1026270057, 4154481498, 3854995191,
            2829169318, 2604923553, 1399568275, 4214150257, 1269657447, 527209086, 559827800,
            1978807620, 1942748659, 3544969161, 760896836, 694370989, 3323597771, 1950755821,
            1740588707, 2716546795, 1636681281, 131422512, 2683077565, 4107286368, 3475458482,
            1406752921, 2741526831, 625075474, 1356017187, 660778033, 4078598031, 2127023485,
            1900179860, 2413773277, 2442990944, 850894581, 1061627184, 2255197913, 490496693,
            400007380, 3092474488, 1228905086, 1949288324, 1866222251, 4084867584, 219026194,
            1513678816, 2415719293, 671740632, 2331463444, 1649508273, 622524186, 36198287,
            385821590, 3891184984, 3888867762, 823766845, 871168771, 4220135146, 3182319759,
            3811051122, 2244319794, 1994956782, 3515960993, 3523512148, 4142104035, 11404747,
            3407068856, 2661473296, 1343912700, 1278923149, 1319603671, 3928437020, 2678906106,
            1133029551, 3498992572, 3960506675, 2156562886, 2180928089, 4027866586, 3363079195,
            2699625088, 10633112, 1776348429, 2657266039, 366882369, 3755249663, 1513004482,
            385462618, 1235118123, 2498536948, 2963795538, 373052379, 4211662453, 1125414031,
            3132282357, 2555861787, 3949045845, 2694335672, 335933961, 2882374566, 3487775198,
            1816750435, 3017829161, 964613564, 159555703, 1822850997, 2275865751, 4158541302,
            2501990511, 3721844651, 2781838144, 1795741626, 377630941, 2137086277, 150771080,
            3410699853, 2181744662, 3165518125, 156617039, 3099687100, 2159351188, 340108091,
            2408725718, 1639869303, 1752843886, 1941447467, 2157946488, 1515895552, 3624132653,
            3556726921, 2697391196, 3650363912, 2596921683, 3641623430, 3884964637, 4229700714,
            1936259996, 3765315225, 4087511128, 746291101, 1752759843, 699518598, 2102672534,
            2335948897, 4138231225, 3162828440, 2881768368, 1254885146, 2977691172, 2250072411,
            2614007259, 2771551612, 776074685, 3162839614, 1471012556, 523323297, 1856466918,
            4090405884, 813410161, 100155385, 1084252628, 1599609446, 139407955, 4121369443,
            1963225032, 2735275753, 100107317, 1064061529, 50786861, 1654370440, 3334472166,
            1385803654, 3881645932, 3538258401, 1238925138, 1307191791, 2439918414, 1853442725,
            3584719283, 2139830944, 1008033673, 2159214266, 1728151904, 2054140804, 2246372905,
            1296034828, 732486414, 4197166746, 2149038695, 2421556216, 2209917678, 2053724924,
            3695308867, 2810551805, 3486105675, 979515789, 2065617241, 3321246575, 4275036932,
            3028497318, 1883398852, 1301060583, 2486427309, 592113155, 2482121819, 53211642,
            3067158128, 2316354328, 2457370797, 1766767168, 4130364650, 1394191393, 893956183,
            3188688185, 1875859783, 3686866863, 3294062742, 2146834313, 2406586432, 1574602180,
            3208002016, 1067708846, 1620126309, 593911816, 1573785767, 2208656217, 4037191927,
            3437397556, 425721135, 3749387007, 407468749, 4203518167, 557223936, 3186718435,
            3473504989, 2673679280, 1478635903, 4172750097, 1469776418, 2542136327, 941914936,
            3438581078, 3116581940, 3479694655, 159558945, 3809792710, 2458053073, 945749848,
            3386290936, 950397544, 148027778, 275178526, 1664599931, 2000347485, 3312866545,
            4123761723, 2408292910, 4050298, 4225958969, 2745635153, 1877283873, 90573827,
            3031684040, 2275034810, 476532317, 4006527249, 2818283214, 661127690, 2880950746,
            3285389422, 965419004, 1273458580, 1611437669, 4165036259, 503131762, 337440890,
            1274837150, 3486913543, 1110808141, 3573281492, 3543428578, 4165550725, 79661970,
            1465954224, 4160343768, 3753977684, 849800837, 1568284940, 1214508489, 777072754,
            3766232553, 4163385462, 3428999259, 906027128, 4231567110, 1070253805, 2975789822,
            1794042990, 2937404746, 3315145973, 3978541255, 191961431, 2940436214, 614874984,
            868388988, 4078685796, 2613877234, 3380127687, 2664922311, 3262235038, 741871774,
            1144269180, 4258950699, 3668553647, 3162392321, 927199539, 557637561, 1114912670,
            84346866, 4241634616, 592125931, 1914166161, 1225886409, 722682712, 2163011354,
            2585075265, 2786722853, 1993844439, 3433052694, 3718814733, 3881165856, 1749980152,
            2115861966, 3664836486, 1644814678, 603487648, 821270634, 3041437740, 925329308,
            414275079, 3675481275, 583965775, 3319812843, 270816609, 1752806861, 3191564196,
            3197116565, 2440000620, 4074382088, 3346183865, 176525856, 3011091744, 746158938,
            1522027948, 930706422, 2574400675, 4141639266, 758742087, 1418306156, 493509688,
            4102390641, 3757183059, 2174506350, 3715933078, 3450125642, 1345548124, 3845070193,
            1563795423, 1304049315, 2604880108, 1998271877, 4078353958, 966179722, 3401781407,
            1708183977, 3890171386, 698646214, 604975097, 4189977050, 1847675543, 2745048720,
            1585177380, 3886892753, 2534712423, 1830125662, 796996186, 3789574770, 2219095884,
            38427113, 3653683439, 1791769536, 3941686320, 2991883118, 1081207663, 3863639548,
            3017351034, 741393256, 2333573607, 2783158305, 2015776314, 3034707152, 1871224010,
            1795881414, 928539629, 3211747317, 461147496, 1512738445, 1178891684, 2603472964,
            1694950214, 3121022285, 91788635, 2303571910, 3259041724, 1240577113, 827064078,
            3847765430, 1254285617, 2609289648, 82835530, 2235563901, 2939680484, 3327268666,
            3659752183, 1783109461, 2828509671, 3804296197, 406800911, 2037292519, 941994402,
            3350211940, 4004870359, 1105941782, 2367553097, 2440982990, 1468367, 2369391483,
            3613174135, 2337161925, 2600055725, 1612773644, 1037201309, 919122459, 1114016493,
            670586694, 594109706, 113464329, 4093636009, 307208587, 3876235186, 3370598978,
            934478190, 2843794891,
        ],
        &[
            2368917411, 3160758175, 1531480588, 2746326450, 3122359045, 1995296172, 310451197,
            1100329853, 2141732304, 3562890277, 4172526924, 4143185198, 2397101926, 620168044,
            828452963, 3271569899, 2726758945, 1647557222, 2748652901, 1029871186, 1773072595,
            1311795717, 2792240418, 3100733307, 298902661, 2608361440, 642743765, 3026335712,
            1586592828, 1251923561, 2152803283, 3359308047, 3979690761, 2548031009, 2148504694,
            2514911217, 401310800, 1418125404, 2325652800, 716233458, 422262103, 376190943,
            1713380879, 2534508846, 2080413009, 2690193951, 2909422387, 2435837201, 176977642,
            224472737, 1590904934, 1664979624, 1748982641, 1284257790, 2779881254, 385265989,
            1148527382, 800142050, 3595556318, 3950265146, 3931111523, 3399894595, 4200004994,
            3727110364, 1510525540, 429323681, 2586345405, 3441619670, 94654169, 2266545045,
            1451808026, 286040435, 364003484, 2106693078, 1916214330, 2622096560, 3504008387,
            1867458297, 4209615436, 2899684845, 3149003214, 2731979274, 2481557740, 234269740,
            1239420776, 2726912636, 1844267393, 1488044058, 1587005400, 145015793, 1637696129,
            1990069464, 3053970062, 676336554, 625771493, 1492378707, 1231018082, 3059699722,
            4113615249, 2967103567, 3335726303, 2137774253, 273460502, 1561489611, 1227429414,
            778315897, 3061631993, 2437789514, 2566029814, 3017507824, 3219754602, 35255136,
            1934306764, 1655248959, 3655963814, 2821596564, 1431977748, 3114012833, 3915822059,
            343010167, 3704265251, 2691314567, 2602475242, 2459094882, 58857240, 2230690665,
            1357656795, 3025543277, 3488674640, 408985076, 80729036, 246851391, 1419653386,
            530010128, 3529087076, 3980421141, 4129023783, 1630771696, 2057278583, 2501545742,
            790764428, 3984347668, 2562445985, 2262348292, 2515967925, 1103371818, 3735595401,
            3210477145, 3387257181, 538884374, 2695206119, 4211749041, 1006274735, 2406061865,
            2654644297, 1268724640, 2399689302, 157759259, 564853502, 865205768, 2174783618,
            3167863384, 1770172407, 1906775255, 3171669377, 2455086709, 1355327864, 3351895167,
            4184858376, 2699533565, 2939169294, 1702277740, 3447680482, 3322351998, 4248517760,
            4100425921, 1169799041, 524849931, 1743345401, 3987645088, 3022177240, 3263737545,
            3656340460, 239445170, 4089162190, 1208712978, 1453215235, 3390225374, 3337889603,
            717395279, 1066458381, 2162685522, 4009460245, 2575879990, 2578471337, 4218103221,
            3046325563, 1352991515, 1561949281, 3488911174, 295633326, 1993756395, 3677304657,
            796898320, 45622345, 2999482773, 2078651788, 1552765091, 428170722, 1748054862,
            4158222865, 1050292437, 249107, 2651086861, 1540178674, 1275557298, 651050585,
            1895599156, 4150309716, 2064336046, 1021257319, 2422595446, 3116755258, 2756656575,
            2328011578, 3632905157, 2576200202, 830418644, 2430246370, 3913080080, 2371749061,
            2683067461, 3611558701, 1603392737, 796477803, 604567756, 1376069347, 1491246154,
            2728262664, 4138498935, 3008562381, 1061547384, 285679033, 2358943172, 1884649492,
            1783482693, 1010268161, 176114433, 794165875, 2362278477, 3903204233, 326754905,
            1988607850, 3187254334, 1749797209, 2986661384, 1759716588, 3137467938, 4067743599,
            1134210801, 3799848836, 1955405545, 3881788427, 3097574490, 3844756657, 3183850151,
            2496328910, 1468671385, 2888878911, 2306353811, 1498824361, 4152891378, 1588217107,
            79108222, 2883552792, 2390312777, 1587172303, 2070384343, 2265280181, 4013380367,
            2742676878, 2654283484, 1471778694, 970959698, 1006151052, 1276307400, 2874101774,
            3169092608, 244587925, 2402787407, 1635687252, 835856534, 321407542, 2307278464,
            2272745321, 2574317642, 729437319, 1682288870, 1482920833, 776000268, 3908963888,
            214874919, 4233311318, 1441385448, 2358127573, 2753681514, 467574656, 4139948165,
            1538275035, 3244920878, 2576965792, 584068468, 3054546876, 2629688518, 4253271747,
            3723872815, 1652066683, 990821089, 2335421805, 1989570928, 240486517, 2872315587,
            3869991906, 3870517664, 1540804424, 397183643, 3750033565, 1433260634, 1506168711,
            3616651625, 512028445, 3746712828, 3278592880, 2611514549, 1214563129, 1259227909,
            1067976218, 3425169051, 741795595, 893688343, 2674408703, 3694908868, 2478153735,
            2220661625, 1022546736, 3719214155, 3161293211, 4131981986, 1473264088, 1651777063,
            1438502715, 290022167, 59234682, 3458968160, 2552001459, 3451530289, 3800073253,
            717882913, 845719525, 1038699111, 3058303772, 1117505279, 3682430977, 2869037104,
            2562493618, 960519305, 4147639705, 1817463351, 3166022129, 3200769866, 789666262,
            2654485924, 3686362402, 2179867687, 3980226915, 3671542918, 1896992204, 1514962591,
            815867715, 3924270086, 4262628477, 3977258034,
        ],
        &[
            491933121, 4095154087, 1190388341, 2123387578, 3299683037, 3840239224, 3891252433,
            3823858915, 548023871, 3189021809, 130119335, 1406023029, 1691542279, 2101470388,
            367145009, 521045073, 1370995123, 202251222, 2377400220, 3656022509, 2413445446,
            3583191945, 150872893, 1253881977, 3664619565, 661519973, 672952411, 1111416155,
            2582282747, 2253466637, 3993637585, 1023965093, 4055175549, 1721196160, 4271105372,
            1844335262, 794907961, 3970777280, 1279126024, 3389187110, 6388771, 3557792034,
            2503975364, 1216157736, 4081863507, 1212796362, 22717034, 3517296783, 3126258972,
            454147562, 4182968994, 685295412, 2996150679, 840677609, 2775806132, 2555856748,
            2855553012, 2971949846, 3057579317, 954558068, 1251032539, 2673204563, 697957636,
            1312479140, 2686740988, 2005131101, 664387193, 2169938189, 4081160067, 3469684725,
            123152292, 2899902365, 1142266692, 2066860665, 647803613, 3574778631, 1302596512,
            678200322, 3509569151, 849744577, 1521760114, 3195673981, 111241164, 623461570,
            3571445453, 200189218, 4138515602, 665845464, 4184871542, 1353865395, 2913489035,
            3076207781, 2549062531, 3446687793, 685940105, 1430268106, 2488363196, 1172253595,
            4151501269, 3292280286, 2025935004, 3388911026, 1080796771, 3386986959, 4175562557,
            2440556214, 9871988, 5488492, 4179517076, 908443542, 364965294, 2303037125, 369102673,
            1570100894, 3615415741, 3133015360, 2623933135, 211314818, 3377760249, 2285528104,
            3096807957, 3213907502, 3633343924, 2065769028, 300167487, 1745300631, 1943126607,
            1065862406, 2422304458, 523765517, 57630113, 520436682, 581485167, 527613705,
            1677813796, 2698743484, 2448718551, 1681977324, 4183961145, 333724319, 2667028740,
            3403027352, 1499647517, 2965583197, 1090547876, 1536215624, 3407325498, 1392474450,
            3354142052, 3326326224, 1138672330, 1577104875, 235932133, 3877789753, 1822119722,
            305251772, 3802044423, 608489509, 2727503310, 865373313, 3763994776, 3206318655,
            88097048, 4241064408, 1171067683, 4250936686, 729121178, 763857558, 450636528,
            2096197907, 1427186250, 1251064262, 3036762405, 2966424923, 880639864, 1995310474,
            2023015792, 4198637421, 3996151657, 3070092174, 331733799, 2680348059, 2601390369,
            92920881, 600583651, 1323663334, 4258529164, 2493258032, 3313489774, 2050494797,
            1494880112, 1342788885, 2493538385, 1096813856, 27701253, 2762164402, 3934044073,
            2289089808, 721323988, 2246162231, 2514451824, 3095057964, 1921436785, 2847276160,
            1369952734, 4246781184, 3442030977, 3930627222, 614706399, 3051396564, 3044240928,
            3450585985, 2120836933, 3006035710, 178202067, 736149219, 623937260, 1958379885,
            3104814268, 3269365015, 914726129, 2951180538, 3940965189, 1869582492, 2599100173,
            1009213592, 1410445689, 1179880005, 3583285938, 1921636631, 434725812, 735782942,
            2548761027, 3733379485, 3466163816, 2455801926, 1673952134, 2422059957, 4005305357,
            2795894062, 3245947918, 4171997564, 2269244989, 1975479474, 2449387935, 2550893401,
            4033149, 3723976428, 3871853952, 3210178057, 2062131312, 1434821634, 1130065536,
            4276609753, 41976415, 968125282, 853099726, 3675357389, 3545982836, 1237895428,
            88970686, 4259275077,
        ],
        0,
        &[
            2046945960, 1873732058, 883136475, 2335087597, 1091742925, 3913267466, 1586245016,
            4163559950, 1402352044, 2528046476, 1941819469, 2309605638, 3377063311, 3151818591,
            494038776, 3426549387, 3253079763, 124752778, 4008075289, 327167526, 1965527166,
            717131100, 1676230023, 3836503956, 3686584911, 550652113, 589790309, 2877365586,
            2824639624, 3138038419, 3640799592, 585603054, 1414821912, 3869326513, 3124646127,
            813686461, 180141293, 2274287537, 3375883484, 3539423998, 2876480809, 1880629606,
            2803556469, 687655801, 393062928, 524210967, 2366097978, 2175763640, 3159336997,
            790281459, 3247341866, 170318031, 1506555227, 246985421, 2165448534, 4166633223,
            3351234404, 3976060563, 3925058943, 398933467, 3413453047, 3215824401, 2764818555,
            2281679666, 2124899687, 3988046369, 3496024103, 1898489528, 3748055383, 1888289090,
            3518616015, 2878886670, 1858863206, 1865431124, 2320246513, 1797214962, 3620561150,
            3636061735, 1288494915, 1503932934, 333549760, 2000535203, 2963961099, 151292676,
            4071971672, 2869808036, 801933070, 1423471894, 477371428, 3645363638, 2586777443,
            3381283382, 3165264014, 1496932333, 2011004150, 558029532, 1103521912, 3099006002,
            2922027532, 2250375874, 869652089, 386060205, 514086971, 679438817, 2922028193,
            3519808732, 1083788073, 2102488620, 2723526073, 3287730376, 3961054192, 1086172650,
            3775096139, 3273358074, 3471776285, 4280446341, 1945339479, 3318103287, 2895065752,
            4010586984, 3721844651, 2781838144, 1795741626, 377630941, 2137086277, 150771080,
            3410699853, 2181744662, 3165518125, 156617039, 3099687100, 2159351188, 340108091,
            2408725718, 1639869303, 1752843886, 1941447467, 2157946488, 1515895552, 3624132653,
            3556726921, 2697391196, 3650363912, 2596921683, 3641623430, 3884964637, 4229700714,
            1936259996, 3765315225, 4087511128, 746291101, 1752759843, 699518598, 2102672534,
            2335948897, 4138231225, 3162828440, 2881768368, 1254885146, 2977691172, 2250072411,
            2614007259, 2771551612, 776074685, 3162839614, 1471012556, 523323297, 1856466918,
            4090405884, 813410161, 100155385, 1084252628, 1599609446, 139407955, 4121369443,
            1963225032, 2735275753, 100107317, 1064061529, 50786861, 1654370440, 3334472166,
            1385803654, 3881645932, 3538258401, 1238925138, 1307191791, 2439918414, 1853442725,
            3584719283, 2139830944, 1008033673, 2159214266, 1728151904, 2054140804, 2246372905,
            1296034828, 732486414, 4197166746, 2149038695, 2421556216, 2209917678, 2053724924,
            3695308867, 2810551805, 3486105675, 979515789, 2065617241, 3321246575, 4275036932,
            3028497318, 1883398852, 1301060583, 2486427309, 592113155, 2482121819, 53211642,
            3067158128, 2316354328, 2457370797, 1766767168, 4130364650, 1394191393, 893956183,
            3188688185, 1875859783, 3686866863, 3294062742, 2146834313, 2406586432, 1574602180,
            3208002016, 1067708846, 1620126309, 593911816, 1573785767, 2208656217, 4037191927,
            3437397556, 425721135, 3749387007, 407468749, 4203518167, 557223936, 3186718435,
            3473504989, 2673679280, 1478635903, 4172750097, 1469776418, 2542136327, 941914936,
            3438581078, 3116581940, 3479694655, 159558945, 3809792710, 2458053073, 945749848,
            3386290936, 950397544, 148027778, 275178526, 1664599931, 2000347485, 3312866545,
            4123761723, 2408292910, 4050298, 4225958969, 2745635153, 1877283873, 90573827,
            3031684040, 2275034810, 476532317, 4006527249, 2818283214, 661127690, 2880950746,
            3285389422, 965419004, 1273458580, 1611437669, 4165036259, 503131762, 337440890,
            1274837150, 3486913543, 1110808141, 3573281492, 3543428578, 4165550725, 79661970,
            1465954224, 4160343768, 3753977684, 849800837, 1568284940, 1214508489, 777072754,
            3766232553, 4163385462, 3428999259, 906027128, 4231567110, 1070253805, 2975789822,
            1794042990, 2937404746, 3315145973, 3978541255, 191961431, 2940436214, 614874984,
            868388988, 4078685796, 2613877234, 3380127687, 2664922311, 3262235038, 741871774,
            1144269180, 4258950699, 3668553647, 3162392321, 927199539, 557637561, 1114912670,
            84346866, 4241634616, 592125931, 1914166161, 1225886409, 722682712, 2163011354,
            2585075265, 2786722853, 1993844439, 3433052694, 3718814733, 3881165856, 1749980152,
            2115861966, 3664836486, 1644814678, 603487648, 821270634, 3041437740, 925329308,
            414275079, 3675481275, 583965775, 3319812843, 270816609, 1752806861, 3191564196,
            3197116565, 2440000620, 4074382088, 3346183865, 176525856, 3011091744, 746158938,
            1522027948, 930706422, 2574400675, 4141639266, 758742087, 1418306156, 493509688,
            4102390641, 3757183059, 2174506350, 3715933078, 3450125642, 1345548124, 3845070193,
            1563795423, 1304049315, 2604880108, 1998271877, 4078353958, 966179722, 3401781407,
            1708183977, 3890171386, 698646214, 604975097, 4189977050, 1847675543, 2745048720,
            1585177380, 3886892753, 2534712423, 1830125662, 796996186, 3789574770, 2219095884,
            38427113, 3653683439, 1791769536, 3941686320, 2991883118, 1081207663, 3863639548,
            3017351034, 741393256, 2333573607, 2783158305, 2015776314, 3034707152, 1871224010,
            1795881414, 928539629, 3211747317, 461147496, 1512738445, 1178891684, 2603472964,
            1694950214, 3121022285, 91788635, 2303571910, 3259041724, 1240577113, 827064078,
            3847765430, 1254285617, 2609289648, 82835530, 2235563901, 2939680484, 3327268666,
            3659752183, 1783109461, 2828509671, 3804296197, 406800911, 2037292519, 941994402,
            3350211940, 4004870359, 1105941782, 2367553097, 2440982990, 1468367, 2369391483,
            3613174135, 2337161925, 2600055725, 1612773644, 1037201309, 919122459, 1114016493,
            670586694, 594109706, 113464329, 4093636009, 307208587, 3876235186, 3370598978,
            934478190, 2843794891,
        ],
        &[
            3428605691, 3747865452, 3179948115, 2350061225, 568002466, 1150456745, 398797276,
            1289784855, 1713342581, 1243415582, 2262476431, 2640854581, 2126611553, 279688048,
            1750838292, 4147801215, 1090003542, 3022523567, 193306367, 3095010320, 4106129220,
            2615828356, 2229875117, 1066352114, 1628397898, 370050060, 4157038478, 3551524420,
            3356007005, 71309641, 801692593, 3448737794, 2187893878, 3694205688, 3993669226,
            1704384353, 437976508, 281233142, 3685881986, 557022935, 2623696682, 3473835466,
            2373703925, 4102552649, 3005124737, 1604665678, 2894612216, 113726438, 326916434,
            2354584210, 2207672568, 1272863868, 1643657755, 453968751, 3873638645, 2388412558,
            2026577065, 3555348237, 2342844423, 564662317, 3301275728, 2205414701, 1980322846,
            2111846734, 3351655044, 3986317737, 3746472405, 4065813457, 3783710419, 2063617629,
            3337397526, 396000532, 1367889075, 3493608147, 3502046919, 4063752078, 2026966957,
            1730343114, 1889308216, 2064908820, 1350757250, 953211432, 3171180512, 3683852864,
            2865517189, 9728788, 4075807873, 230559850, 3447666295, 3875782338, 2964025959,
            3279832060, 1701408562, 1524777719, 2018628821, 877683542, 2894422993, 2842238026,
            2368190181, 2574790540, 3301078931, 519264490, 2640226714, 1382986517, 2712031077,
            1268830384, 2018243821, 1374899410, 1932087493, 4236194373, 2079152365, 1069353434,
            2794047491, 3019576051, 1360117274, 3615353679, 3816194597, 563906666, 1827758233,
            3391740972, 4039283822, 474920421, 602146150, 3520459365, 2217822485, 1815675107,
            1257332805, 101198736, 3156910259, 1281759597, 2577040428, 1316988841, 790502779,
            2183328888, 3514409721, 3117638288, 2751392867, 625199304, 4183171081, 810287943,
            199775540, 2896399552, 1276626819, 3536203521, 3977249862, 1553852925, 1596788767,
            4199876212, 4164476281, 1700598937, 4111801568, 897035781, 3318378574, 4049506305,
            2522517679, 2296942227, 91515126, 2738354614, 3444113221, 776723413, 2322159108,
            258188842, 4014626824, 2677530556, 2630906411, 2348643583, 2619411399, 1783064149,
            3684137491, 4249816060, 2342260236, 4186117248, 3931377058, 283592002, 2818946531,
            2155019855, 1212182985, 937681548, 520081464, 1686760025, 4003314294, 120323668,
            3282730481, 1331500167, 2103184161, 453960707, 3079516933, 4193898972, 279508919,
            2459211929, 4262295127, 1413249938, 2652447340, 1521334653, 3641279725, 1047788888,
            2569690437, 3517124875, 527659101, 950373677, 562851515, 3518587604, 2668894245,
            2265163836, 2975852422, 3168107907, 3219343979, 3364338005, 4122186542, 3517854206,
            626303838, 201513242, 4042863292, 4203206994, 154681851, 1046188872, 1014035958,
            1565481708, 783475007, 1419399714, 1439418252, 3671223860, 338436030, 2221870804,
            275182251, 790279697, 3288665213, 3033639795, 2320556485, 1648356934, 326278183,
            429784181, 104482651, 1051376296, 3823684587, 3057907898, 4214146560, 2770254088,
            2132180852, 515232230, 3723417512, 3994583184, 1170935740, 565152109, 1486190861,
            2906472005, 3154973145, 1571950735, 1391459913, 2972445791, 1670706254, 2522911431,
            2665886703, 2875123532, 623767904, 1291947264, 3935970871, 2500309617, 3931020115,
            3436644927, 3672390796, 2307254280, 132847625, 1396660216, 1882031856, 1215617252,
            1516033454, 1908131668, 1179603288, 2834808948, 2216658640, 1107130115, 4022997841,
            405236702, 2340581208, 3369422607, 1684481738, 2918953490, 4020308663, 630917242,
            2171888262, 183478499, 1025570471, 2117873694, 3681835640, 4072198696, 1542141957,
            3188240052, 3770755972, 3980699263, 4234475770, 3111960559, 2403123554, 898236851,
            1695254682, 1798938559, 254996776, 1681480336, 2179473547, 3154483791, 2957521458,
            1160814542, 3982226725, 3537217630, 1328770132, 4212178226, 3990167806, 2468854434,
            2020342544, 2112591539, 1311954661, 1655223001, 2753064698, 158617724, 2792758181,
            49406446, 3285834199, 4291188898, 97471734, 4242543552, 543731395, 395618234,
            3274813617, 2508742427, 3096673672, 968972992, 3381418305, 2035770549, 3395716836,
            4221557797, 4124686966, 3118185548, 4198649981, 4235433636, 3266375803, 2874663792,
            3020623948, 3994106450, 3150472819, 3736185780, 796171701, 70496148, 3322724883,
            2177410906, 3804523447, 3122555851, 3237553883, 2266895400, 3490163904, 369889875,
            4036519090, 3615069782, 1484935733, 3533599655, 1328843603, 2387417641, 3575986205,
            2733672372, 1855679501, 3709324174, 3669206159, 3982832066, 1493638635, 3381886314,
            3903763897, 3487111209, 847860368, 1306988198, 1487785258, 3686778516, 2262529694,
            2522696854, 4267014667, 2407394698, 351681724, 2371866853, 2049033803, 2260580432,
            415673865, 3605057547, 4262628477, 3977258034,
        ],
    );
    // qn == 1
    // !(n2 == d1 && n1 == d0)
    // dn > 2
    test(
        &[
            386353625, 2283334827, 253851108, 4279287864, 2561872983, 1000131216, 216965099,
            1733322743, 3814906874, 520558483, 2573981410, 3011109093, 1361665859, 2981910167,
            2501833654, 2673979284, 2696912361, 797890797, 97183495, 2324611911, 3471887001,
            1013155374, 524729310, 3971281568, 2873934524, 1076401482, 1645093822, 423739674,
            3400177353, 3716049850, 2858905860, 3351077705, 1478568656, 3370413874, 3966773377,
            1660817988, 3770638166, 698194415, 92466505, 399941585, 3301477423, 2578917060,
            3012966571, 1915213695, 3062576400, 2979801504, 3838450560, 975685759, 3154985631,
            1986911427, 3559636850, 2134674515, 3128102806, 1097660929, 1212690783, 3611467219,
            1232001761, 904465835, 671601217, 2829397960, 3910014855, 2035732477, 3262086074,
            3077756473, 1064556527, 3095006074, 436186642, 3844079107, 2798261317, 3470373096,
            218408908, 4184804463, 2826021777, 1939569756, 1452808097, 1149547097, 316749819,
            1631475409, 4023391942, 513096309, 3730431754, 3391919570, 4153138767, 1328779762,
            3015228258, 2487205968, 213982794, 1927310263, 897606115,
        ],
        &[
            133654450, 371159391, 40768202, 2113895976, 2732923987, 3215138425, 2391931662,
            2672734577, 195120416, 939150931, 1941696822, 2919872876, 2564539452, 3080820908,
            2846583634, 3349568397, 3465385329, 3550405793, 1724556069, 151917586, 3772273289,
            4156003461, 2380288065, 356475766, 4123619567, 1619017859, 3739529130, 490749645,
            267879469, 2890847693, 3854244893, 3384266657, 115723042, 103663103, 267682519,
            965965574, 1841386548, 2476428873, 6965648, 3347378817, 4174270937, 911558590,
            1958087705, 1467103561, 1925556384, 607664404, 2051263137, 3092553737, 3239342455,
            1360744647, 331798903, 938411111, 3063265275, 4144610940, 624250586,
        ],
        &[
            3712980585, 4273305215, 2588121912, 1482202110, 247010829, 2649827458, 2673293530,
            50266420, 3870816552,
        ],
        0,
        &[
            362121003, 2089507514, 1304606762, 1263278756, 358438501, 2269424948, 3806457519,
            1279073058, 2059434869, 1815692099, 652038027, 526160281, 1238911451, 1042947643,
            2960978573, 3022105016, 2649279744, 1198671551, 2684187685, 1000492760, 431499902,
            183857299, 3280835037, 1246895529, 2318725685, 2267164315, 979921718, 3857707914,
            3760109217, 2715707691, 1406885970, 2988297028, 209159729, 4186884247, 1096787060,
            1637274376, 3553955911, 204938738, 2626213055, 3882415239, 2634475536, 1602083916,
            1366306436, 671584326, 4002679807, 692653815, 3838450560, 975685759, 3154985631,
            1986911427, 3559636850, 2134674515, 3128102806, 1097660929, 1212690783, 3611467219,
            1232001761, 904465835, 671601217, 2829397960, 3910014855, 2035732477, 3262086074,
            3077756473, 1064556527, 3095006074, 436186642, 3844079107, 2798261317, 3470373096,
            218408908, 4184804463, 2826021777, 1939569756, 1452808097, 1149547097, 316749819,
            1631475409, 4023391942, 513096309, 3730431754, 3391919570, 4153138767, 1328779762,
            3015228258, 2487205968, 213982794, 1927310263, 897606115,
        ],
        &[
            3140142351, 3638334268, 927590030, 3257445174, 190628332, 423978494, 2125526010,
            2335881748, 2011775260, 216274817, 1589333931, 1946163796, 1138523295, 2352292265,
            2317299631, 396149636, 183537360, 1856054780, 1967999658, 2648197860, 2488238359,
            1116562390, 1716737533, 654919030, 1257625369, 207259609, 1080296394, 760726928,
            4030262909, 322722109, 165700418, 916023643, 509061695, 1838993212, 1386944612,
            883149264, 3915412058, 984212483, 2490512255, 1267948537, 3353722904, 4219683507,
            3867149352, 966462807, 1475584869, 399069467, 1202671548, 3834070512, 3499006193,
            2816966573, 103111667, 3966361608, 452216196, 3607393999, 624250586,
        ],
    );
    // qn == 2
    test(
        &[
            3451729766, 1173985848, 93029266, 2489920009, 3973680219, 780152687, 1953113811,
            856318718, 3314090115, 2569865885, 10849561, 743853677, 1946859719, 3063924404,
            3352045106, 101532091, 429420318, 3158186124, 1342100634, 1680882573, 4042659776,
            565667221, 989688746, 4541446, 834463803, 3523014310, 3432977627, 1818084880,
            3544409611, 1926948225, 3663387900, 1035293697, 285923430, 3096314023, 664014848,
            2054069437, 3124990832, 115905130, 1379323203, 2244054884, 2012040660, 1620087465,
            1907788850, 132467852, 3020885577, 238576412, 567018667, 3426013542, 3145012002,
            2070201540, 1421424259, 2074360440, 810615969, 153078550, 825376847, 2436604908,
            1365021492, 288298963, 3753461462, 4215347696, 514661745, 3484458912, 4247537127,
            1579462876, 3865189996, 1018915575, 2974009562, 3501816358, 2821759336, 2722697353,
            517866351, 632193686, 1959130106, 2570573609, 3726681184, 1695074321, 1803440017,
            268435105, 2059636298, 1870796488, 3616705235, 779907146, 3840642834, 3690603635,
            889240128, 4220497978, 1506894274, 3744062951, 3031958651, 4062058444, 2309758423,
            1411665710, 1638698058, 1784343146, 373693019, 3239595939, 1656022725, 1985062241,
            2188775097, 395478226, 2732514978, 2804731752, 4294707867, 2796289890, 4286815139,
            2694259304, 3400027223, 2866208426, 712658287, 3005677674, 3799280383, 333964254,
            426632823, 1071506508, 424615774, 1216913008, 1528084851, 2440789637, 8647650,
            1482353199, 1079815951, 1741478231, 335212928, 3230225069, 812456049, 1107265661,
            309740350, 39813940, 1038050523, 3708554333, 2276389162, 3145208114, 286364489,
            2078653938, 2343246544, 761958231, 2400118006, 2820784413, 91083352, 868359282,
            2976918690, 1899156995, 2927253740, 2971404198, 955553520, 2163090892, 1779162381,
            3706789234, 1427323973, 2892945053, 3765307938, 1888304940, 4281185143, 4063224403,
            3895821018, 292451283, 1315405597, 1278053061, 2659048964, 1651475603, 2464063324,
            2470117886, 885060568, 2223396118, 983203622, 2153273837, 909540554, 11662729,
            1290088356, 3558268851, 2470462290, 3816443571, 1219777270, 1663771088, 2059674235,
            3741754207, 918293007, 1170814255, 2592844500, 34078497, 868179007, 2916133370,
            224466504, 1457353443, 743181292, 2045016399, 4268051489, 2582113750, 108054210,
            1045580699, 1021681246, 4287699909, 2442965928, 2358040249, 2188665290, 2493816549,
            1868457202, 1538714165, 3141445884, 1886427078, 2413842865, 3754082182, 1242353411,
            837326189, 1891378866, 2004934119, 2718308820, 1293740965, 3706050263, 660923758,
            4037329521, 1659464686, 3767070633, 2733667846, 1303579884, 720201259, 4178102594,
            1521257108, 3676354960, 2861869547, 1694835235, 1663377877, 1033893232, 1788049008,
            2131980496, 1380320795, 1706971693, 1547085187, 4249747381, 4022331904, 3773862935,
            186851005, 1122661765, 2869769810, 714482846, 122240297, 1990969517, 1505355345,
            1418846887, 2157766299, 3944099174, 752193837, 2717991695, 3106584127, 2176113460,
            2424010054, 2202537322, 735567917, 2635174646, 57167007, 1501943516, 3981020168,
            2264071537, 1811387936, 3230232665, 2056500724, 2470649052, 298208196, 361093257,
            837772742,
        ],
        &[
            3759203346, 4116788486, 472182301, 1657732406, 1379670583, 1302865697, 694415200,
            281678172, 1654699562, 3014506006, 1741431230, 3860463155, 1145719988, 3566676616,
            2320845102, 2321995000, 536415919, 2387437419, 3567575351, 89009414, 1112333426,
            3147195251, 3149954561, 1503279897, 3064049622, 172526224, 3226367243, 4252316042,
            2985921401, 3319920602, 2971463135, 662010514, 2716903751, 3114900209, 4294888231,
            2302528059, 2985636330, 4227410510, 523042380, 1128527265, 2237860860, 2902190407,
            2028066064, 43980114, 85965472, 1423570354, 370469915, 2799642260, 678694776,
            4007712353, 1236341524, 2105667795, 1513858354, 3031596159, 3550734930, 4152331215,
            778814882, 736616127, 1334786757, 193672910, 4005017476, 49451649, 274162308,
            193472860, 3849716547, 1147344616, 3779102036, 636364760, 49841072, 4203872775,
            2917594088, 2516158563, 1718950767, 2409600701, 4112139783, 968713133, 2367692503,
            1383637739, 1447827357, 70112330, 1597216524, 1036612170, 47442040, 3535655506,
            3217988958, 1524147015, 1542229372, 4278993048, 1177373055, 2455939135, 3977288741,
            2323766505, 2631150922, 2494146789, 1766908673, 2014027584, 3170299898, 2200469205,
            447095672, 3553741345, 1471247393, 1705231371, 3597764506, 2179927417, 2057038135,
            2877684583, 4157842671, 3988568107, 136943619, 1758053719, 133243005, 1316787143,
            3912460869, 3007503154, 673776671, 2300353234, 2544200665, 1154464703, 2377559298,
            2085288775, 570803259, 1718587627, 1887771341, 2141823671, 812587685, 473768462,
            3537328856, 2051785610, 1867482529, 386483431, 2102139021, 3579998391, 1082229057,
            4197498026, 2004997074,
        ],
        &[
            3960768807, 1512612890, 3846503597, 4289005374, 3202073567, 4260281911, 4219386150,
        ],
        0,
        &[
            3383011450, 2938966556, 422368941, 3441497106, 3409423652, 2305567488, 3562827580,
            1338876308, 1099736044, 1201047259, 1743369967, 1491174234, 287230448, 3116597437,
            1643175661, 4211676401, 601814058, 2723977393, 3228175296, 3419496235, 2059811269,
            2947984775, 469809020, 251557204, 3013739023, 3166260707, 517974662, 920653259,
            3867055574, 34801513, 4073639353, 766741992, 3966323891, 2226406520, 2341832923,
            2682492751, 1942828791, 1732324839, 3967931993, 929680784, 1485027211, 2843893078,
            430780969, 4066926931, 3159632662, 3397052086, 2311817261, 2992832593, 1564064832,
            3020792541, 1056579269, 3627023013, 1422659846, 3325045886, 345931608, 1290807491,
            3973995577, 3750219800, 350963107, 4053409628, 4058696363, 3668673317, 1418277077,
            2159286564, 1868951430, 1399034844, 2585316317, 3592102683, 4163508856, 4075983119,
            78320926, 2811875443, 4059965405, 1357445571, 2986007740, 326981837, 3415489538,
            2531041805, 234199714, 3488607804, 1688036115, 744596707, 3014071644, 2766006369,
            2628073818, 654781813, 4265430858, 4287622569, 2665792473, 4154810693, 2848091329,
            755306763, 1245738903, 3190845925, 604185632, 294919488, 4045732560, 3602930508,
            1226696054, 2425992356, 2138768869, 1417531642, 3016312849, 1435667556, 3658864646,
            277170454, 1681853564, 2140619166, 76500316, 3095347477, 473108630, 4089067082,
            1142664387, 709297371, 1129824116, 1641660886, 4174467937, 869296342, 332188854,
            3873253978, 2646933540, 331422365, 2123872788, 1908091634, 1952247202, 3839276275,
            3725920254, 2040912245, 1038050523, 3708554333, 2276389162, 3145208114, 286364489,
            2078653938, 2343246544, 761958231, 2400118006, 2820784413, 91083352, 868359282,
            2976918690, 1899156995, 2927253740, 2971404198, 955553520, 2163090892, 1779162381,
            3706789234, 1427323973, 2892945053, 3765307938, 1888304940, 4281185143, 4063224403,
            3895821018, 292451283, 1315405597, 1278053061, 2659048964, 1651475603, 2464063324,
            2470117886, 885060568, 2223396118, 983203622, 2153273837, 909540554, 11662729,
            1290088356, 3558268851, 2470462290, 3816443571, 1219777270, 1663771088, 2059674235,
            3741754207, 918293007, 1170814255, 2592844500, 34078497, 868179007, 2916133370,
            224466504, 1457353443, 743181292, 2045016399, 4268051489, 2582113750, 108054210,
            1045580699, 1021681246, 4287699909, 2442965928, 2358040249, 2188665290, 2493816549,
            1868457202, 1538714165, 3141445884, 1886427078, 2413842865, 3754082182, 1242353411,
            837326189, 1891378866, 2004934119, 2718308820, 1293740965, 3706050263, 660923758,
            4037329521, 1659464686, 3767070633, 2733667846, 1303579884, 720201259, 4178102594,
            1521257108, 3676354960, 2861869547, 1694835235, 1663377877, 1033893232, 1788049008,
            2131980496, 1380320795, 1706971693, 1547085187, 4249747381, 4022331904, 3773862935,
            186851005, 1122661765, 2869769810, 714482846, 122240297, 1990969517, 1505355345,
            1418846887, 2157766299, 3944099174, 752193837, 2717991695, 3106584127, 2176113460,
            2424010054, 2202537322, 735567917, 2635174646, 57167007, 1501943516, 3981020168,
            2264071537, 1811387936, 3230232665, 2056500724, 2470649052, 298208196, 361093257,
            837772742,
        ],
        &[
            1749675900, 83311145, 2319870768, 2301367900, 1271820700, 747192890, 2232034578,
            1684674351, 822187230, 414936259, 2100509577, 185966671, 1061771611, 3500130342,
            4276690647, 134096197, 1179911702, 3421561451, 3874285979, 1344851609, 3061752781,
            3327328615, 3865677576, 591223571, 2568545891, 372730729, 1361413023, 2023563521,
            1478607449, 1648960675, 247130399, 1060143321, 1600722780, 921103987, 904451965,
            2354769424, 340638613, 4001953050, 2291069823, 3207532720, 3921016917, 2300622268,
            3350315220, 1522138271, 1701840068, 728838448, 2161612020, 2688147958, 2793847366,
            3143249066, 929591847, 3104030690, 4267580930, 3508243783, 47485068, 1536541035,
            1420646809, 4224049732, 3563196088, 3275106095, 1711584323, 2594679924, 1268092368,
            231157697, 668071638, 344786997, 3687449614, 16881734, 3140092004, 1393318795,
            1713196935, 2433823464, 1374415179, 2423443087, 3136309540, 1509935815, 4004255572,
            216492519, 2029994392, 3988519731, 2907701657, 4024136147, 3010412682, 3355385096,
            587056427, 843545218, 3427216656, 1849591496, 4266788714, 2762172153, 2717331277,
            3524940753, 3260631957, 4190369483, 2818033461, 1586210220, 287232230, 2797971739,
            4214297978, 3637418648, 3134694673, 4285547823, 3885295257, 400194158, 3539527555,
            374773706, 1304239426, 2101131656, 1302970725, 3320714797, 2310171496, 3594477385,
            2652118799, 1437455744, 2102949392, 3015601027, 597539063, 314696614, 4017109288,
            581923332, 3419296854, 1109941915, 2952877385, 3755730781, 1786037064, 326343125,
            2774269238, 834792453, 325590125, 2048571791, 476611388, 3330984047, 3771714201,
            4197498026, 2004997074,
        ],
    );
    // qh != 0 first time
    test(
        &[
            1444823481, 1895962470, 1145820971, 951685031, 1619286897, 645659681, 3225126137,
            1237595037, 528204561, 3332610202, 2935828481, 3511627759, 3794280700, 504366468,
            2867551534, 432130908, 1682537913, 2112976328, 291513836, 2849031909, 3326433036,
            1925364297, 3779561553, 487877982, 435659240, 1540143453, 3711236017, 1440132082,
            825660149, 1624471959, 1941539144,
        ],
        &[
            110690520, 2114031203, 436730283, 2624140005, 3364550071, 806172129, 2495686202,
            3508099340, 1915440069, 3196245075, 3757278096, 786923263, 1820433641, 3283619351,
            2326488762, 119217121, 3545365539, 3063896557, 1866040341, 3325517573, 713948948,
            2863092530, 2356199798, 3131342786, 4122497749, 3637172320, 2586791774, 2794104974,
            1738360752, 1591954820, 2633103962, 398797289, 30804220, 2682142316, 1858898375,
            2406882215, 999588447, 645011646, 3469603876, 3657151690, 2477958807, 286833025,
            1802487901, 2709688493, 2318425877, 3516543869,
        ],
        &[
            3866576925, 1873138890, 1768109056, 2705255084, 4241776445, 658244374, 286815054,
            153522406, 2020517918, 87408861, 541283899, 2327698817, 696800449, 1357243166,
            2373189783,
        ],
        1,
        &[
            4258888914, 1485342244, 864808754, 1855573169, 2779156179, 2884098865, 3015216190,
            233158379, 2131022258, 2947161299, 1457166139, 936993560, 1814334647, 2085655570,
            1964344103, 3265126561, 2194874867, 2958220463, 1400730387, 3516776467, 3089823491,
            3793414649, 3469628691, 1982433652, 3254747018, 787956375, 1101033526, 351690326,
            3218501609, 2653245227, 2069227013,
        ],
        &[
            1748815118, 2402822363, 2091637344, 2074482742, 2316188658, 2370992052, 3607116276,
            2077769165, 1723590682, 2807481888, 338472032, 1807369086, 4009280963, 3941733223,
            1094544382, 2098535093, 2506582809, 3109719127, 357556154, 1188096469, 1270505755,
            1666061640, 709956452, 1638211188, 3173895428, 1371359661, 2558759619, 3099150738,
            1645014902, 1085400897, 4169506964, 3811440745, 1449826037, 2483536058, 3820576906,
            887788442, 2096056214, 1991017777, 3100947384, 2236439089, 2060106107, 2771161047,
            2051308560, 1920428039, 1466054112, 1143354086,
        ],
    );
    // cy != 0 first time
    test(
        &[0, 0, 0, 0, 0, 0, 0],
        &[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
        &[0, 0, 0, 1, 0, 2147483648],
        0,
        &[7, 0, 0, 4294967292, 4294967295, 4294967295, 1],
        &[
            0, 0, 0, 4294967289, 4294967295, 2147483647, 4, 0, 0, 4294967294, 4294967295,
            2147483647, 1,
        ],
    );
}

#[cfg(not(feature = "32_bit_limbs"))]
#[test]
fn test_mpn_tdiv_qr() {
    let test = |quotient_limbs_in: &[Limb],
                remainder_limbs_in: &[Limb],
                numerator_limbs: &[Limb],
                denominator_limbs: &[Limb],
                quotient_limbs_out: &[Limb],
                remainder_limbs_out: &[Limb]| {
        let mut quotient_limbs = quotient_limbs_in.to_vec();
        let mut remainder_limbs = remainder_limbs_in.to_vec();
        mpn_tdiv_qr(
            &mut quotient_limbs,
            &mut remainder_limbs,
            numerator_limbs,
            denominator_limbs,
        );
        assert_eq!(quotient_limbs, quotient_limbs_out);
        assert_eq!(remainder_limbs, remainder_limbs_out);
    };
    test(
        &[
            10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
        ],
        &[
            10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
        ],
        &[
            9995257893114397114,
            9401504468144459131,
            558615837638945228,
            10733662027974786928,
            18295107704289976677,
            1814706268673753787,
            12474943759854623335,
            8814778832826774208,
            9159057654048965906,
            4451260977376821357,
            18241701617364042056,
            6169989192350218482,
            15071965537117101028,
            13509168527678537782,
            12224278653171635329,
            16077066393714953826,
            1433938684868066489,
            13014970036232570373,
            899282336249563956,
            3089487642230339536,
            3787737519477527148,
            16667686214395942740,
            8787122953224574943,
            7841835218775877827,
            9693303502025838409,
            16122224776459879427,
            144327425397945219,
        ],
        &[
            2350654041004706911,
            7834348511584604247,
            12756796070221345724,
            3842923787777653903,
            12373799197090248752,
            9712029403347085570,
            1426676505264168302,
            10586232903332693517,
            8387833601131974459,
            6290888746273553243,
            9503969704425173615,
        ],
        &[
            89235393247566392,
            5198286616477507104,
            15671556528191444298,
            6642842185819876016,
            1703950202232719208,
            6620591674460885314,
            9897211438557358662,
            12382449603707212210,
            13586842887558233290,
            11884313943008627054,
            3205830138969300059,
            4257812936318957065,
            11084100237971796628,
            13937343901544333624,
            11743372027422931451,
            280132530083052382,
            0,
        ],
        &[
            12688955427180652274,
            7641660693922643933,
            8789985477567049482,
            5698832637416200787,
            14684840547760545685,
            2822100467869581421,
            3557573565928866957,
            4409631974409684922,
            16994214656621423610,
            4513108841166793667,
            9009005527785483287,
            10,
            10,
            10,
            10,
            10,
            10,
        ],
    );
    test(
        &[10, 10, 10],
        &[
            10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
            10,
        ],
        &[
            748159237152854524,
            14199895651244313572,
            9044210482484213648,
            3880401870711113518,
            1694971440240542063,
            13547801197479934494,
            5244069077418598572,
            17329479401291658084,
            12613311850003558282,
            5618071535926791206,
            16954511293879569524,
            8600749590433482901,
            11708546551548237376,
            10879843710159659952,
            9101678715417935644,
            12126242459863584426,
            17259866272884195621,
            4418382641453775715,
            542305129955142216,
            6563442437678466173,
            12794875758080454756,
            7461769876910639905,
            17925257245127463276,
            5137728719899113924,
            12905981752247605071,
        ],
        &[
            2654882163556630563,
            2047318842992691178,
            17944530594807555614,
            17278864523505748498,
            1160166728089482341,
            18368953657130322418,
            3937719995815345698,
            12007028340444721520,
            1496744539933999053,
            1476923054783110845,
            6551619938265612084,
            16801911333947266527,
            13986495313155597995,
            6571595571877061463,
            10140569634762389822,
            16210530410764331582,
            15172903143228403872,
            5831780706385794192,
            12288937301416472500,
            16224579586702000460,
            14545605105156691376,
            8614987803254853144,
            16629891239728134900,
        ],
        &[17831022488782895576, 14315989140983049585, 0],
        &[
            18140975738986113396,
            16765596268029991308,
            14497740378349400824,
            8834432760455669008,
            2081502095596466916,
            16785570606386467383,
            5299348241512211807,
            17503170383548190207,
            16775442261989831354,
            8131705923782084593,
            266320274487676679,
            6602256474512308593,
            2102043233085822823,
            11614561527212258722,
            17915538208051341722,
            5710195504177465517,
            2094480568485157388,
            14339014023087152780,
            6947889352398323832,
            10985139413433625547,
            12373170520775701923,
            9198039438688117621,
            15475638737141339650,
        ],
    );
    test(
        &[10; 60],
        &[10; 56],
        &[
            14660214196707223375,
            14265972253040120215,
            15506320303100465818,
            17085621003033826581,
            11203337550022453944,
            15493204961705835371,
            5803021083410871755,
            8112917457002746745,
            12663484193891261040,
            1721048899893287199,
            8062187621610464306,
            13431761655884620090,
            7331427712144411262,
            3626934647030185267,
            13231383914073320042,
            11637171044660683638,
            15189928975258171045,
            941827519265124224,
            2992792486091076914,
            2044203374633195985,
            8310380355675814732,
            1677894573715118386,
            1863631713396879617,
            13750903464355877990,
            13561054993991137710,
            6643134394212488277,
            9782189322903525535,
            7987880548748269544,
            17396502810230452231,
            9355336424066456608,
            6974435047841500624,
            4695995454788932008,
            9790410161672155866,
            7324176676989916049,
            14873447357313289350,
            17933513319573948354,
            16221633809094225356,
            1119296061370324791,
            13659405622992751643,
            10536448431317839371,
            15771892335411705715,
            6450515195565208913,
            12583173873673842188,
            8943105588740166659,
            16781237121411387206,
            7355272525679995848,
            8924936502454129260,
            9464007023044637842,
            2392086820925613645,
            6952992660961663836,
            15709161892606831425,
            15961199354349516091,
            8170938350051511007,
            10106337242460916657,
            4519632767875399815,
            13966478644099829332,
            18146666299243951179,
            18001892575388798951,
            17442461326088111501,
            12996149925790510613,
            15125238000270787220,
            13458137050174539117,
            7565676737178758148,
            7820895745333505106,
            18391820881894926862,
            17227107494212736312,
            16170524482788524562,
            18292226432698054709,
            16409124153431213414,
            2622798522164114141,
            2030148142272451724,
            12631034221630749586,
            12521714531249855181,
            4869764655816857917,
            18312880399388298885,
            1881841240505020002,
            16686085102712131293,
            1638984612454565124,
            5980766772519196081,
            14473546029553426533,
            2610255570241349719,
            4121823778233332328,
            15196027812344512481,
            17634932614139407184,
            14566629132274047837,
            6629067916649366603,
            39453246491293667,
            4118307938296638515,
            176389639877922730,
            2385844666265721927,
            14424300909552701177,
            2596064544694255252,
            9262830285738421829,
            8366979142044016136,
            12451088247268499723,
            16456341544263224076,
            405434591376297036,
            5989071471671786526,
            17922319711997177283,
            12402685985480014221,
            11440567647536028583,
            17109382986734751589,
            1165111999013207871,
            9042409351611763515,
            335396288523389342,
            6889397323074150916,
            13998858741906849976,
            15927944587197048898,
            10995067153735213576,
            13255077995174337515,
            11985913648073551062,
            16606199253171990948,
            16615211378568935152,
            13000672060735124358,
        ],
        &[
            6726150808576237754,
            9590776370558469124,
            4613857594775205869,
            5605914158178321857,
            12627075307783464761,
            456502911636413728,
            6201419543988208076,
            12457367465345491402,
            9194484469177303126,
            14469237774454463326,
            8872571916644400618,
            10371861714649740250,
            9551882050917532587,
            1418647961867356190,
            11742587182398063873,
            11015016132415914044,
            8777839015232205587,
            11080046461630228193,
            13740325869131645472,
            17716201322003396844,
            2184375889136968144,
            2744007897878529583,
            10107840174031679018,
            6807210551800087042,
            3927845063936277496,
            4657264236265855475,
            18202437017170404187,
            5332422779150911238,
            15515262280249200267,
            248667350560422394,
            3473467338029486524,
            5450666559053310869,
            9114347711968955703,
            1001965327187909086,
            9391480248060184246,
            9069754537718985217,
            6108113375902101471,
            615335597740998377,
            7341924484422171664,
            7557688311245960406,
            10629369615492290302,
            6551022068682485711,
            13009629572214277263,
            9801266711191462998,
            12475469715378400041,
            16817728089246511388,
            5318131496704799888,
            14034696640350324685,
            173195053797772988,
            9465580662794117123,
            9395502290798332505,
            172507413604644051,
            13462235362634225088,
            9267822876689174860,
            12978933587961252639,
        ],
        &[
            12372756710207599663,
            9737052986771636298,
            16735862446672978006,
            1139195382411501599,
            4025384807176208306,
            10128156782936698507,
            7100085357301525578,
            10639782880668134749,
            3972383448210895518,
            16316091826865092258,
            14638110565144662169,
            17027377005940147919,
            1984424298563015784,
            10943215534705396352,
            4761407742818533080,
            536799158643182373,
            3577912885973196462,
            8426618872156874849,
            13718975316423099691,
            9890119685862829437,
            1661366149680121631,
            18221664832966866708,
            1501909944594354041,
            15664453277583965124,
            3204453056814894230,
            11234664797845870989,
            865170089562739167,
            15036893469165510103,
            9555056751383235767,
            10793253279766963078,
            10975966662822330260,
            6344197561810800775,
            10052816891387114632,
            5489737378772055553,
            3577007843046523907,
            5025363426761413084,
            11669827237042875622,
            15298941946562692234,
            5287362685718508737,
            14167437013528222514,
            108442285706035530,
            12321077902001896155,
            4987860952577552150,
            4822344167562733502,
            5046873607058225743,
            15023457088946801127,
            10073890866526654379,
            9395914048369797781,
            12331509678230261831,
            4207910636930067124,
            13640015182632895728,
            16512336849198622133,
            750194286339711619,
            3343827571253159031,
            1179021970615059386,
            9309853498190567264,
            8323638524074867625,
            2319424490723820181,
            30896532530597901,
            1,
        ],
        &[
            16979197013852036393,
            4534519222829727882,
            5127955051936920534,
            5669732551578654322,
            13787946500638697314,
            2666880029397285003,
            18286001525339884787,
            3747928243980886079,
            5670276194023029484,
            15201258611907138387,
            6046915833599742673,
            13282924752646783062,
            18026143804639821221,
            10186643213552896189,
            17209309200088910354,
            13215180252119768256,
            1246399679408038126,
            4186715523775575401,
            16756959752065842207,
            6600048850655585015,
            4543693866439677976,
            15594233518271892275,
            15247811862837572166,
            6322126320582019533,
            649809830609098083,
            5229876751712742127,
            17719948521867410031,
            10737539927122287433,
            12476905306147178753,
            1539850235988803702,
            13572545877865905325,
            11163694899331373883,
            7882148214994127637,
            8164419266634080608,
            5782587821804107698,
            12155391719814216620,
            8020222143449740150,
            8489927257914490530,
            15688922762526028920,
            207673185831465902,
            13825819490340731785,
            14207999229863934400,
            10163751595898713958,
            17777080404153962435,
            17016927136773389232,
            3820023214020965653,
            1892439588667561762,
            16909683715900311832,
            11919385779232783009,
            11201007117990222527,
            8700983269916503928,
            5034192113764375450,
            12790439085134048151,
            17790018876931315900,
            5953092655978688336,
            10,
        ],
    );
}

#[test]
fn test_div_mod() {
    let test = |u, v, quotient, remainder| {
        let mut x = Natural::from_str(u).unwrap();
        let r = x.div_assign_mod(Natural::from_str(v).unwrap());
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);
        assert!(x.is_valid());
        assert_eq!(x.to_string(), quotient);

        let mut x = Natural::from_str(u).unwrap();
        let r = x.div_assign_mod(&Natural::from_str(v).unwrap());
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);
        assert!(x.is_valid());
        assert_eq!(x.to_string(), quotient);

        let (q, r) = Natural::from_str(u)
            .unwrap()
            .div_mod(Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let (q, r) = Natural::from_str(u)
            .unwrap()
            .div_mod(&Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let (q, r) = (&Natural::from_str(u).unwrap()).div_mod(Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let (q, r) = (&Natural::from_str(u).unwrap()).div_mod(&Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let mut x = Natural::from_str(u).unwrap();
        let r = x.div_assign_rem(Natural::from_str(v).unwrap());
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);
        assert!(x.is_valid());
        assert_eq!(x.to_string(), quotient);

        let mut x = Natural::from_str(u).unwrap();
        let r = x.div_assign_rem(&Natural::from_str(v).unwrap());
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);
        assert!(x.is_valid());
        assert_eq!(x.to_string(), quotient);

        let (q, r) = Natural::from_str(u)
            .unwrap()
            .div_rem(Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let (q, r) = Natural::from_str(u)
            .unwrap()
            .div_rem(&Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let (q, r) = (&Natural::from_str(u).unwrap()).div_rem(Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let (q, r) = (&Natural::from_str(u).unwrap()).div_rem(&Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let (q, r) = BigUint::from_str(u)
            .unwrap()
            .div_mod_floor(&BigUint::from_str(v).unwrap());
        assert_eq!(q.to_string(), quotient);
        assert_eq!(r.to_string(), remainder);

        let (q, r) = BigUint::from_str(u)
            .unwrap()
            .div_rem(&BigUint::from_str(v).unwrap());
        assert_eq!(q.to_string(), quotient);
        assert_eq!(r.to_string(), remainder);

        let (q, r) = rug::Integer::from_str(u)
            .unwrap()
            .div_rem_floor(rug::Integer::from_str(v).unwrap());
        assert_eq!(q.to_string(), quotient);
        assert_eq!(r.to_string(), remainder);

        let (q, r) = rug::Integer::from_str(u)
            .unwrap()
            .div_rem(rug::Integer::from_str(v).unwrap());
        assert_eq!(q.to_string(), quotient);
        assert_eq!(r.to_string(), remainder);

        //TODO
        /*
        let (q, r) = (
            Natural::from_str(u).unwrap() / v,
            Natural::from_str(u).unwrap() % v,
        );
        assert_eq!(q.to_string(), quotient);
        assert_eq!(r, remainder);
        */
    };
    test("0", "1", "0", "0");
    test("0", "123", "0", "0");
    test("1", "1", "1", "0");
    test("123", "1", "123", "0");
    test("123", "123", "1", "0");
    test("123", "456", "0", "123");
    test("456", "123", "3", "87");
    test("4294967295", "1", "4294967295", "0");
    test("4294967295", "4294967295", "1", "0");
    test("1000000000000", "1", "1000000000000", "0");
    test("1000000000000", "3", "333333333333", "1");
    test("1000000000000", "123", "8130081300", "100");
    test("1000000000000", "4294967295", "232", "3567587560");
    test(
        "1000000000000000000000000",
        "1",
        "1000000000000000000000000",
        "0",
    );
    test(
        "1000000000000000000000000",
        "3",
        "333333333333333333333333",
        "1",
    );
    test(
        "1000000000000000000000000",
        "123",
        "8130081300813008130081",
        "37",
    );
    test(
        "1000000000000000000000000",
        "4294967295",
        "232830643708079",
        "3167723695",
    );
    test(
        "1000000000000000000000000",
        "1234567890987",
        "810000006723",
        "530068894399",
    );
    test(
        "100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\
        0",
        "1234567890987654321234567890987654321",
        "810000006723000055638900467181273922269593923137018654",
        "779655053998040854338961591319296066",
    );
    test(
        "100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\
        0",
        "316049380092839506236049380092839506176",
        "3164062526261718967339454949926851258865601262253979",
        "37816691783627670491375998320948925696",
    );
    test(
        "253640751230376270397812803167",
        "2669936877441",
        "94998781946290113",
        "1520301762334",
    );
    test(
        "3768477692975601",
        "11447376614057827956",
        "0",
        "3768477692975601",
    );
    test(
        "3356605361737854",
        "3081095617839357",
        "1",
        "275509743898497",
    );
    test(
        "1098730198198174614195",
        "953382298040157850476",
        "1",
        "145347900158016763719",
    );
    test(
        "69738658860594537152875081748",
        "69738658860594537152875081748",
        "1",
        "0",
    );
    test(
        "1000000000000000000000000",
        "1000000000000000000000000",
        "1",
        "0",
    );
    test("0", "1000000000000000000000000", "0", "0");
    test("123", "1000000000000000000000000", "0", "123");
}

#[test]
#[should_panic]
fn div_assign_mod_fail() {
    Natural::from(10u32).div_assign_mod(Natural::ZERO);
}

#[test]
#[should_panic]
fn div_assign_mod_ref_fail() {
    Natural::from(10u32).div_assign_mod(&Natural::ZERO);
}

#[test]
#[should_panic]
fn div_mod_fail() {
    Natural::from(10u32).div_mod(Natural::ZERO);
}

#[test]
#[should_panic]
fn div_mod_val_ref_fail() {
    Natural::from(10u32).div_mod(&Natural::ZERO);
}

#[test]
#[should_panic]
fn div_mod_ref_val_fail() {
    (&Natural::from(10u32)).div_mod(Natural::ZERO);
}

#[test]
#[should_panic]
fn div_mod_ref_ref_fail() {
    (&Natural::from(10u32)).div_mod(&Natural::ZERO);
}

#[test]
#[should_panic]
fn div_assign_rem_fail() {
    Natural::from(10u32).div_assign_rem(Natural::ZERO);
}

#[test]
#[should_panic]
fn div_assign_rem_ref_fail() {
    Natural::from(10u32).div_assign_rem(&Natural::ZERO);
}

#[test]
#[should_panic]
fn div_rem_fail() {
    Natural::from(10u32).div_rem(Natural::ZERO);
}

#[test]
#[should_panic]
fn div_rem_val_ref_fail() {
    Natural::from(10u32).div_rem(&Natural::ZERO);
}

#[test]
#[should_panic]
fn div_rem_ref_val_fail() {
    (&Natural::from(10u32)).div_rem(Natural::ZERO);
}

#[test]
#[should_panic]
fn div_rem_ref_ref_fail() {
    (&Natural::from(10u32)).div_rem(&Natural::ZERO);
}

#[test]
fn test_ceiling_div_neg_mod() {
    let test = |u, v, quotient, remainder| {
        let mut x = Natural::from_str(u).unwrap();
        let r = x.ceiling_div_assign_neg_mod(Natural::from_str(v).unwrap());
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);
        assert!(x.is_valid());
        assert_eq!(x.to_string(), quotient);

        let mut x = Natural::from_str(u).unwrap();
        let r = x.ceiling_div_assign_neg_mod(&Natural::from_str(v).unwrap());
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);
        assert!(x.is_valid());
        assert_eq!(x.to_string(), quotient);

        let (q, r) = Natural::from_str(u)
            .unwrap()
            .ceiling_div_neg_mod(Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let (q, r) = Natural::from_str(u)
            .unwrap()
            .ceiling_div_neg_mod(&Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let (q, r) =
            (&Natural::from_str(u).unwrap()).ceiling_div_neg_mod(Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let (q, r) =
            (&Natural::from_str(u).unwrap()).ceiling_div_neg_mod(&Natural::from_str(v).unwrap());
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);
        assert!(r.is_valid());
        assert_eq!(r.to_string(), remainder);

        let (q, r) = rug_ceiling_div_neg_mod(
            rug::Integer::from_str(u).unwrap(),
            rug::Integer::from_str(v).unwrap(),
        );
        assert_eq!(q.to_string(), quotient);
        assert_eq!(r.to_string(), remainder);

        //TODO
        /*
        let (q, r) = (
            Natural::from_str(u).unwrap().div_round(v, RoundingMode::Ceiling),
            Natural::from_str(u).unwrap().neg_mod(v),
        );
        assert_eq!(q.to_string(), quotient);
        assert_eq!(r, remainder);
        */
    };
    test("0", "1", "0", "0");
    test("0", "123", "0", "0");
    test("1", "1", "1", "0");
    test("123", "1", "123", "0");
    test("123", "123", "1", "0");
    test("123", "456", "1", "333");
    test("456", "123", "4", "36");
    test("4294967295", "1", "4294967295", "0");
    test("4294967295", "4294967295", "1", "0");
    test("1000000000000", "1", "1000000000000", "0");
    test("1000000000000", "3", "333333333334", "2");
    test("1000000000000", "123", "8130081301", "23");
    test("1000000000000", "4294967295", "233", "727379735");
    test(
        "1000000000000000000000000",
        "1",
        "1000000000000000000000000",
        "0",
    );
    test(
        "1000000000000000000000000",
        "3",
        "333333333333333333333334",
        "2",
    );
    test(
        "1000000000000000000000000",
        "123",
        "8130081300813008130082",
        "86",
    );
    test(
        "1000000000000000000000000",
        "4294967295",
        "232830643708080",
        "1127243600",
    );
    test(
        "1000000000000000000000000",
        "1234567890987",
        "810000006724",
        "704498996588",
    );
    test(
        "10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\
         00",
        "1234567890987654321234567890987654321",
        "810000006723000055638900467181273922269593923137018655",
        "454912836989613466895606299668358255",
    );
    test(
        "10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\
         00",
        "316049380092839506236049380092839506176",
        "3164062526261718967339454949926851258865601262253980",
        "278232688309211835744673381771890580480",
    );
    test(
        "253640751230376270397812803167",
        "2669936877441",
        "94998781946290114",
        "1149635115107",
    );
    test(
        "3768477692975601",
        "11447376614057827956",
        "1",
        "11443608136364852355",
    );
    test(
        "3356605361737854",
        "3081095617839357",
        "2",
        "2805585873940860",
    );
    test(
        "1098730198198174614195",
        "953382298040157850476",
        "2",
        "808034397882141086757",
    );
    test(
        "69738658860594537152875081748",
        "69738658860594537152875081748",
        "1",
        "0",
    );
    test(
        "1000000000000000000000000",
        "1000000000000000000000000",
        "1",
        "0",
    );
    test("0", "1000000000000000000000000", "0", "0");
    test(
        "123",
        "1000000000000000000000000",
        "1",
        "999999999999999999999877",
    );
}

#[test]
#[should_panic]
fn ceiling_div_assign_neg_mod_fail() {
    Natural::from(10u32).ceiling_div_assign_neg_mod(Natural::ZERO);
}

#[test]
#[should_panic]
fn ceiling_div_assign_neg_mod_ref_fail() {
    Natural::from(10u32).ceiling_div_assign_neg_mod(&Natural::ZERO);
}

#[test]
#[should_panic]
fn ceiling_div_neg_mod_fail() {
    Natural::from(10u32).ceiling_div_neg_mod(Natural::ZERO);
}

#[test]
#[should_panic]
fn ceiling_div_neg_mod_val_ref_fail() {
    Natural::from(10u32).ceiling_div_neg_mod(&Natural::ZERO);
}

#[test]
#[should_panic]
fn ceiling_div_neg_mod_ref_val_fail() {
    (&Natural::from(10u32)).ceiling_div_neg_mod(Natural::ZERO);
}

#[test]
#[should_panic]
fn ceiling_div_neg_mod_ref_ref_fail() {
    (&Natural::from(10u32)).ceiling_div_neg_mod(&Natural::ZERO);
}

#[test]
fn limbs_two_limb_inverse_helper_properties() {
    test_properties(pairs_of_unsigneds_var_2, |&(hi, lo)| {
        let result = limbs_two_limb_inverse_helper(hi, lo);
        verify_limbs_two_limb_inverse_helper(hi, lo, result);
    });
}

#[test]
fn limbs_div_mod_three_limb_by_two_limb_properties() {
    test_properties(
        sextuples_of_limbs_var_1,
        |&(n_2, n_1, n_0, d_1, d_0, inverse)| {
            let (q, r) = limbs_div_mod_three_limb_by_two_limb(n_2, n_1, n_0, d_1, d_0, inverse);
            verify_limbs_div_mod_three_limb_by_two_limb(n_2, n_1, n_0, d_1, d_0, q, r);
        },
    );
}

#[test]
fn limbs_div_mod_by_two_limb_properties() {
    test_properties(
        triples_of_unsigned_vec_var_37,
        |(quotient_limbs_in, numerator_limbs_in, denominator_limbs)| {
            let mut quotient_limbs = quotient_limbs_in.clone();
            let mut numerator_limbs = numerator_limbs_in.clone();
            let quotient_hi = limbs_div_mod_by_two_limb(
                &mut quotient_limbs,
                &mut numerator_limbs,
                &denominator_limbs,
            );
            verify_limbs_div_mod_by_two_limb(
                &quotient_limbs_in,
                &numerator_limbs_in,
                &denominator_limbs,
                quotient_hi,
                &quotient_limbs,
                &numerator_limbs,
            );
        },
    );
}

#[test]
fn limbs_div_mod_schoolbook_properties() {
    test_properties(
        quadruples_of_three_unsigned_vecs_and_unsigned_var_1,
        |(ref quotient_limbs_in, ref numerator_limbs_in, ref denominator_limbs, inverse)| {
            let mut quotient_limbs = quotient_limbs_in.clone();
            let mut numerator_limbs = numerator_limbs_in.clone();
            let quotient_hi = _limbs_div_mod_schoolbook(
                &mut quotient_limbs,
                &mut numerator_limbs,
                denominator_limbs,
                *inverse,
            );
            verify_limbs_div_mod(
                quotient_limbs_in,
                numerator_limbs_in,
                denominator_limbs,
                if quotient_hi { 1 } else { 0 },
                &quotient_limbs,
                &numerator_limbs,
            );
        },
    );
}

#[test]
fn limbs_div_mod_divide_and_conquer_helper_properties() {
    test_properties_custom_scale(
        128,
        quintuples_of_three_unsigned_vecs_unsigned_and_unsigned_vec_var_1,
        |(
            ref quotient_limbs_in,
            ref numerator_limbs_in,
            ref denominator_limbs,
            inverse,
            ref scratch_in,
        )| {
            let mut quotient_limbs = quotient_limbs_in.clone();
            let mut numerator_limbs = numerator_limbs_in.clone();
            let mut scratch = scratch_in.clone();
            _limbs_div_mod_divide_and_conquer_helper(
                &mut quotient_limbs,
                &mut numerator_limbs,
                denominator_limbs,
                *inverse,
                &mut scratch,
            );
        },
    );
}

#[test]
fn limbs_div_mod_divide_and_conquer_properties() {
    test_properties_custom_scale(
        128,
        quadruples_of_three_unsigned_vecs_and_unsigned_var_2,
        |(ref quotient_limbs_in, ref numerator_limbs_in, ref denominator_limbs, inverse)| {
            let mut quotient_limbs = quotient_limbs_in.clone();
            let mut numerator_limbs = numerator_limbs_in.clone();
            let quotient_hi = _limbs_div_mod_divide_and_conquer(
                &mut quotient_limbs,
                &mut numerator_limbs,
                denominator_limbs,
                *inverse,
            );
            verify_limbs_div_mod(
                quotient_limbs_in,
                numerator_limbs_in,
                denominator_limbs,
                quotient_hi,
                &quotient_limbs,
                &numerator_limbs,
            );
        },
    );
}

fn div_mod_properties_helper(x: &Natural, y: &Natural) {
    let mut mut_x = x.clone();
    let remainder = mut_x.div_assign_mod(y);
    assert!(mut_x.is_valid());
    assert!(remainder.is_valid());
    let quotient = mut_x;

    let mut mut_x = x.clone();
    let remainder_alt = mut_x.div_assign_mod(y.clone());
    let quotient_alt = mut_x;
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.div_mod(y);
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.div_mod(y.clone());
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.clone().div_mod(y);
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.clone().div_mod(y.clone());
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let mut quotient_alt = x.clone();
    let remainder_alt = quotient_alt.div_assign_rem(y);
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let mut quotient_alt = x.clone();
    let remainder_alt = quotient_alt.div_assign_rem(y.clone());
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.div_rem(y);
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.div_rem(y.clone());
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.clone().div_rem(y);
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.clone().div_rem(y.clone());
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    //TODO
    /*
    let (quotient_alt, remainder_alt) = (x / y, x % y);
    assert_eq!(quotient_alt, quotient);
    assert_eq!(remainder_alt, remainder);
    */

    let (num_quotient, num_remainder) = natural_to_biguint(x).div_mod_floor(&natural_to_biguint(y));
    assert_eq!(biguint_to_natural(&num_quotient), quotient);
    assert_eq!(biguint_to_natural(&num_remainder), remainder);

    let (num_quotient, num_remainder) = natural_to_biguint(x).div_rem(&natural_to_biguint(y));
    assert_eq!(biguint_to_natural(&num_quotient), quotient);
    assert_eq!(biguint_to_natural(&num_remainder), remainder);

    let (rug_quotient, rug_remainder) =
        natural_to_rug_integer(x).div_rem_floor(natural_to_rug_integer(y));
    assert_eq!(rug_integer_to_natural(&rug_quotient), quotient);
    assert_eq!(rug_integer_to_natural(&rug_remainder), remainder);

    let (rug_quotient, rug_remainder) =
        natural_to_rug_integer(x).div_rem(natural_to_rug_integer(y));
    assert_eq!(rug_integer_to_natural(&rug_quotient), quotient);
    assert_eq!(rug_integer_to_natural(&rug_remainder), remainder);

    assert!(remainder < *y);
    assert_eq!(quotient * y + remainder, *x);
}

#[test]
fn div_mod_properties() {
    test_properties_custom_scale(
        128,
        pairs_of_natural_and_positive_natural,
        |&(ref x, ref y)| {
            div_mod_properties_helper(x, y);
        },
    );

    test_properties_custom_scale(
        128,
        pairs_of_natural_and_positive_natural_var_1,
        |&(ref x, ref y)| {
            div_mod_properties_helper(x, y);
        },
    );

    test_properties(naturals, |n| {
        let (q, r) = n.div_mod(Natural::ONE);
        assert_eq!(q, *n);
        assert_eq!(r, 0 as Limb);
    });

    test_properties(positive_naturals, |n| {
        assert_eq!(n.div_mod(Natural::ONE), (n.clone(), Natural::ZERO));
        assert_eq!(n.div_mod(n), (Natural::ONE, Natural::ZERO));
        assert_eq!(Natural::ZERO.div_mod(n), (Natural::ZERO, Natural::ZERO));
        if *n > 1 as Limb {
            assert_eq!(Natural::ONE.div_mod(n), (Natural::ZERO, Natural::ONE));
        }
    });
}

fn ceiling_div_neg_mod_properties_helper(x: &Natural, y: &Natural) {
    let mut mut_x = x.clone();
    let remainder = mut_x.ceiling_div_assign_neg_mod(y);
    assert!(mut_x.is_valid());
    assert!(remainder.is_valid());
    let quotient = mut_x;

    let mut mut_x = x.clone();
    let remainder_alt = mut_x.ceiling_div_assign_neg_mod(y.clone());
    let quotient_alt = mut_x;
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.ceiling_div_neg_mod(y);
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.ceiling_div_neg_mod(y.clone());
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.clone().ceiling_div_neg_mod(y);
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    let (quotient_alt, remainder_alt) = x.clone().ceiling_div_neg_mod(y.clone());
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);
    assert!(remainder_alt.is_valid());
    assert_eq!(remainder_alt, remainder);

    //TODO
    /*
    let (quotient_alt, remainder_alt) = (x.div_round(y, RoundingMode::Ceiling), x.neg_mod(y));
    assert_eq!(quotient_alt, quotient);
    assert_eq!(remainder_alt, remainder);
    */

    let (rug_quotient, rug_remainder) =
        rug_ceiling_div_neg_mod(natural_to_rug_integer(x), natural_to_rug_integer(y));
    assert_eq!(rug_integer_to_natural(&rug_quotient), quotient);
    assert_eq!(rug_integer_to_natural(&rug_remainder), remainder);

    assert!(remainder < *y);
    assert_eq!(quotient * y - remainder, *x);
}

#[test]
fn ceiling_div_neg_mod_limb_properties() {
    test_properties(pairs_of_natural_and_positive_natural, |&(ref x, ref y)| {
        ceiling_div_neg_mod_properties_helper(x, y);
    });

    test_properties(
        pairs_of_natural_and_positive_natural_var_1,
        |&(ref x, ref y)| {
            ceiling_div_neg_mod_properties_helper(x, y);
        },
    );

    test_properties(naturals, |n| {
        let (q, r) = n.ceiling_div_neg_mod(Natural::ONE);
        assert_eq!(q, *n);
        assert_eq!(r, 0 as Limb);
    });

    test_properties(positive_naturals, |n| {
        assert_eq!(
            n.ceiling_div_neg_mod(Natural::ONE),
            (n.clone(), Natural::ZERO)
        );
        assert_eq!(n.ceiling_div_neg_mod(n), (Natural::ONE, Natural::ZERO));
        assert_eq!(
            Natural::ZERO.ceiling_div_neg_mod(n),
            (Natural::ZERO, Natural::ZERO)
        );
        if *n > 1 as Limb {
            assert_eq!(
                Natural::ONE.ceiling_div_neg_mod(n),
                (Natural::ONE, n - 1 as Limb)
            );
        }
    });
}
