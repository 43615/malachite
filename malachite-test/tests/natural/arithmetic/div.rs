use std::str::FromStr;

use malachite_base::num::arithmetic::traits::DivMod;
use malachite_base::num::basic::traits::{One, Zero};
use malachite_nz::natural::arithmetic::div::{
    _limbs_div_barrett_approx, _limbs_div_barrett_approx_scratch_len,
    _limbs_div_divide_and_conquer, _limbs_div_divide_and_conquer_approx, _limbs_div_schoolbook,
    _limbs_div_schoolbook_approx,
};
use malachite_nz::natural::arithmetic::div_mod::limbs_two_limb_inverse_helper;
use malachite_nz::natural::Natural;
use malachite_nz::platform::Limb;
use num::BigUint;
use rug;

use common::{test_properties, test_properties_custom_scale};
use malachite_test::common::{
    biguint_to_natural, natural_to_biguint, natural_to_rug_integer, rug_integer_to_natural,
};
use malachite_test::inputs::base::{
    quadruples_of_three_unsigned_vecs_and_unsigned_var_1,
    quadruples_of_three_unsigned_vecs_and_unsigned_var_2, triples_of_unsigned_vec_var_41,
};
use malachite_test::inputs::natural::{
    naturals, pairs_of_natural_and_positive_natural, pairs_of_natural_and_positive_natural_var_1,
    positive_naturals,
};

fn verify_limbs_div(qs_in: &[Limb], ns_in: &[Limb], ds: &[Limb], q_highest: bool, qs_out: &[Limb]) {
    let n = Natural::from_limbs_asc(ns_in);
    let d = Natural::from_limbs_asc(ds);
    let expected_q = &n / &d;
    let base_q_len = ns_in.len() - ds.len();
    let mut qs = qs_out[..base_q_len].to_vec();
    if q_highest {
        qs.push(1);
    }
    let q = Natural::from_owned_limbs_asc(qs);
    assert_eq!(
        q, expected_q,
        "{:?} {:?} n: {} d: {} q: {} expected_q: {}",
        ns_in, ds, n, d, q, expected_q
    );
    assert_eq!(&qs_in[base_q_len..], &qs_out[base_q_len..]);
    let r = n - q * &d;
    assert!(r < d);
}

#[test]
fn test_limbs_div_schoolbook() {
    let test = |qs_in: &[Limb], ns_in: &[Limb], ds: &[Limb], q_highest, qs_out: &[Limb]| {
        let mut qs = qs_in.to_vec();
        let mut ns = ns_in.to_vec();
        let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
        assert_eq!(
            _limbs_div_schoolbook(&mut qs, &mut ns, ds, inverse),
            q_highest
        );
        assert_eq!(qs, qs_out);
        verify_limbs_div(qs_in, ns_in, ds, q_highest, &qs);
    };
    #[cfg(feature = "32_bit_limbs")]
    {
        // q_len < d_len_m_1
        // !highest_q first time
        // !(!flag || n_1 < Limb::checked_from(d_len).unwrap())
        test(&[10], &[1, 2, 3], &[3, 4, 0x8000_0000], false, &[10]);
        // q_len >= d_len_m_1
        // !(n_1 == d_1 && ns[d_len_s_m_1] == d_2)
        // !carry first time
        // d_len_s >= 2
        // !(!flag || n_1 >= d_1) first time
        // !carry second time
        // !(!flag || n_1 >= d_1) second time
        test(
            &[10, 10, 10, 10],
            &[1, 2, 3, 4, 5, 6],
            &[3, 4, 0x8000_0000],
            false,
            &[4294967207, 9, 12, 10],
        );
        // !flag || n_1 < Limb::checked_from(d_len).unwrap()
        // !highest_q second time
        // q_len != 0
        // limbs_sub_limb_in_place(
        //      ns_hi,
        //      limbs_sub_mul_limb_same_length_in_place_left(ns_lo, qs, ds[i])) fourth time
        // n_1 == 0 third time
        test(&[10], &[0, 0, 0, 1], &[1, 0, 2147483648], false, &[1]);
        // q_len == 0
        test(&[10], &[0; 3], &[0, 0, 2147483648], false, &[10]);
        // *ns_last >= carry
        test(&[10; 3], &[0; 5], &[0, 0, 2147483648], false, &[0, 0, 10]);
        // n_1 != 0 third time
        test(
            &[10; 2],
            &[0, 0, 1, 1],
            &[1, 0, 2147483648],
            false,
            &[2, 10],
        );
        // highest_q first time
        test(
            &[10, 10],
            &[
                2460989955, 642673607, 1971681331, 2338977519, 475442971, 2516527409, 3470931196,
                4262052990,
            ],
            &[
                1430162564, 1873089879, 3090281851, 2861182896, 2502166555, 2486624904, 960387080,
                3073064701,
            ],
            true,
            &[10, 10],
        );
        // !flag || n_1 >= d_1 second time
        // n_1 == carry second time
        test(
            &[10; 2],
            &[0, 0, 1, 0, 1],
            &[0, 1, 2147483648],
            false,
            &[4294967295, 1],
        );
        // carry second time
        test(
            &[10; 2],
            &[0, 0, 0, 0, 1],
            &[1, 0, 2147483648],
            false,
            &[4294967295, 1],
        );
        // *ns_last < carry
        // n_1 != 0 first time
        // highest_q second time
        // !carry third time
        test(
            &[10; 20],
            &[
                4294966784, 16383, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4278190080, 4294967295,
                4294967295, 4294967295, 4095, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4294967292,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 1048575, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 4294967040, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
            ],
            &[
                4294967295, 4294967295, 4294967295, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4026531840,
                16383, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4294963200, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4095, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 4294967280, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 2540339372,
            ],
            true,
            &[
                2788498651, 3973284986, 2817551825, 2648982666, 1871496085, 1183691368, 1920086634,
                2156916676, 2580901671, 858626385, 3833802894, 4255330726, 3612427555, 2966560147,
                10, 10, 10, 10, 10, 10,
            ],
        );
        // carry third time
        // n_1 != 0 second time
        test(
            &[10; 8],
            &[
                0, 0, 4294967295, 4294967295, 4294967295, 4294967295, 511, 0, 0, 0, 0, 0, 0, 0,
                4286578688, 4294967295, 4294967295, 4294967295, 63, 0, 0, 0, 0, 4294966784,
                4294967295, 255, 4292870144, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295,
            ],
            &[
                4294967295, 31, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4294963200, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 2874223232,
            ],
            true,
            &[
                3459164144, 2642691284, 1062969477, 1392962372, 1677352416, 1850494842, 2123025524,
                10,
            ],
        );
        // !flag || n_1 >= d_1 first time
        // n_1 == carry first time
        test(
            &[10; 10],
            &[
                0, 0, 0, 0, 0, 4294967288, 4294967295, 1048575, 0, 0, 4294901760, 4294967295,
                2097151, 0, 0, 0, 0, 4294959104, 4294967295, 4294967295, 4294967295, 4294967295,
            ],
            &[
                4160749568, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 8388607, 0,
                0, 0, 0, 4294967295, 3500471700,
            ],
            true,
            &[
                1188137339, 3726116623, 2078060623, 4294967295, 2498443049, 1067076977, 2528078370,
                1716103827, 974820792, 10,
            ],
        );
        // n_1 == 0 first time
        test(
            &[10; 20],
            &[
                0, 4294967292, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                2147483647, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4294967232, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 16777215,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4294966784, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295,
            ],
            &[
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4294967040, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                134217727, 0, 0, 0, 0, 0, 0, 0, 0, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 3828608089,
            ],
            true,
            &[
                2643432265, 2230909280, 3987412564, 1770201633, 2297365160, 1655451772, 3061719465,
                182613124, 3034480808, 3038313569, 3464266718, 249914758, 4270196816, 4141866692,
                91710029, 4264403435, 2579237268, 67618125, 523165989, 10,
            ],
        );
        // n_1 != carry first time
        // flag && n_1 < carry first time
        test(
            &[10; 73],
            &[
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4294966784, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                32767, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 4294967232, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 1023, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4026531840,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 1048575, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4294967294, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
            ],
            &[
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 4294836224, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4024661822,
            ],
            true,
            &[
                201450768, 518871072, 3015445987, 3944509552, 208835829, 3460787832, 1884898895,
                2547198435, 186469778, 3505271765, 1840399470, 2685063887, 2953363253, 1530364228,
                3130405732, 893752596, 3868726834, 4151054974, 2514125465, 3161927869, 2354681787,
                1962216954, 2851892627, 2800023632, 4197573593, 3243049600, 922941226, 2202547330,
                3061793011, 1583790204, 3045500683, 440439528, 2631483812, 1993907261, 2362030668,
                4006507490, 4294967294, 2180774078, 372389172, 842953352, 3854387892, 1420082779,
                4086327226, 1481011735, 2795106458, 2092419963, 1299755146, 3455955436, 2935373316,
                2973368959, 208681747, 1883779895, 599992803, 1583705426, 4184839928, 352155351,
                1499776059, 3341886577, 2973508834, 452082451, 98512703, 1051917695, 3372026069,
                2092419965, 1233174284, 2711177091, 1249466612, 3854527767, 1663483483, 2301060034,
                1932936627, 288459805, 10,
            ],
        );
        // carry first time
        test(
            &[10; 45],
            &[
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967279, 4294967295, 4294967295, 0, 4294966272, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 1, 0, 0, 0, 0, 0, 0, 0, 4294959104,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 1048575, 0, 0, 0, 0, 4294967040, 4294967295, 4294967295, 4294967295,
            ],
            &[
                4294901760, 4294967295, 16383, 3221225472, 4294967295, 4294967295, 2953571387,
            ],
            true,
            &[
                1344119085, 4210855069, 928035132, 841350331, 528284037, 1219359454, 3548354897,
                1057752790, 3847832303, 1950615424, 782270048, 1691663352, 2130612726, 2986797999,
                2134900501, 367200458, 366133304, 4140157070, 1119890783, 2133610345, 309344350,
                1553079209, 39974261, 4150943609, 1565848679, 3244273595, 2309629507, 3647061699,
                1476447016, 2423314465, 988904489, 3076842837, 370106892, 2669774090, 81048948,
                2207992586, 4294967295, 2794855737, 2919419242, 2509602689, 685991398, 3934508174,
                2079332445, 1950605148, 10,
            ],
        );
        // n_1 != carry second time
        // flag && n_1 < carry second time
        test(
            &[10; 10],
            &[
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                32767, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4278190080, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 1048575, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4294836224, 4294967295, 4294967295,
                4294967295, 4294967295,
            ],
            &[
                0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                0, 4294967264, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 4294967295,
                4294967295, 4294967295, 4294967295, 4294967295, 4294967295, 3833725436,
            ],
            true,
            &[
                4294967294, 150659924, 1536731131, 3027101341, 827397342, 835599031, 2855838328,
                1016945560, 516734631, 10,
            ],
        );
    }
    #[cfg(not(feature = "32_bit_limbs"))]
    {
        // !limbs_sub_limb_in_place(
        //      ns_hi,
        //      limbs_sub_mul_limb_same_length_in_place_left(ns_lo, qs, ds[i])) fourth time
        test(
            &[10],
            &[0, 0, 1, 1],
            &[0, 1, 9223372036854775808],
            false,
            &[2],
        );
    }
}

#[test]
#[should_panic]
fn limbs_div_schoolbook_fail_1() {
    let ds = &[3, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_schoolbook(&mut [10], &mut [1, 2, 3], ds, inverse);
}

#[test]
#[should_panic]
fn limbs_div_schoolbook_fail_2() {
    let ds = &[3, 4, 5, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_schoolbook(&mut [10], &mut [1, 2, 3], ds, inverse);
}

#[test]
#[should_panic]
fn limbs_div_schoolbook_fail_3() {
    let ds = &[3, 4, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_schoolbook(&mut [10], &mut [1, 2, 3, 4, 5], ds, inverse);
}

#[test]
#[should_panic]
fn limbs_div_schoolbook_fail_4() {
    let ds = &[3, 4, 5];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_schoolbook(&mut [10], &mut [1, 2, 3], ds, inverse);
}

#[cfg(feature = "32_bit_limbs")]
#[test]
fn test_limbs_div_divide_and_conquer() {
    let test = |qs_in: &[Limb], ns_in: &[Limb], ds: &[Limb], q_highest, qs_out: &[Limb]| {
        let mut qs = qs_in.to_vec();
        let mut ns = ns_in.to_vec();
        let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
        assert_eq!(
            _limbs_div_divide_and_conquer(&mut qs, &mut ns, ds, inverse),
            q_highest
        );
        assert_eq!(qs, qs_out);
        verify_limbs_div(qs_in, ns_in, ds, q_highest, &qs);
    };
    {
        // *scratch_2_head != 0
        test(
            &[10; 4],
            &[1, 2, 3, 4, 5, 6, 7, 8, 9],
            &[3, 4, 5, 6, 7, 0x8000_0000],
            false,
            &[4294967057, 15, 18, 10],
        );
        // *scratch_2_head == 0
        // !(highest_q &&
        //      limbs_slice_add_same_length_in_place_left(&mut scratch_init[q_len..], ds)
        //      || limbs_cmp_same_length(scratch_init, ns) == Ordering::Greater)
        test(
            &[10; 3],
            &[0; 9],
            &[0, 0, 0, 0, 0, 2147483648],
            false,
            &[0, 0, 0],
        );
        test(
            &[10; 3],
            &[0, 0, 0, 0, 0, 0, 0, 0, 1],
            &[0, 0, 0, 0, 0, 2147483648],
            false,
            &[0, 0, 2],
        );
        // highest_q &&
        //      limbs_slice_add_same_length_in_place_left(&mut scratch_init[q_len..], ds)
        //      || limbs_cmp_same_length(scratch_init, ns) == Ordering::Greater
        test(
            &[10; 3],
            &[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
            &[0, 0, 0, 1, 0, 0, 0, 2147483648],
            false,
            &[1, 0, 0],
        );
    }
}

#[test]
#[should_panic]
fn limbs_div_divide_and_conquer_fail_1() {
    let ds = &[3, 4, 5, 6, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_divide_and_conquer(&mut [10; 4], &mut [1, 2, 3, 4, 5, 6, 7, 8, 9], ds, inverse);
}

#[test]
#[should_panic]
fn limbs_div_divide_and_conquer_fail_2() {
    let ds = &[3, 4, 5, 6, 7, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_divide_and_conquer(&mut [10; 4], &mut [1, 2, 3, 4, 5, 6, 7, 8], ds, inverse);
}

#[test]
#[should_panic]
fn limbs_div_divide_and_conquer_fail_3() {
    let ds = &[3, 4, 5, 6, 7, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_divide_and_conquer(&mut [10, 10], &mut [1, 2, 3, 4, 5, 6, 7, 8, 9], ds, inverse);
}

#[test]
#[should_panic]
fn limbs_div_divide_and_conquer_fail_4() {
    let ds = &[3, 4, 5, 6, 7, 8];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_divide_and_conquer(&mut [10; 4], &mut [1, 2, 3, 4, 5, 6, 7, 8, 9], ds, inverse);
}

fn verify_limbs_div_approx(
    qs_in: &[Limb],
    ns_in: &[Limb],
    ds: &[Limb],
    q_highest: bool,
    qs_out: &[Limb],
) {
    let n = Natural::from_limbs_asc(ns_in);
    let d = Natural::from_limbs_asc(ds);
    let (expected_q, expected_r) = (&n).div_mod(&d);
    let base_q_len = ns_in.len() - ds.len();
    let mut qs = qs_out[..base_q_len].to_vec();
    if q_highest {
        qs.push(1);
    }
    let q = Natural::from_owned_limbs_asc(qs);
    let q_is_one_too_large = q != expected_q;
    if q_is_one_too_large {
        assert_eq!(q, expected_q + 1 as Limb);
        assert_eq!((q - 1 as Limb) * &d + expected_r, n);
    } else {
        assert_eq!(q * &d + expected_r, n);
    }
    assert_eq!(&qs_in[base_q_len..], &qs_out[base_q_len..]);
}

#[test]
fn test_limbs_div_schoolbook_approx() {
    let test = |qs_in: &[Limb],
                ns_in: &[Limb],
                ds: &[Limb],
                q_highest,
                qs_out: &[Limb],
                ns_out: &[Limb]| {
        let mut qs = qs_in.to_vec();
        let mut ns = ns_in.to_vec();
        let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
        assert_eq!(
            _limbs_div_schoolbook_approx(&mut qs, &mut ns, ds, inverse),
            q_highest
        );
        assert_eq!(qs, qs_out);
        assert_eq!(ns, ns_out);
        verify_limbs_div_approx(qs_in, ns_in, ds, q_highest, &qs);
    };
    #[cfg(feature = "32_bit_limbs")]
    {
        // q_len + 1 < d_len
        // !highest_q
        test(
            &[10],
            &[1, 2, 3],
            &[3, 4, 0x8000_0000],
            false,
            &[10],
            &[1, 2, 3],
        );
        // !(!flag || n_1 >= d_1) second time
        test(&[0], &[0; 4], &[0, 0, 2147483648], false, &[0], &[0; 4]);
        // q_len + 1 >= d_len
        // !(!flag || n_1 >= d_1) first time
        // !carry second time
        test(
            &[0, 0],
            &[0; 5],
            &[0, 0, 2147483648],
            false,
            &[0, 0],
            &[0; 5],
        );
        // highest_q
        test(
            &[
                2694350779, 1945458005, 4130424186, 4267238024, 2588565427, 561074857, 3031728663,
                2495857464, 1122008234, 2280094424,
            ],
            &[
                2460989955, 642673607, 1971681331, 2338977519, 475442971, 2516527409, 3470931196,
                4262052990,
            ],
            &[
                1430162564, 1873089879, 3090281851, 2861182896, 2502166555, 2486624904, 960387080,
                3073064701,
            ],
            true,
            &[
                2694350779, 1945458005, 4130424186, 4267238024, 2588565427, 561074857, 3031728663,
                2495857464, 1122008234, 2280094424,
            ],
            &[
                2460989955, 642673607, 1971681331, 2338977519, 475442971, 2516527409, 3470931196,
                1188988289,
            ],
        );
        // !(n_1 == d_1 && ns[j] == d_0)
        // !carry first time
        test(
            &[
                2678906106, 1133029551, 3498992572, 3960506675, 2156562886, 2180928089, 4027866586,
                3363079195, 2699625088, 10633112, 1776348429, 2657266039, 366882369, 3755249663,
                1513004482, 385462618, 1235118123,
            ],
            &[
                1454965277, 156018042, 1386304234, 3933017003, 1840527397, 4169420651, 3343338814,
                1487329926, 3897306601, 3401241545, 3117994664, 2264466925, 3843062712, 3688462745,
                2751679318, 2963108470, 1519717633, 1232770303,
            ],
            &[
                3907037329, 1526550202, 2796269294, 2117183522, 529127946, 3581684574,
            ],
            false,
            &[
                804693922, 2514269410, 4036020089, 2186548072, 2508423987, 4057814367, 1906755998,
                3240890878, 892733317, 778428899, 2723150360, 1478273149, 366882369, 3755249663,
                1513004482, 385462618, 1235118123,
            ],
            &[
                1454965277, 156018042, 1386304234, 3933017003, 3311017948, 2590855881, 4216998583,
                2363684544, 3240958306, 2015516746, 4229646813, 3042340787, 3637479002, 2452334854,
                2707761200, 1588607308, 1519717633, 1232770303,
            ],
        );
        // n_1 == d_1 && ns[j] == d_0
        // !flag || n_1 >= d_1 first time
        // n_1 == carry
        test(
            &[10, 10, 10, 10],
            &[0, 0, 0, 1, 4, 0x8000_0000],
            &[3, 4, 0x8000_0000],
            false,
            &[4294967292, 4294967295, 4294967295, 10],
            &[0, 19, 0, 2147483646, 2147483648, 2147483648],
        );
        // carry first time
        test(
            &[10, 10, 10, 10, 10],
            &[0, 0, 0, 0, 0, 3],
            &[3, 0, 0x8000_0000],
            false,
            &[4294967295, 4294967295, 5, 10, 10],
            &[0, 3, 2147483630, 4294967295, 0, 3],
        );
        // !flag || n_1 >= d_1 second time
        // !(flag && n_1 < carry)
        test(
            &[10, 10, 10, 10],
            &[0, 0, 0, 3, 0xffff_ffff, 0x8000_0000],
            &[3, 4, 0xffff_ffff, 0x8000_0000],
            false,
            &[4294967295, 4294967295, 10, 10],
            &[0, 0, 3, 2147483648, 2147483648, 2147483648],
        );
        // carry second time
        test(
            &[10; 4],
            &[0, 0, 0, 0, 0, 0, 1, 0],
            &[0, 1, 0, 2147483648],
            false,
            &[4294967295, 4294967295, 1, 0],
            &[0, 0, 1, 2147483646, 4294967295, 0, 1, 0],
        );
    }
    #[cfg(not(feature = "32_bit_limbs"))]
    {
        test(
            &[
                13716243670146164789,
                10080982542333195561,
                6537250227633874413,
                12999253343990893001,
                12265098574469062516,
                10364481473864190262,
                3369535821171388227,
                10993808308731343874,
                2872517547503231658,
                12291082106617508077,
                9131160905399738920,
                6775211851169928012,
                8910327134129798117,
                14142305268873431891,
                7124925848807234985,
                2155988926103471984,
                10449767567966035946,
                9346026815749340730,
                1047855496984265723,
                8616868492917905090,
                6520418679719901901,
                7627787833874912128,
                16237358816885147630,
                18338579662632174061,
                13533819409691495819,
                8877538849543441757,
                1515670908092000385,
                11038667469728451796,
                1811062388681013211,
            ],
            &[
                9995257893114397114,
                9401504468144459131,
                558615837638945228,
                10733662027974786928,
                18295107704289976677,
                1814706268673753787,
                12474943759854623335,
                8814778832826774208,
                9159057654048965906,
                4451260977376821357,
                18241701617364042056,
                6169989192350218482,
                15071965537117101028,
                13509168527678537782,
                12224278653171635329,
                16077066393714953826,
                1433938684868066489,
                13014970036232570373,
                899282336249563956,
                3089487642230339536,
                3787737519477527148,
                16667686214395942740,
                8787122953224574943,
                7841835218775877827,
                9693303502025838409,
                16122224776459879427,
                144327425397945219,
            ],
            &[
                2350654041004706911,
                7834348511584604247,
                12756796070221345724,
                3842923787777653903,
                12373799197090248752,
                9712029403347085570,
                1426676505264168302,
                10586232903332693517,
                8387833601131974459,
                6290888746273553243,
                9503969704425173615,
            ],
            false,
            &[
                89235393247566392,
                5198286616477507104,
                15671556528191444298,
                6642842185819876016,
                1703950202232719208,
                6620591674460885314,
                9897211438557358662,
                12382449603707212210,
                13586842887558233290,
                11884313943008627054,
                3205830138969300059,
                4257812936318957065,
                11084100237971796628,
                13937343901544333624,
                11743372027422931451,
                280132530083052382,
                10449767567966035946,
                9346026815749340730,
                1047855496984265723,
                8616868492917905090,
                6520418679719901901,
                7627787833874912128,
                16237358816885147630,
                18338579662632174061,
                13533819409691495819,
                8877538849543441757,
                1515670908092000385,
                11038667469728451796,
                1811062388681013211,
            ],
            &[
                9995257893114397114,
                9401504468144459131,
                558615837638945228,
                10733662027974786928,
                18295107704289976677,
                1814706268673753787,
                12474943759854623335,
                8814778832826774208,
                9159057654048965906,
                10156380351246372681,
                9009005527785483288,
                4330767427200269309,
                11409205475757922767,
                12430752173702915207,
                11990819624778098799,
                4145020291153594556,
                7099200056207569977,
                3510167930325480168,
                4731667122118327121,
                10720310942075546738,
                5799804483118787221,
                17268037247251138479,
                13305947798457087249,
                1405091439325174594,
                13072181651983436371,
                16122224776459879427,
                144327425397945219,
            ],
        );
    }
}

#[test]
#[should_panic]
fn limbs_div_schoolbook_approx_fail_1() {
    let ds = &[3, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_schoolbook_approx(&mut [10], &mut [1, 2, 3], ds, inverse);
}

#[test]
#[should_panic]
fn limbs_div_schoolbook_approx_fail_2() {
    let ds = &[3, 4, 5, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_schoolbook_approx(&mut [10], &mut [1, 2, 3], ds, inverse);
}

#[test]
#[should_panic]
fn limbs_div_schoolbook_approx_fail_3() {
    let ds = &[3, 4, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_schoolbook_approx(&mut [10], &mut [1, 2, 3, 4, 5], ds, inverse);
}

#[test]
#[should_panic]
fn limbs_div_schoolbook_approx_fail_4() {
    let ds = &[3, 4, 5];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_schoolbook_approx(&mut [10], &mut [1, 2, 3], ds, inverse);
}

#[test]
fn test_limbs_div_divide_and_conquer_approx() {
    let test = |qs_in: &[Limb], ns_in: &[Limb], ds: &[Limb], q_highest, qs_out: &[Limb]| {
        let mut qs = qs_in.to_vec();
        let mut ns = ns_in.to_vec();
        let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
        assert_eq!(
            _limbs_div_divide_and_conquer_approx(&mut qs, &mut ns, ds, inverse),
            q_highest
        );
        assert_eq!(qs, qs_out);
        verify_limbs_div_approx(qs_in, ns_in, ds, q_highest, &qs);
    };
    #[cfg(feature = "32_bit_limbs")]
    {
        // q_len < d_len
        // q_len < DC_DIVAPPR_Q_THRESHOLD
        test(
            &[10; 4],
            &[1, 2, 3, 4, 5, 6, 7, 8, 9],
            &[3, 4, 5, 6, 7, 0x8000_0000],
            false,
            &[4294967057, 15, 18, 10],
        );
        // q_len >= d_len
        // q_len_mod_d_len != 1
        // q_len_mod_d_len == 2
        // q_len_mod_d_len != d_len
        // hi < DC_DIV_QR_THRESHOLD in _limbs_div_divide_and_conquer_approx_helper
        // carry != 0 in _limbs_div_divide_and_conquer_approx_helper
        // lo < DC_DIVAPPR_Q_THRESHOLD in _limbs_div_divide_and_conquer_approx_helper
        test(
            &[
                1745715367, 3242831492, 2189664406, 3695710048, 3400938664, 2983493477, 3450434346,
                3015863128, 3052023755, 2151651529, 1044116780, 1095733406, 3716653807, 297398212,
            ],
            &[
                3142115855, 4096457822, 1432901702, 1952216623, 2397263357, 1868450777, 1021098076,
                367053436, 1889683424, 1528567953, 3087804116, 689228227, 2409781986, 2752631639,
                2960393344, 2301774469, 4157044152, 730723095, 338324989, 783259147, 1430926216,
                364208092, 2781791540, 805329298, 3841626209, 3970169746, 287294352,
            ],
            &[
                1650097037, 2785533476, 2062924184, 1202017958, 802671467, 2646041574, 1723210259,
                3842076078, 3483645026, 3596926305, 1708140396, 44589295, 3278888837,
            ],
            false,
            &[
                3307700692, 2732374665, 3119369275, 1963618313, 3967275780, 1010403672, 2386237047,
                1636315044, 2452324979, 2121986305, 4198504803, 1202996215, 3246857339, 376322562,
            ],
        );
        // 2 < q_len_mod_d_len < DC_DIV_QR_THRESHOLD
        test(
            &[
                2955158159, 1759170654, 241992668, 2980193182, 840605220, 1045835548, 3208341497,
                2808694346, 3017377112, 355832894, 950019940, 696314608, 1276063535, 1858415265,
                60277520, 2139543466,
            ],
            &[
                3731075771, 2226257702, 854739192, 2333168376, 3831123162, 672459584, 2105255949,
                3941486408, 3063931623, 3785513419, 2454733900, 2814451407, 149252521, 3850018836,
                2493517320, 445200997, 3777868852, 753763226, 4021231089, 1034604267, 2132847427,
                3137530222,
            ],
            &[
                270591029, 2232658820, 2961791111, 2169611462, 3306811456, 395960943, 1347788049,
                792089960, 2698153968, 3485969429,
            ],
            false,
            &[
                1488408081, 248978519, 2376028816, 407178103, 178475908, 1057954502, 1272791110,
                1537402746, 43900650, 1842311580, 1675506505, 3865664908, 1276063535, 1858415265,
                60277520, 2139543466,
            ],
        );
        // carry != 0
        test(
            &[
                3168925666, 1401331420, 1768122255, 956650685, 3125577762, 275145267, 4000912215,
                2182857050, 353954436, 2524534987, 1528525099, 1007392140, 2880118216, 2063897965,
                1760572146, 1006590899,
            ],
            &[
                3431345542, 1730498888, 4138696524, 681428010, 2575604395, 915393966, 2674130562,
                2622706300, 1008959988, 202234291, 1715673957, 4288131207, 3157817283, 1254299717,
                1844271939, 2429564694, 1102891971, 4218541309, 2925340256, 2466247404, 3527404620,
                1380334293, 3436079542, 200877067, 3607253971,
            ],
            &[
                878527761, 3297204326, 2726502278, 1631019758, 1065904878, 1800983432, 346615437,
                143744864, 473085159, 3630485760,
            ],
            false,
            &[
                181883802, 1500895548, 839791393, 3438225757, 1702652997, 2997889672, 398115167,
                3761202175, 3544971480, 1688702060, 207943299, 1616875104, 3637603520, 3111391940,
                4267483432, 1006590899,
            ],
        );
        // highest_q second time
        test(
            &[
                2437003791, 645401979, 1378969963, 3859694962, 1591396376, 1173467855, 1717394161,
                2958783214, 3972116836, 3930714191,
            ],
            &[
                844935929, 1399477695, 2543116912, 837902568, 1404832613, 3601679936, 681919524,
                1510676120, 4054159774, 3802723255, 3285008709, 2781902552, 2079211469, 3135384488,
                3124225549,
            ],
            &[
                4097164548, 2480021577, 1254500038, 3382139236, 615831817, 2805966013, 2977211920,
            ],
            true,
            &[
                3611312107, 839029826, 3955154288, 3446643589, 690412234, 2545148908, 2572472581,
                212083904, 3972116836, 3930714191,
            ],
        );
        // q_len_mod_d_len == 1
        // !(n_2 == d_1 && n_1 == d_0)
        test(
            &[
                4235270104, 498278423, 1233560634, 4293074805, 853780813, 1015040797, 3070872633,
                2324941085, 3436613312, 2914604270, 3125537558, 1989275393, 2102765265,
            ],
            &[
                2411131391, 1285978457, 4193249971, 1729912476, 3951338248, 4289840260, 894016416,
                2906952374, 3455712241, 1463845617, 1727541890, 1481030343, 1658748062, 1143697602,
                3292965673, 2291275076, 3088692422, 2745736668, 4049914342, 1746048268, 398577563,
                1528894241,
            ],
            &[
                2173999991, 2272873400, 2390524858, 1701140046, 320303811, 2196647430, 90814602,
                3168314224, 2071538040, 267268559, 2660563785,
            ],
            false,
            &[
                3525126782, 1512399222, 2720117630, 206486370, 3387391711, 3483623607, 1368424417,
                1794379685, 2200464811, 3921564486, 2468104993, 1989275393, 2102765265,
            ],
        );
        // q_len >= d_len
        test(
            &[
                2046213120, 118064180, 676462636, 192405947, 987595058, 3117257430, 2648701979,
                3334098139, 2300211432, 238540576, 1839171291, 3761260665, 1016976338, 464138847,
                2985769256, 4173218084, 198170535, 2181413355,
            ],
            &[
                3268984709, 3890178895, 3714425009, 922229459, 124979838, 1582051975, 1533234197,
                1439049575, 1664144928, 3333243233, 508818207, 1681704030, 573822729, 1791263995,
                978387652, 2703189437, 2825974585, 854916987, 2566023663, 1086830792, 2353550490,
                2091798094, 2573588469, 1760161870,
            ],
            &[
                4063752152, 180981500, 1829379233, 4014641527, 2812579451, 2652403028, 1486280954,
                2616093248,
            ],
            false,
            &[
                918482979, 147806120, 3245881243, 1658946288, 1766790068, 1379341579, 3971780904,
                1671161699, 2162749536, 1257881574, 3103952931, 1923216828, 1012333274, 3304761773,
                243084170, 2889743198, 198170535, 2181413355,
            ],
        );
        // highest_q first time
        test(
            &[
                2272242430, 2854406627, 1305900137, 1975858742, 4025222745, 212032770, 698550929,
                632227880, 3284689006, 780673660, 395497962, 765997120, 2856842543, 2158993022,
                20701243, 2016479159, 934398704, 1923839427,
            ],
            &[
                2079043963, 3911491338, 447442849, 3956113252, 1222080016, 639120617, 2598755724,
                1080730341, 102550561, 3677835688, 4245198487, 1565695097, 2098176177, 3974320562,
                1241514653, 856068310, 4158641647, 2053124989, 4149048308, 3508898669, 1748966969,
                1026687354, 3392457811, 3901741824, 3279053517, 763547094, 1818065987, 2992419410,
                2814961974, 3367454332, 1015324186, 3391900712,
            ],
            &[
                2456150337, 1126994408, 3067336229, 1544722288, 1285201687, 384279509, 1392445337,
                548923399, 2471923537, 3222966094, 168537260, 3352071531, 2060967172, 2867808805,
                1744855395, 2564913121,
            ],
            true,
            &[
                902145632, 1230897285, 1461544881, 3921469470, 3447138679, 4291295264, 3805913658,
                2179953362, 3669599647, 3982542142, 3582166894, 852760370, 3665299175, 3877964992,
                3092149152, 1384797257, 934398704, 1923839427,
            ],
        );
        // q_len_mod_d_len >= DC_DIV_QR_THRESHOLD
        // hi < DC_DIV_QR_THRESHOLD in _limbs_div_divide_and_conquer_approx_helper
        test(
            &[
                2108009976, 2838126990, 827008974, 4157613011, 3782799311, 839921672, 879731301,
                1926496935, 3712149888, 2363043408, 3863476261, 1703718215, 499165670, 2993223230,
                4279694017, 2976095205, 2193242813, 3593708162, 586354096, 296757650, 242624274,
                199363552, 2802933005, 2759687879, 3925865458, 4217980786, 621040829, 4008464542,
                3795907109, 270168250, 3625538473, 759155103, 3959828159, 1835721901, 1818377089,
                114690984, 2967220963, 2377698568, 2241245638, 2252300906, 3116551983, 3644576818,
                2608501946, 2181270779, 1815210824, 1268283136, 484429506, 1180516809, 559610343,
                2543044915, 3719740023, 558939794, 3989231279, 1089033996, 3509826828, 3545449066,
                3353643945, 2822587915, 2300900020, 309191900, 2371088678, 1169317833, 2688462322,
                704882387, 1429447898, 2514029776, 1955158460, 3862686818, 1584130288, 482000750,
                4224830364, 2104097699, 1183456674, 2270729014, 2607655660, 2966545947, 2931252595,
                759652385, 3970839358, 2487392344, 1507124762, 758697388, 3840603988, 1293583672,
                252424514, 646352064, 1756992845, 2309291248, 3392597937, 2946557682, 3659552460,
                1720311830, 3395887210, 2674135679, 3196424053, 2895118562, 1256983146, 2482795730,
                1922474903, 2105232035, 3692384401, 2891711374, 3496171341, 515080177, 4073860792,
                2051799135, 2279442367, 3258846627, 70977295, 1937954703, 2800340027, 1760719187,
                646417623, 3158839049, 3176203007, 213391749, 869819866, 3906922929, 1586646665,
                1614123406, 3687984980, 1177302158, 272342927, 1441818617, 2083855650, 1541781406,
                3311904586, 106907162, 4108429222, 662974012, 4140594255, 1984524179, 3259771450,
                3863443649, 3307256449, 3597197635, 3771753969, 3551628070, 3550518548, 2546464879,
                3812123817, 2299164636, 2258249267, 815945886, 3725185601, 738801212, 3862546442,
                207778311, 1535617953, 2150997157, 729581295, 143725958, 1410055499, 4204574368,
                2185442793, 3653861199, 1767186378, 3537808267, 1766021033, 2239408696, 1986025224,
                3625288948, 4046347844, 2490523057, 3491861717, 1312039469, 597857291, 206880668,
                1812928615, 3684502664, 3820772609, 1327777451, 1237379465, 764273090, 3594853086,
                2859643842, 1243019386, 3444655918, 1596721727, 2221238575, 2483346164, 2064518283,
                2282844430, 1960424205, 4028198846, 2342293800, 1645322170, 3508868511, 2376856302,
                1764497492, 2461899059, 3430260828, 1083983032, 1448541077, 2081767380, 1131293272,
                2121152826, 4212689224, 2039367869, 2193844060, 1864700761, 1182989130, 1481869846,
                969270162, 3997775597, 1483663077, 394034269, 1586435653, 2281434261, 1937512315,
                836935557, 59742568, 1854699653, 2116629465, 328821302, 1999851100, 604863759,
                556389113, 2057620108, 1992554416, 427465103, 813735424, 487055225, 402647361,
                3006998394, 2146302389, 2308517156, 1063328348, 2382344201, 2665908320, 481118926,
                2376219143, 1164055989, 128362737, 2711666601, 1898018298, 2928344090, 3862251511,
                749517272, 2790599579, 3506539103, 2592038317, 1682088920, 1332639030, 3053921374,
                3066891587, 242466377, 3536065834, 2016487096, 1321862427, 2409873623, 3088797737,
                2840818323, 2052021858, 4079299898, 452968540, 3880575723, 2680668784, 1502544423,
                1619882634, 1068420458, 3236073318, 1740351058, 1183565882, 2761799103, 246817911,
                2967032269, 4003972840, 969974269, 3193561842, 1002645557, 2347161653, 4272895273,
                1522072178, 972383725, 3026624523, 434293193, 2855690795, 2455822196, 2413168892,
                2999634230, 784531194, 249556803, 2559695464, 3131798530, 668810109, 2114036394,
                2861740558, 370716909, 2126014070, 3913884200, 1577476936, 855642956, 2074597201,
                3461659621, 3292762038, 2153122643, 1658901071, 1562860969, 501980289, 1611843440,
                2433026108, 3791871978,
            ],
            &[
                2325147333, 1406197332, 1502532645, 137754493, 1488912421, 1014222449, 1678300831,
                2078887154, 2311629707, 3855402290, 1904906031, 1350026944, 314061674, 919972212,
                1429252796, 544807358, 2607111216, 3001219316, 160533550, 2875169678, 1402474615,
                3234840532, 1662112023, 1943050521, 4132256985, 2915369430, 699620367, 59590583,
                2461837586, 3986106860, 2659659366, 3589796255, 4168995860, 2337625655, 4292546333,
                1793085295, 2647770730, 2871508164, 2660729400, 3630964395, 3874212033, 1240042620,
                1713051992, 2105061240, 968807145, 3026819276, 2442427316, 2718248469, 2572140009,
                1793916894, 2112926236, 1058005225, 1528978151, 98430379, 3348888463, 2121431457,
                3545708238, 3975070402, 764453596, 192861224, 2698588322, 1493819664, 2502294971,
                3139295505, 1318649192, 1552623529, 2989328476, 1592829691, 1175278450, 182489613,
                1858350437, 2440903999, 1622786339, 162763913, 4106583944, 609833788, 1344925844,
                3910333895, 1369398307, 51929280, 2214052160, 78601532, 642016948, 3966440550,
                4161875340, 3764174238, 2944905670, 832634369, 2082700552, 3444794582, 962611192,
                38510846, 2733538376, 2141542785, 621670923, 3130866640, 1666281368, 3628581169,
                3965100367, 2889091703, 762371524, 3752935086, 656901001, 2374421435, 3084212494,
                1186140919, 3420046356, 775236355, 1337865306, 2051118555, 713071112, 1946850844,
                1427068060, 3949026319, 3075128554, 438166063, 3975561046, 858907746, 26964870,
                3843362808, 1461820702, 3090970200, 1037540471, 289966660, 2768763862, 50890120,
                580189324, 2911422550, 3684738914, 2025034397, 414622319, 2287243961, 3268939669,
                3547523099, 4011963324, 1768695320, 1859343614, 2123856143, 4141054481, 765801396,
                359993985, 3668605792, 3613648266, 1778728280, 2547397231, 2456061149, 2562918666,
                2903450513, 1994190773, 99234624, 3722083920, 4262323306, 202219441, 4201857695,
                3988878636, 1533308334, 401400520, 1069756554, 2457773969, 2892388936, 3423117995,
                1944069442, 492036629, 3426800580, 2282483359, 4006366620, 1695364515, 2555180845,
                1669287836, 349290429, 778467450, 2020203604, 2218159817, 1450404019, 1278304750,
                2412695340, 1592154884, 3868182043, 2240370481, 3859902860, 1008825116, 412233394,
                2475457637, 3664379433, 4204584226, 2750684469, 4113507475, 2916584959, 285955744,
                739598569, 18278051, 3768126932, 2181905109, 2612988076, 1827656088, 1160380415,
                4160443718, 1846086671, 3050604645, 2547108010, 2828666778, 3252702258, 3885923576,
                2331974758, 730724707, 1528859315, 4288784328, 3677151116, 445199233, 3304488688,
                3566979465, 3541025426, 2491779846, 3112990742, 2583249486, 3403111749, 1930721237,
                3428792463, 2896462048, 2985885576, 1819460734, 21206096, 3560441846, 987100555,
                2844904275, 84854892, 1268249628, 3963306788, 3338670067, 2504599089, 65588657,
                321493327, 4249673617, 4150876068, 721566898, 2186945060, 922948272, 1502464627,
                1426914435, 2906888275, 3454987739, 2609132626, 2073366782, 1058809001, 1226951003,
                2624503637, 282722778, 1407178266, 3304346308, 3613017687, 2397594777, 161128076,
                1938083248, 3042822216, 3958145306, 1431161184, 4147630074, 1744618540, 3729847703,
                2366216428, 2101731625, 2812677939, 3587016062, 1626785569, 3117017254, 3720581461,
                4254564252, 2400911475, 750362271, 3062375802, 2182368701, 268751862, 2682134876,
                274793576, 2417658182, 2321240923, 4200603818, 1349142841, 4066976957, 1043247680,
                679021323, 2933095037, 1621487581, 225868669, 1030678959, 1236344244, 972640788,
                1784301152, 578117349, 3509551550, 214420003, 3786992737, 802372148, 3562194086,
                2187046946, 3600373521, 4275090943, 2120016813, 4177241875, 3185774231, 2397692077,
                1015362399, 2178889151, 3433916223, 1688082118, 1971242178, 236388706, 3802829765,
                521309115, 2299816689, 3207614143, 1053195464, 3584561145, 1178690670, 2940812254,
                3321982035, 2754825123, 3073598062, 202404806, 547895545, 1188944547, 1056841779,
                529463805, 204665384, 850370055, 2063320161, 3724100092, 1180272690, 1398467003,
                2814052449, 1311768018, 659771105, 3226477227, 4230080238, 2134344405, 1461172705,
                2728018383, 1816821358, 3231137250, 2012377728, 2206916761, 3121807673, 3037967028,
                3653505029, 4164239058, 1337501466, 2487452346, 428839025, 3321493092, 2920064796,
                2750126813, 3635762100, 2659829309, 1992243088, 2359420187, 861816585, 4182313312,
                1389528266, 2890138969, 2195001695, 576635805, 1974585967, 851480113, 1896534852,
                3143828462, 4276040597, 3921135859, 2394233682, 2692972118, 2103941456, 3931376544,
                3790764632, 2278428793, 3381340311, 3516241824, 2923157557, 1276268033, 3471729699,
                2370137091, 2637023305, 4027814477, 3711009696, 3667995314, 459819000, 1002878772,
                2658190707, 1189561796, 1831813150, 2874008201,
            ],
            &[
                1703326352, 1625259628, 3642322228, 911402341, 2158835226, 939248485, 3607511108,
                2863853568, 1611642161, 1312857772, 1839433327, 567060478, 3139863681, 3642698184,
                3744632443, 712538472, 2692932947, 576185818, 156934113, 518107105, 2803035863,
                2284220097, 3447382922, 2400125006, 3565062840, 160044186, 3644393084, 4196433258,
                3391883838, 1115703759, 2380388002, 962895870, 4001772616, 2311278419, 2620271020,
                3047789793, 3229254302, 3182628087, 2718480927, 2872538422, 1963990826, 2856537226,
                1729736384, 372544200, 1482170753, 3370665422, 305555060, 4060802437, 1456459795,
                2848113958, 1036273297, 3245835346, 3355862097, 3242734427, 3313897419, 4230036415,
                1425594704, 2428756491, 420147714, 3218149930, 1791217142, 2881741659, 3231612869,
                845372829, 1635665046, 1525482197, 3779462557, 2279005731, 626908159, 2963734610,
                215448882, 2517668355, 3294128769, 1167990371, 2344651228, 2882002195, 3350056381,
                3749638142, 476010196, 2304276366, 1088082897, 1927672185, 3316329053, 1174989749,
                1101596429, 3054511229, 1685228241, 2301284206, 2526016461, 684171580, 3869889559,
                2606492401, 2114658735, 1419214215, 2779052449, 2594333668, 2225446358, 1211258458,
                4029343999, 2816277230, 4098142949, 1987363952, 2732004911, 2516355975, 2365350298,
                1747416524, 3951513077, 3526462790,
            ],
            false,
            &[
                1303670916, 3965736473, 654490008, 3337248200, 112312312, 2506678400, 713192736,
                901474194, 2359721047, 1133557120, 3068598661, 3136858413, 4095957211, 3057328754,
                1900588230, 1315930687, 3273808327, 2821746043, 4255148500, 3072995291, 1472014781,
                922081554, 1759317078, 149072645, 2712091402, 2134310281, 708105323, 3703209145,
                2071594694, 8111834, 3766831226, 2182956891, 2525476614, 1478202223, 4199311113,
                3813148212, 316780911, 1396844257, 2321402831, 1151134318, 848673799, 735789140,
                1092813310, 738412079, 1895091662, 2947844274, 31103395, 2559694049, 1194304023,
                3260126654, 1118043028, 1552558623, 3016599055, 1053142289, 446041643, 2615854004,
                2105823819, 3769707039, 2784177611, 9564629, 580911617, 1979035813, 1479556681,
                2599744262, 3097426153, 4195176293, 3497554127, 3484306250, 2114827319, 2314051712,
                1210812068, 4158781103, 478301760, 2027533091, 1682020897, 129914624, 2066167843,
                3989890251, 1378700448, 170057876, 3992582209, 1541347967, 3421610776, 697014638,
                2834243941, 3504973679, 630519426, 1551901326, 3092678418, 1136389639, 1806538485,
                2208151411, 1598302001, 4041410193, 3574334276, 2340664244, 1624426425, 1200740723,
                2912910258, 671197404, 2272603994, 909857936, 792804858, 3083891114, 3143045405,
                2389563439, 115312858, 1445242760, 2065820105, 256586994, 1432132569, 1549619424,
                2631865338, 1674212272, 2599765330, 3713129178, 1590556325, 3610491293, 709987753,
                3230113618, 1606099993, 3453954266, 3501213811, 3278809492, 3770342657, 1534951916,
                1366321311, 3149479124, 3987513652, 2108936446, 1162972378, 279205823, 3711325879,
                2278557694, 2305274058, 3709507652, 3805940202, 3778288085, 1061153771, 491180471,
                479623642, 2960728114, 553156023, 1863065855, 2253455830, 14222934, 2488687289,
                3378176628, 1136227234, 3805644784, 3175842224, 463501844, 2100687360, 2025076951,
                4064921772, 1000043802, 2482142143, 1463585061, 1044328896, 3966669663, 1023595412,
                2689537057, 685044345, 2599439954, 3302022962, 2669841238, 3358991646, 351579450,
                2303934592, 2098132645, 2239011851, 1623838039, 790570033, 2288992150, 2252675624,
                2479618080, 3624986625, 2129338944, 3796999988, 465518072, 620957443, 1836556967,
                2894771224, 2904933718, 287211723, 1386209013, 2288387719, 162551270, 370319691,
                2924564913, 2947669880, 3390862854, 1797811, 3097227838, 2245950593, 1664498395,
                3380635348, 3536484871, 1217287925, 3149066538, 154911037, 1960867817, 4238493382,
                1991791660, 509572665, 3386968719, 3880405816, 2335816696, 2519967410, 3482574698,
                1501302597, 2415671279, 715902305, 1920401004, 3735445496, 1792155851, 2110622431,
                3695395614, 3311496726, 4035668560, 187609524, 3743601469, 2990357125, 3084998227,
                767424914, 1388627321, 1381810466, 3799640235, 1423360242, 3375037167, 979951340,
                3463933333, 387599460, 229837304, 1394766077, 1068156038, 1135935924, 86516134,
                142150630, 448211640, 3205606056, 1420159909, 4203558153, 2816235778, 4188064475,
                1490981561, 2934083684, 2693435736, 1351552613, 962789901, 1071201732, 3244341475,
                1855681940, 4210620238, 2129345127, 2909949483, 3992748944, 3928807766, 2014533910,
                3099391001, 3112195816, 4009296318, 1247610431, 1474512546, 2530880557, 3597268331,
                764359883, 4198267775, 1228639730, 736768887, 396797847, 799410613, 582496441,
                2658423343, 1643853660, 1258585041, 3767032705, 3709454541, 892807168, 1443895160,
                3500326521, 784531194, 249556803, 2559695464, 3131798530, 668810109, 2114036394,
                2861740558, 370716909, 2126014070, 3913884200, 1577476936, 855642956, 2074597201,
                3461659621, 3292762038, 2153122643, 1658901071, 1562860969, 501980289, 1611843440,
                2433026108, 3791871978,
            ],
        );
        // q_len >= DC_DIVAPPR_Q_THRESHOLD
        test(
            &[
                1253234102, 1407423154, 1496099965, 1695523232, 4087895045, 3633064637, 1918073940,
                1994089224, 2894393019, 3803250781, 3557289532, 855915119, 825886212, 2854426287,
                3305239731, 1558916547, 14680883, 2283482810, 1975429241, 3696056256, 1225143894,
                401826166, 1805660989, 1715696159, 3407333066, 671337274, 3930782284, 615690969,
                1799309743, 3261619710, 2139755586, 1418298860, 1130149390, 2049944334, 3646689909,
                3742182516, 3450706114, 1620481751, 911179844, 2537827243, 1863349000, 2588289405,
                1379393302, 290595733, 3551967170, 597631845, 3116406696, 418522057, 3052889123,
                3602625940, 282818149, 870470676, 2360142740, 122311196, 1285732945, 3338688058,
                2358904627, 1717417860, 1010819896, 1162692117, 745279285, 2988897615, 3882583107,
                1500499444, 868916372, 1937848809, 1694462512, 3596830383, 3102959500, 2042575803,
                1732232437, 2619341801, 1399365095, 1742239855, 3363053286, 2955047192, 2536114731,
                797861027, 3390102223, 1284755330, 1346331125, 3841540834, 224493549, 3323242612,
                1489837409, 424629037, 2887418470, 2691856116, 51264601, 1998453260, 3606432589,
                270475934, 1351120072, 13779558, 1467138526, 1834087227, 4205762576, 1570218025,
                3941564310, 1908199096, 4049815285, 3522198110, 1100468986, 2461406603, 2479269826,
                536560408, 3804672262, 4126365829, 495636874, 1441896026, 1313080761, 3619143141,
                3430175499, 1671147767, 461789206, 1605289369, 3711914422, 3538203337, 2188319161,
                3278799759, 3020736936, 3471537210, 399986340, 1968814758, 969264551, 3530350534,
                1969502380, 147661179, 3137298512, 1364101497, 1404388912, 1303215423, 2286919520,
                3249572742, 3330831913, 3586493901, 3162077775, 2991387015, 3706115087, 169578752,
                1159180539, 3934133734, 558035602, 2925779959, 4063767692, 2885217884, 2752907569,
                1140725464, 749603258, 672416514, 1032385258, 3864779512, 3712562196, 3208066496,
                2643074326, 3543548657, 3720627664, 632092389, 1636851426, 594140763, 69489824,
                2777250607, 2306083065, 3916911258, 3141155998, 1993475481, 68784498, 1770067486,
                1998044447, 2520569326, 1992263322, 3101331801, 140848189, 3764741027, 1978515439,
                2361982733, 3127443736, 2897381492, 1302677523, 887097058, 1952041780, 783608822,
                1097624715, 99755829, 536819342, 2899797741, 3314381803, 4190434837, 928227057,
                3989607704, 3914272902, 3196195572, 1073079639, 3400734903, 3946657062, 3174732283,
                2855002505, 1996931952, 2245019261, 2712989234, 1251678454, 578021470, 933525407,
                1735185706, 3242693894, 757877465, 1570544476, 4054554610, 4232789, 1769248079,
                3386476948, 1651095046, 1722645365, 3742083849, 249564447, 260470985, 926270254,
                1849290911, 936613977, 2807355918, 799601174, 2973430993, 3630517123, 1010630102,
                1596332202, 3693726207, 2696180764, 256508517, 2935861013, 2617574366, 2142295104,
                1294973507, 4038702029, 3944607195, 3841990618, 98499149, 876432870, 2276059480,
                2682515232, 633274451, 3670159674, 2039570585, 3672264107, 3435333464, 722344600,
                590278704, 3403124564, 2414477570, 3921713319, 2561609021, 966607910, 3391894575,
                1125597344, 1769874536, 1258228103, 1862948975, 3973133769, 2533256421, 88292560,
                2813190491, 3533833187, 413327252, 3841705126, 2608177858, 3676328284, 2614193419,
                2483046806, 692717429, 3846808159, 379277707, 1669205079, 4233020303, 1294972508,
                3928564917, 2407908590, 744791264, 3255079725, 3753322493, 472420344, 1166843119,
                2467000669, 4140405991, 623716212, 1139273119, 3354207202, 2025876056, 1890550355,
                3308875843, 4187315065, 568191796, 1415565133, 2687244643, 2241676607, 2580202219,
                1708640561, 390914458, 3510831086, 1856289438, 1473240478, 2516164037, 56978641,
                4018676274, 948004161, 2713281743, 1119094116, 1836707971, 65506862, 2266057879,
                3850031360, 2402902235, 1355795078, 3048720123, 3936358528, 764696513, 3500940987,
                3117850578, 3798438683, 4211733833, 972363431, 1880167313, 253714622, 76302969,
                2144921929, 594588250, 3419391407, 110436200, 3019984992, 1696068166, 1311459144,
                383767145, 4278876264, 1806767552, 478592754, 3307398109, 2106194092, 1374406895,
                512715289, 2870580756, 1992431788, 63343676, 697633985, 890054481, 1959129172,
                2577805590, 2764027866, 2020028848, 3876787343,
            ],
            &[
                861890943, 516245383, 733102822, 3373234349, 110977034, 4271239715, 1739646310,
                3430038451, 2971068856, 1353792561, 273988221, 3727621506, 1880644317, 1169807252,
                2221765190, 645570626, 1827088960, 1940915885, 4161457279, 3100425720, 996251533,
                95565099, 1073046961, 2253764580, 2391616729, 3098700232, 106646536, 853783579,
                1589281984, 1966496578, 2971444515, 4208062631, 3919529557, 3375641417, 1678790027,
                3548362465, 4197401264, 4152189205, 2578742796, 2352527389, 1289840774, 383594740,
                604487604, 3605617314, 1576995811, 2410149432, 990820085, 2546262411, 2154758716,
                618380381, 2206847289, 3469453827, 1341806652, 1019433523, 152426111, 2749431433,
                3607895359, 3011391435, 1478694163, 851990590, 1027992752, 1059272616, 3480493466,
                1488043252, 1392852266, 3113620249, 4146237371, 2130545233, 3935615262, 1894052325,
                3086808567, 1407836003, 3747705872, 2582628925, 4262889138, 874765444, 2961363842,
                680545553, 2488989749, 3345785826, 952704427, 4098093425, 2516922879, 211154154,
                1759131069, 1700311172, 2393378850, 189990019, 3378862840, 1411934279, 4058568121,
                2905294981, 3913230880, 3855904011, 1536608211, 4114811350, 387292488, 691407511,
                2360232735, 1725740094, 50400678, 3408982759, 2861477438, 2945536307, 3193284782,
                2711749342, 658984109, 343184872, 1067289865, 2232608224, 4027855946, 3835625791,
                3914871156, 3647728511, 2766962294, 1158831068, 1928020015, 1802324187, 1465396891,
                2797410329, 3693678708, 1474899877, 1451659497, 2793780175, 3408416157, 698362941,
                1638711078, 2942583266, 3345553229, 3337125778, 3898736345, 3233933201, 2121187878,
                1375122421, 216315377, 285271552, 153543683, 3787450620, 18426473, 2074179790,
                3707951065, 4276245641, 3503168626, 1741007520, 46035775, 1938996412, 2285217270,
                1291171645, 4224874181, 602464202, 1803057980, 3577626393, 355587957, 3077316668,
                2374221701, 2965264159, 1074621373, 4162088640, 2550826771, 2808953809, 1252092668,
                3357187794, 476206830, 3584460445, 4065428738, 633814711, 2880883917, 3884516376,
                1513164555, 3300578942, 1670837060, 1132213662, 3351202257, 2610012791, 3257259539,
                3160483911, 2266079247, 868822128, 4250370567, 1331943301, 1945818535, 1393345318,
                2060415706, 908741824, 4156794744, 2564813613, 905212060, 3218738129, 3262255881,
                2263542766, 1227381935, 3663658012, 2226973450, 4231561520, 2818168164, 2670361969,
                3318293987, 725644295, 4019758576, 998642393, 495827676, 3734906270, 549931550,
                3628965188, 3223395992, 3590294271, 449855696, 1500765851, 2275616292, 2735068879,
                2797134520, 2639621186, 4044997105, 3174110149, 13220550, 3092556343, 1435605571,
                3386705521, 3831842284, 3500054590, 812912044, 2329469982, 1723309995, 2307452017,
                3303104792, 309903689, 2189249934, 3636229896, 1168371322, 2203364016, 56316585,
                1507047047, 3978350651, 1287006021, 4136822779, 1754090185, 2908593163, 1172296646,
                1218980475, 2947600132, 2403727272, 1587640760, 1122215884, 54808095, 1625907344,
                3722900656, 845603689, 1328648304, 1556638437, 3283968864, 3011502249, 112044910,
                3596114169, 1850965401, 272070320, 1659402803, 3430852231, 4069438789, 2244303862,
                651616701, 2182731301, 636443810, 1069166894, 1406346119, 749190002, 1954541375,
                1807738880, 1450920040, 3158039132, 825986184, 4212536016, 1808707022, 2850318233,
                429694363, 4071098452, 1248651330, 2275666509, 838162196, 1424879694, 776592838,
                2740483790, 1284163517, 1280694131, 1134770642, 2077202374, 1206292163, 1284319127,
                4184450872, 562093874, 952059065, 2799693572, 565666121, 156186725, 2849625182,
                1184911783, 1502520806, 633585326, 3853907607, 2739083441, 1951262688, 103314579,
                3831503747, 2993941865, 2470035934, 1778816965, 3674359762, 2878370279, 1350386433,
                2408142731, 3015205620, 3043051127, 1655111158, 3773182311, 3910770118, 2947352886,
                3356936393, 2844618418, 3298179444, 1279762744, 2973165223, 1721543619, 4040357913,
                2673457267, 2733636953, 3004389294, 2106808579, 466071136, 2720455489, 900027010,
                3351752905, 386568249, 3758644029, 66397961, 2459306698, 2672898173, 1655443171,
                3369301491, 1855362811, 1446321007, 2158536501, 1872565755, 3914900675, 1397039644,
                13190889, 514173561, 931870314, 594435363, 1526203696, 2400586492, 2299132127,
                2876601263, 565427241, 1381196042, 2872681002, 3103160824, 405911440, 954740851,
                675181390, 2686349099, 4136963415, 4220549550, 2370055970, 3163147061, 4154464526,
                3976152950, 3281076036, 2145465814, 1952261737, 850385895, 4035222541, 4292853188,
                187378739, 146395110, 3997223188, 2808707041, 983334910, 2236221581, 1884459573,
                2703940487, 4077202970, 3803155817, 1872492268, 2837348007, 3074452453, 479001365,
                3913048191, 3515475086, 4132420828, 3086255747, 4198950954, 3294929815, 811732388,
                2548414145, 1396214061, 2394099307, 4068762174, 526147562, 1076045316, 1123992450,
                3733570622, 4220579043, 889069266, 2894360531, 1971615205, 2766482958, 4265953201,
                2973723720, 3986781638, 529293577, 1884138947, 510069540, 1743552552, 812713578,
            ],
            &[
                2625866541, 2810579078, 3501644219, 2416714925, 1291740196, 3660307741, 2609642196,
                2505392144, 1722898427, 1674316556, 1432469984, 4097335408, 3108223053, 1374639232,
                1851930259, 893716755, 2663933335, 1737930775, 3657985359, 3660388910, 2695083669,
                3386383098, 267519188, 3888348035, 1835595210, 2613536126, 4114884836, 2142604605,
                8565287, 1755951705, 4130425802, 2850158056, 2234922350, 1949213237, 2449412937,
                1402509673, 3986161632, 1988171673, 4272507706, 3260139743, 1807943254, 2734619085,
                740216746, 446923648, 1965334425, 3397454741, 809048263, 494222614, 1484571594,
                3636917813, 1079987980, 3243842717, 3971186898, 338155234, 863804008, 1792493616,
                2522062802, 3816014339, 2741664304, 222474042, 154928734, 2936845361, 1353872451,
                3808072940, 334383012, 1793621170, 2698841688, 3751625796, 3312001535, 1308411945,
                2231283256, 3335332368, 2732745501, 2266806470, 383612527, 3711228074, 2478058102,
                2078994051, 975470800, 4179961686, 2605205960, 4060526006, 2648539390, 992385227,
                1710490965, 385423846, 824778193, 2349766631, 1760192209, 489319807, 2127640163,
                339639147, 2672582271, 1527261122, 3929636146, 3273385907, 51468511, 4261991464,
                1868351312, 413372128, 1083615978, 2931924886, 3886667243, 2763475974, 2738582447,
                2397672301, 2259776571, 2115277994, 2148277873, 2696639925, 1519841204, 811678952,
                628203566, 2552032086, 4011447443, 3160851596, 258941070, 1535778333, 4063703767,
                1926535070, 303663750, 2997548738, 1835822843, 2093980860, 1428491141, 3798948389,
                462487877, 2937763495, 3558060512, 87869235, 3064605488, 295532817, 92123524,
                2923122754, 569558082, 310878410, 2667249293, 1502523772, 700589809, 402354610,
                1860279993, 748794047, 3648640215, 3110702404, 2258574876, 2773396367, 3517237080,
                2990861341, 331348076, 1212514551, 962158293, 1191845582, 2112876079, 2501772177,
                2831655935, 3995296179, 3011183472, 4288287857, 3132719253, 1897663845, 2153050331,
                3461291371, 57799706, 461541578, 1483239302, 28451101, 895953744, 3368918207,
                2594694002, 1268319513, 973441686, 3311571754, 2019274316, 4123248452, 1446014889,
                1417571585, 615477194, 2194462687, 1708163105, 3293326615, 3383426484, 606654074,
                1070117839, 630146344, 2571257218, 3961968468, 1929710282, 1868034367, 403216466,
                3088416046, 449849638, 443975756, 1551823500, 3682150448, 3283842757, 4232686157,
                4164057310, 2186087032, 2166995410, 3181021883, 3318208525, 2768887999, 2877385605,
                469197960, 363931824, 752117713, 3980786726, 4244751154, 3858512024, 4033177219,
                3536702242, 3001143104, 1049662321, 4154276130, 2710845384, 1882050975, 2307442635,
                2303006043, 1063921606, 92351540, 1383930617, 3560089905, 2221914576, 3599852592,
                2796496568, 2234040425, 3492209128, 469541171, 919249352, 4275860868, 3002397499,
            ],
            false,
            &[
                3585575447, 3122160444, 2645674960, 4091549360, 626365202, 1144617016, 3462810264,
                127827394, 3154238169, 3508098827, 4065321164, 2627720920, 3399886577, 3188051673,
                1639089029, 2016161381, 1581970985, 237731508, 3479558677, 1944880307, 2562503556,
                1795700699, 2609445006, 1116190050, 1146777337, 1200401433, 1157695328, 350844679,
                3282708071, 2845229536, 459139289, 3375883464, 2424175740, 3193435758, 432712800,
                3851580195, 993388507, 3458606683, 3233513818, 1868436357, 1353535090, 1991321983,
                1598253594, 3580022384, 1800608735, 3030838485, 1479344427, 2146117321, 3615628302,
                1468724143, 2513216309, 2478400520, 1881309170, 3573465816, 191069649, 2319303987,
                36912024, 1056835502, 4085803346, 2567638548, 3614176540, 1774136604, 2502728501,
                2178987690, 2079375302, 2975418245, 761382377, 3364876440, 3617579499, 1451615440,
                3143305641, 2435105671, 2844406164, 1247246351, 894541250, 3633445851, 214286649,
                1891108578, 2579284088, 307573789, 3098902942, 2276329990, 3682940322, 2840709312,
                3778212298, 2325451725, 3477808517, 31838273, 2670981675, 2270297375, 465284332,
                2697844185, 2622424439, 4051875556, 814914907, 2448623943, 1299744713, 1873124502,
                2036773577, 3689282510, 975141741, 1207881273, 2818435693, 3863231130, 3098155233,
                3073113139, 1724416932, 774815313, 3984444108, 1380084993, 825030359, 1705088193,
                124122371, 3659155851, 2518826336, 528672560, 2665679696, 1402818456, 782001915,
                871778931, 2353626471, 685023982, 1884443856, 4156627926, 64651699, 1586126662,
                1522765556, 3831765770, 3303426700, 2833111857, 928056991, 1307034056, 3386313127,
                3415959770, 3498516705, 1932766589, 2313751714, 366206234, 3192561873, 2943917337,
                1140687467, 1640175340, 3542041198, 2895665827, 154126416, 650854034, 2789160074,
                352460908, 1351655152, 1980048568, 2172281721, 3543770557, 2365332223, 35300985,
                1050292927, 1349692310, 270125821, 2579494270, 3106522063, 4229421146, 471231049,
                13349434, 2438602373, 1915124258, 2193214542, 3087834620, 276889911, 2493806637,
                2402232776, 556133444, 1874277037, 1783512114, 1442646686, 949037422, 4233276648,
                1359566262, 564784663, 939635477, 1679428216, 2650897503, 1481863691, 1162596971,
                1097624715, 99755829, 536819342, 2899797741, 3314381803, 4190434837, 928227057,
                3989607704, 3914272902, 3196195572, 1073079639, 3400734903, 3946657062, 3174732283,
                2855002505, 1996931952, 2245019261, 2712989234, 1251678454, 578021470, 933525407,
                1735185706, 3242693894, 757877465, 1570544476, 4054554610, 4232789, 1769248079,
                3386476948, 1651095046, 1722645365, 3742083849, 249564447, 260470985, 926270254,
                1849290911, 936613977, 2807355918, 799601174, 2973430993, 3630517123, 1010630102,
                1596332202, 3693726207, 2696180764, 256508517, 2935861013, 2617574366, 2142295104,
                1294973507, 4038702029, 3944607195, 3841990618, 98499149, 876432870, 2276059480,
                2682515232, 633274451, 3670159674, 2039570585, 3672264107, 3435333464, 722344600,
                590278704, 3403124564, 2414477570, 3921713319, 2561609021, 966607910, 3391894575,
                1125597344, 1769874536, 1258228103, 1862948975, 3973133769, 2533256421, 88292560,
                2813190491, 3533833187, 413327252, 3841705126, 2608177858, 3676328284, 2614193419,
                2483046806, 692717429, 3846808159, 379277707, 1669205079, 4233020303, 1294972508,
                3928564917, 2407908590, 744791264, 3255079725, 3753322493, 472420344, 1166843119,
                2467000669, 4140405991, 623716212, 1139273119, 3354207202, 2025876056, 1890550355,
                3308875843, 4187315065, 568191796, 1415565133, 2687244643, 2241676607, 2580202219,
                1708640561, 390914458, 3510831086, 1856289438, 1473240478, 2516164037, 56978641,
                4018676274, 948004161, 2713281743, 1119094116, 1836707971, 65506862, 2266057879,
                3850031360, 2402902235, 1355795078, 3048720123, 3936358528, 764696513, 3500940987,
                3117850578, 3798438683, 4211733833, 972363431, 1880167313, 253714622, 76302969,
                2144921929, 594588250, 3419391407, 110436200, 3019984992, 1696068166, 1311459144,
                383767145, 4278876264, 1806767552, 478592754, 3307398109, 2106194092, 1374406895,
                512715289, 2870580756, 1992431788, 63343676, 697633985, 890054481, 1959129172,
                2577805590, 2764027866, 2020028848, 3876787343,
            ],
        );
        // highest_q in _limbs_div_divide_and_conquer_approx_helper
        test(
            &[
                2317066713, 3734873775, 217584598, 4283181214, 1987296898, 2029964730, 2841877055,
                215692782, 869134407, 874390362, 2208433375, 645289786, 1962123143, 1210019992,
                392208793, 479186599, 1403346326, 3121890550, 21351539, 1792046631, 1830759088,
                3009702825, 2064264407, 1425980591, 2915380046, 2661484230, 272407717, 4286945194,
                649139597, 3925921591, 1081687841, 2923866665, 563140201, 1426204510, 3994415326,
                2030662828, 2060697960, 3056670310, 1609787794, 792934567, 2717771124, 4164322768,
                3913458892, 2759459876, 4091351278, 1717819380, 1097243558, 2147464721, 1228826351,
                3209546368, 1237764046, 1059356034, 2760411795, 3026477323, 624675850, 3763684075,
                3540407970, 1913722572, 262369959, 2180102174, 3425380260, 1174673633, 158169541,
                2382293449, 812030319, 3239921986, 484642353, 2919528753, 1658419979, 366878628,
                1718980142, 799549350, 4285110305, 2715036325, 2455015536, 3032041112, 2735249018,
                3310370605, 1181357276, 146624587, 3299107633, 1004501470, 3484807107, 1748985025,
                1773700707, 1386223716, 4087630817, 750649422, 3611015842, 3444400533, 3725662389,
                1109727693, 3037130634, 624478673, 633583116, 2378434635, 2687240280, 2673870544,
                324343858, 731297615, 3614185356, 495482604, 715462793, 3367457094, 2135162069,
                2612684285, 1189448323, 3887861594, 1345391741, 3430076735, 1913449259, 4268745212,
                3848733916, 1785626124, 3506024858, 1223431612, 3120693480, 3802248189, 2144116453,
                557985986, 2604607267, 1018386624, 2418517078, 2442250784, 3582497470, 654976641,
                2599906378, 2211771862, 4102664307, 836270496, 4128006488, 2260892, 277275779,
                535619372, 1868873131, 749436370, 1849951520, 783534973, 2957791640, 1636965908,
                1156916684, 3732442514, 2251346101, 2723065991, 3717891339, 2525911896, 3076617154,
                3265371035, 3292658676, 409114969, 4086635237, 3264336755, 2836953044, 3037161740,
                3543275191, 585786355, 3087011769, 2185871252, 2541194926, 2224439978, 3412364477,
                1350015989, 1311332023, 758561683, 4108017253, 4204509134, 4157141131, 1893317202,
                1224082165, 880878665, 1834575916, 2572831131, 2631286660, 2578509166, 2240326536,
                2609750355, 2798227847, 1197386254, 807604908, 1802810117, 2881797181, 3334708065,
                3583310868, 3599155312, 183678286, 3236382667, 4125313765, 239427309, 3653131096,
                494732271, 3893107141, 1018082495, 1979944519, 4044560358, 4179896605, 3780149973,
                3875190427, 3114449657, 3457335347, 2339734261, 2616033966, 1329204235, 1248786560,
                3467382161, 3028029914, 2536952877, 194748555, 241512194, 3260227272, 2858189566,
                3881365161, 36968705, 581216076, 4188186728, 2833747030, 1972266392, 1374287701,
                3058853674, 4101868185, 3030432843, 3731159238, 3617181750, 1742674464, 3668849596,
                412040791, 406334378, 502702971, 2540238946, 2391871283, 1851296773, 2979189987,
                199738981, 3379464313, 2875483565, 2404227424, 2501388469, 2789274764, 2515008836,
                3408871507, 4145552682, 2991097752, 2338096504, 2325133139, 2082275255, 2834180247,
                537432099, 1257296228, 3446712843, 39458827, 2174956861, 3039757037, 4157335831,
                733488951, 2064219555, 1158696763, 1747438019, 1904327490, 2069625042, 3220261644,
                2535390409, 1866459831, 3174902084, 3763763466, 711704437, 3941981941, 3947689731,
                545125868, 199321616, 195433751, 587082201, 1623079028, 3583449493, 4189372053,
                656157970, 4065268173, 2321947633, 4117128060, 1042761195, 543619922, 4200179141,
                2194761475, 878960867, 3598234187, 3791350851, 346665711, 1360737771, 1930187385,
                2405900037, 3062309031, 2085261831, 707121842, 3173108868, 503413591, 73514434,
            ],
            &[
                1172385474, 2722128840, 3229943889, 318467582, 1270391003, 1178663423, 1974716983,
                3282704963, 3178774681, 3202829277, 3946239996, 2183661896, 756303666, 3877972989,
                4251016295, 3386638802, 4082864246, 2928113767, 1526526769, 2729531320, 933752600,
                3559448071, 3782798998, 249483043, 1511243361, 3564728022, 1594495334, 71444771,
                3603995676, 816918005, 1243632828, 1550377419, 1008068857, 2948396814, 2093904319,
                2147043689, 2566638926, 1425327657, 1162199945, 2960758893, 4198224, 2356436749,
                3424929725, 1080768275, 209858098, 113302786, 3443677754, 3549677964, 3154318213,
                3154103315, 1582401507, 3617714568, 2767982074, 3761726254, 683939930, 192236320,
                1080891479, 1143174553, 2075266572, 1844075493, 3593156363, 1292478494, 1945353284,
                1251725895, 142445996, 3777493501, 3614227130, 2589877580, 1660324871, 652913311,
                2513923073, 104713426, 2880864765, 717044714, 2176657233, 3162919827, 1461924303,
                1335307283, 1089899112, 1463447432, 4286236462, 538631465, 1843988250, 978544087,
                215501900, 93216142, 2947050139, 2693646353, 4213675869, 3765139921, 320058937,
                1970573977, 43732280, 1873575176, 1055975473, 3361081513, 4080049587, 2593310713,
                2546627943, 348433615, 2711034081, 1213059756, 3994279311, 2969515716, 3962824055,
                498958294, 3283335149, 2727270461, 967722336, 1011867961, 3277768890, 1239567734,
                2615827582, 3138350967, 1983810667, 1258771837, 156352868, 3459871732, 3838966901,
                1926475715, 2906860513, 2265591974, 739992556, 4097548896, 4063110249, 2614816895,
                3485800367, 2745680040, 1081661573, 739066934, 1373973331, 1210644481, 2279017196,
                1005551928, 2040599086, 2689171110, 2107331398, 4229586067, 3246733336, 1653467821,
                3803759079, 1396785958, 744631377, 2218132207, 655573009, 2223316795, 2924583188,
                3561375837, 949662445, 1302891749, 1031980062, 864295262, 2438572862, 1504001412,
                933269347, 1253638591, 1534271622, 2530288971, 3587024017, 4130814425, 2573905811,
                2785603748, 3552056080, 4244335838, 1333943369, 2283588299, 2119292262, 1681201617,
                3442164059, 1894009073, 2739198217, 1409299279, 3436643841, 1088847721, 837995626,
                1423764787, 3020531343, 4051404125, 618735582, 2571970479, 3106734771, 2404302700,
                1055667736, 397025181, 252340965, 1296678038, 512661010, 963140047, 1161844858,
                3862111880, 964139113, 3914454392, 2517045255, 3547177225, 2645896340, 2943432060,
                4173143499, 48482790, 1022192902, 500159282, 3637285006, 1101744863, 2363750224,
                312625286, 3984163509, 3118100618, 2790609658, 2907841435, 1239943712, 2072088288,
                159276689, 3267720981, 2856806276, 102734665, 3390376688, 3378951761, 975939361,
                454652442, 1925083628, 2151124106, 1307480526, 3774198893, 3018272285, 272747408,
                1016277798, 3605470575, 531634579, 2961498249, 821488395, 3558633824, 2912444276,
                1657117175, 2153161136, 1884360710, 721291427, 1531829639, 4115435659, 4254348147,
                1506441630, 4046066015, 556451623, 3337814584, 1018537690, 555628783, 1620746271,
                2482837019, 3679282774, 2426930864, 2632326440, 2327928883, 2353267828, 3481986297,
                2112160697, 1022061657, 758309560, 2644660892, 907838024, 1498392732, 528384055,
                1202823703, 1890604888, 1949099119, 3063001275, 685428701, 1780107085, 2619180751,
                2954672471, 2283259797, 1374458453, 1565978557, 1093442961, 3891637052, 780517054,
                503083440, 1375890406, 1386889110, 4237816737, 249672267, 828386282, 1163719531,
                132139434, 391942771, 1096514028, 3006936950, 2283483449, 1662382851, 3602503245,
                4242261323, 2784647410, 2828350825, 1288023746, 1017072535, 2006783410, 122598670,
                1977168703, 4075238695, 1691129759, 2007296448, 1519044036, 1701991670, 1153128956,
                1512900449, 1261204616, 2927982361, 1657752895, 139288437, 140564828, 100283802,
                3070382516, 4089107340, 191147528, 1712401819, 391845701, 1540517289, 1700899625,
                1477882518, 755000874, 480418626, 588196749, 400809532, 2485933533, 2888628826,
                332783138, 3009527268, 3784829804, 2922060404, 2516820570, 2217403977, 2521013993,
                2614722986, 3779307621, 317006621, 1733129556, 1267545638, 3033328419, 2185074347,
                2126485254, 1990828725, 1034359217, 3945891523, 3588995366, 246414315, 2407783722,
                1985580187, 2106721825, 35659189, 204134384, 203035567, 2650819784, 3097513541,
                195622280, 620515605, 2016439173, 304017649, 1791577127, 1576105034, 3535138410,
                3637374201, 3626803115, 1214754525, 1611339531, 1762283227, 2759574029, 32271764,
                2702968983, 1516226210, 160223584, 3507738999, 146234417, 2990154579, 1436112035,
                1948173615, 3890958043, 1222277581, 1349923980, 506218124, 1577016965, 3229129980,
                3912753236, 233704342, 1219563141, 429930162, 2006881030, 3328217266, 3101601662,
                3008827607, 3114439162, 4169647780, 2658687412, 2809028243, 297647962, 1609437431,
                3358143193, 1716156248, 1612652130, 2723039108, 2877712792, 227416933, 3655452320,
                3809918775, 3758975241, 2625261551, 1044900207, 2767833802, 749765276, 1997143904,
                536279565, 1568228199, 764519151, 4215912350, 263962810, 319470773, 3810995202,
                3465177349, 1243659365, 864064918, 4136562751, 3062846208, 708743160, 2187738105,
                3898834484, 2200754536, 4539814, 1789419448, 105721213, 2944213866, 1486345112,
                32430882, 253601522, 3408074780, 2992349041, 2451728307, 226661140, 2460239549,
                2100724593, 3852012222, 743449851, 2967418295, 605498674, 2055548507, 1922946771,
                2632283075, 4086716584, 623236339, 3410294246, 4133057483, 2812524059, 1205446946,
                3043927830, 3482614376, 1275680906, 3676217583, 513988754, 893728600, 1999049758,
                598451747, 3593194658, 609427399, 2673100544, 910865729, 3116238253, 736726549,
                3362221872, 1013768942, 718438609, 2217341124, 3587867839, 2300483002, 1946981080,
                3920103403, 2292895303, 3117736693, 877577485, 2187888016, 1368957453, 4283009664,
                1076391253, 1397877819, 2980178183, 3968837715, 867743243, 4043356977, 2946375050,
                26361492, 3432852562, 1912980855, 130799130, 4033884077, 3349537042, 3182198745,
                2179478628, 4252455628, 825955887, 93466691, 2196075887, 1784475710, 946546654,
                3933870986, 2244605733, 3490402086, 4030429100, 3023300148, 1745265920, 4112142076,
                2903907125, 2758734523, 3896908867, 2564201959, 26549320, 1274768945, 2576126997,
                3923164846, 3736091709, 370046710, 514332769, 4121086903, 2972568269, 4088911695,
                803020494, 3034337812, 317708135, 1334283383, 881113661, 1695276900, 3766800569,
                2061275833, 1227611332, 121744019, 2173946227, 2389688567, 192367735, 3892792894,
                2172535825, 117291679, 1935828849, 2721596143, 823956503, 1586432341, 2448062771,
                4054304197, 864073076, 4252759593, 1258481746, 4285979432, 1026798711, 2713633766,
                114893615, 3134616441, 2817271874, 666109477, 3691375086, 2759951811, 448361256,
                1541295802, 3882571749, 2284391955, 1326400031, 2777223186, 885169913, 2782624297,
                3537147598, 1692556532, 776208409, 3241275549, 1904954149, 2405119603, 3819789804,
            ],
            &[
                225066005, 745131552, 2942567538, 4258778781, 1967392927, 3741613691, 1890932195,
                1506277386, 1146302728, 3715076457, 3577274198, 3953573097, 2085422530, 661098011,
                4236873637, 2930925760, 3967583938, 2852055099, 355730378, 512021169, 2505846300,
                2749910007, 1454559275, 2553714326, 1536856909, 733797684, 656941700, 370199490,
                1949020029, 4091629764, 3452778818, 3434279798, 240547993, 381305151, 534633119,
                3783352536, 1551443097, 2973034337, 2180000100, 2053656589, 3320616670, 1724644295,
                589237508, 2241024734, 412948466, 3347181025, 1812386780, 1524837382, 3656593545,
                501624455, 3029327470, 273718066, 2666953466, 324438884, 2852820080, 120020650,
                3393646374, 2619314651, 3733169374, 3756112094, 1302185220, 3677713422, 2747067315,
                2815017712, 1868682331, 1943529649, 1563990165, 319757768, 2031825250, 2139207520,
                2978578108, 1560356796, 3699549338, 2916893113, 101966731, 1585835576, 2998190164,
                3967243725, 3959463829, 498949725, 3348011234, 3761007557, 302477959, 3992592959,
                2447724633, 2460308753, 1858976258, 3525120157, 384425177, 2978081316, 607592077,
                401773917, 1748638062, 4245512962, 1117346825, 2328817272, 847205838, 3491495030,
                470052326, 1893860493, 2076576843, 2289319719, 1260754313, 4064542122, 1206836886,
                523542952, 894395755, 3043786155, 2337338009, 2752103377, 3251660619, 2215772339,
                3015482729, 2593131420, 3786996532, 3672453772, 651643275, 1988656237, 3347623451,
                356296282, 2406730821, 3093333932, 2660898588, 81938635, 3783019719, 383826519,
                2681656944, 3399824694, 3552203202, 3981865110, 1183621457, 146668152, 3118763304,
                1958273303, 2057041878, 1183522949, 2882248106, 230586931, 680070970, 263636248,
                2634241968, 677653887, 4023567727, 3777994047, 1592901741, 2761934715, 910715025,
                1512493458, 165009600, 3565664162, 1187297321, 2558161419, 2468839453, 887950197,
                220662954, 1244941671, 3095343373, 2063342669, 2090489239, 2010099484, 1948084319,
                1365644807, 1235644818, 2588736961, 1564371721, 411294152, 3045805520, 1843591393,
                3688879242, 2388718380, 2305780976, 3853250176, 1061462164, 3916091720, 1198491889,
                3197591330, 1096143292, 2118906933, 1635799180, 1176220582, 2501989740, 801999335,
                2705462373, 1003645809, 2186975253, 1064745016, 1555323605, 4095122662, 1852179202,
                3337474276, 2971325331, 529480360, 4181951721, 1632451986, 1921251025, 2187957901,
                1550157150, 1055194859, 1178754848, 2551455843, 4253040930, 72428672, 2433250913,
                3380996315, 868858299, 2205090193, 2621190489, 1284715782, 1308118202, 628595114,
                2783487525, 3396644559, 3453264010, 1070669284, 1383523038, 3993112084, 1712356129,
                373012427, 126203575, 2392499470, 607718265, 2253959369, 1040951361, 2590357607,
                2175608952, 2297182602, 4276086375, 1607963583, 1082087029, 3529235816, 326427724,
                3716684434, 1901298488, 37770472, 3247695701, 1067103258, 3117586492, 1266520999,
                1168926910, 2626033388, 630871070, 4243084776, 188878698, 3514192446, 1923550427,
                206270544, 1634209660, 3863690423, 2574699027, 4168121673, 1449879463, 4224275977,
                2227130200, 1884692906, 606301209, 1210083889, 3640641606, 2504768822, 3610799696,
                2178748368, 1708820271, 1819469384, 2802870165, 2246886931, 3567016595, 3555599583,
                1348994237, 3790873838, 3926636967, 1088645573, 3438253657, 3323650855, 828010249,
                618829949, 1504599310, 1908275663, 4270232696, 4036146227, 1856897469, 2998994751,
                2752368926, 870328089, 338595046, 3616029110, 296696765, 1403260870, 1830786965,
                1227812187, 2223459989, 3589209104, 2051289912, 3318866022, 4094335795, 3787444415,
                1234353630, 3808781435, 387466633, 3211872777, 4202021032, 639324231, 1976675272,
                2193056063, 3199669188,
            ],
            true,
            &[
                3923579889, 1687605753, 3377794191, 3322208449, 1203553350, 2154425101, 1359863697,
                3023444870, 776353376, 592836194, 2511309652, 3922934431, 4150213939, 858418424,
                2956152570, 488137268, 931462870, 1642630985, 3149845100, 3318171957, 538998706,
                5191729, 2137745225, 2297747699, 1984407713, 643246259, 2253618591, 523932289,
                191175769, 3642012130, 3400043084, 1707948340, 2992423698, 81890223, 2378233131,
                3079312226, 1066946509, 803135022, 1994948858, 4041732309, 1337312336, 2966488667,
                3428464355, 2737588983, 4228360315, 2146901404, 3059157811, 2476369890, 75140925,
                3251604233, 2881152809, 802794015, 3378093993, 96836131, 3099865764, 811380027,
                133901715, 1047457206, 3609305681, 1771180437, 2461319522, 3515701714, 1066513666,
                1659070392, 3086795089, 3716662526, 559065127, 3237292382, 3631218434, 3795187732,
                704836609, 3786271895, 4061286432, 405232026, 3609248662, 3980760947, 3571087184,
                1847154731, 2094552306, 814159853, 4260485048, 3149179255, 912325889, 3689884426,
                4138663955, 14357881, 2050778168, 3912490158, 1861501789, 814905489, 3254286948,
                2032825464, 3271543587, 2219425366, 4225852701, 1857868075, 1298372166, 1102499025,
                3574133387, 3812312663, 448380962, 3807290049, 4209544034, 2256927203, 412478498,
                1228300916, 2401082596, 350244424, 3441586361, 3136422715, 945678990, 2116172969,
                301198401, 3322856984, 3407592301, 188389305, 2628435530, 597331343, 433647333,
                3063380936, 3817880039, 2901586764, 3507352615, 2352939145, 3490273512, 4090562787,
                1802676852, 514644644, 4124694011, 3639332010, 1115134207, 227756304, 3818731261,
                4222040109, 2430937604, 2156693403, 2184651107, 3551740749, 2132540830, 1150238882,
                1052043654, 571348510, 3172318934, 3673669988, 692769159, 210233084, 2958517959,
                2297993342, 3316672837, 3302014323, 354145219, 2484852144, 3683759209, 3408466568,
                2978225356, 4097994925, 2538336670, 1392418428, 2899544976, 457988587, 3773763501,
                2012444919, 150975722, 2234422639, 1822822763, 551692314, 1014406649, 3374930924,
                1240545416, 2294327444, 3432793083, 1000394478, 2103969650, 1395783166, 4085383479,
                1542514796, 194271393, 145341362, 3655868181, 633459061, 328054273, 3431726030,
                3557285056, 2901104858, 2052553042, 1042550372, 343075862, 4115125230, 3906797654,
                1301043752, 2559925980, 1623793157, 628627946, 1884173596, 1228259826, 2621415081,
                2785923512, 4270141343, 315667031, 282856266, 429519802, 3536348488, 2322956754,
                3194951300, 1510744177, 3616915522, 3309727286, 517266630, 1119984084, 4026073305,
                2238785198, 732618834, 3368263738, 4087015376, 2697003280, 994552013, 4290467065,
                2365091630, 59691114, 169931479, 1498618224, 2382537145, 310192470, 900458915,
                275936028, 3655907299, 1961047155, 943058038, 2333911425, 1578159189, 1847055172,
                2659538736, 1993399472, 2491904542, 1070133929, 2666142065, 2803306446, 284508539,
                2535344546, 798366741, 899869216, 282425661, 1522885207, 1934768011, 1935282035,
                1783703650, 763335394, 1114825113, 4001525101, 3326921253, 1057031491, 231338938,
                505911721, 3073700058, 3881013726, 2622491116, 2434260580, 2104610402, 77048668,
                3840229888, 539240724, 272637566, 3598686634, 832397853, 3941981941, 3947689731,
                545125868, 199321616, 195433751, 587082201, 1623079028, 3583449493, 4189372053,
                656157970, 4065268173, 2321947633, 4117128060, 1042761195, 543619922, 4200179141,
                2194761475, 878960867, 3598234187, 3791350851, 346665711, 1360737771, 1930187385,
                2405900037, 3062309031, 2085261831, 707121842, 3173108868, 503413591, 73514434,
            ],
        );
        // lo >= DC_DIVAPPR_Q_THRESHOLD in _limbs_div_divide_and_conquer_approx_helper
        test(
            &[
                3852468748, 3866732619, 592701608, 3778254743, 1280491238, 2834833773, 550923334,
                1479705073, 498349312, 767409174, 42211279, 2128147526, 2926662909, 141411040,
                1065100366, 1527285446, 2874448851, 3117914313, 1218471999, 4280625327, 2037562894,
                1609603468, 3241376868, 1996556629, 3588969003, 1318580268, 3687594860, 1362481322,
                2944468172, 1695770272, 3083883725, 2377648522, 2496254008, 749263050, 2770685897,
                3512231732, 3023316399, 3384859643, 1220306495, 391138498, 804657736, 44216427,
                1931816623, 339239167, 2662606581, 2648352860, 1235726472, 1626990950, 3004127325,
                1053956347, 808327756, 1442399511, 4286364870, 31595646, 2379491886, 1328294899,
                816658097, 3205321744, 3963029596, 2572812025, 87366995, 3217997432, 1508641500,
                1825064063, 1941897747, 1436358378, 3017514874, 941910582, 3588117902, 135801271,
                2867936354, 2658316194, 407580200, 665652508, 1146163780, 3147022746, 3669479157,
                3697518011, 3942322922, 3433464004, 147802483, 1146857432, 73698519, 3370749655,
                1389534220, 589317299, 177267891, 2688250309, 2128670608, 1265200580, 2019760989,
                1150930096, 2585252733, 15447323, 3088238466, 1783728664, 2811524431, 3891707403,
                4029016169, 2907528558, 1270616768, 166893059, 1545869782, 4275310588, 2441090079,
                2829901749, 3736960597, 3941382642, 2821131110, 564991139, 3126664226, 1998382701,
                1328551552, 1210689595, 2996963417, 1557893584, 43742716, 876455611, 1677218718,
                729180347, 315949329, 1732639163, 1821348164, 151672496, 1329099718, 974261301,
                850419612, 1856037997, 2615159114, 3710750197, 4091633114, 2586774188, 2588577112,
                1339558569, 1735462778, 1262938743, 1891014212, 3269098922, 1992796362, 2808355044,
                3874652326, 2745283316, 1735823559, 3407614800, 370629516, 1152369319, 881914057,
                470647543, 3939410385, 2852748779, 853680636, 3231204925, 296778651, 3315599780,
                970480725, 1570957625, 3243621138, 4081630171, 2137632035, 488321574, 3274673411,
                996742709, 1121917553, 684178420, 2611815203, 1398907392, 3313511725, 2114905089,
                530433742, 1501425765, 3354176655, 3515249223, 3432236694, 2338559491, 3638772717,
                3253118328, 1594238823, 3094732444, 354679189, 1860678321, 86892394, 826940850,
                1314179547, 3978569567, 1699444163, 3462511739, 2591772690, 3726539491, 728424834,
                2932676784, 311068414, 2129104220, 1026553636, 2242765511, 1733810815, 1138330866,
                3652398326, 3074523173, 3839981206, 1015663483, 722242539, 3272711437, 2982099959,
                1938802295, 3022788284, 12930779, 878443915, 2907693541, 1979049428, 593163227,
                3823442786, 3215213583, 3695525644, 1119636738, 3212997654, 3027851617, 1144485880,
                164747928, 2781230452, 1258345532, 2869324653, 3068929942, 1028739729, 3380289029,
                2295840170, 3545102314, 2855402743, 1772822517, 724460983, 2228954158, 3208333919,
                2821114010, 3148029409, 4068546439, 833494094, 2960251966, 160156911, 1983852913,
                2791477758, 3697190934, 153093720, 104144622, 2441461309, 3159646380, 1733652873,
                1562477414, 2555472454, 208737200, 2703626976, 3180538910, 2592414545, 3416739924,
                3356130918, 4069598606, 1949794549, 1771742849, 3756687965, 1452093924, 2443380777,
                1591957147, 1211239165, 1876128705, 4247423793, 398751752, 2564049252, 3016849411,
                379369954, 1500293555, 1436202725, 3000709783, 2380370269, 1733644538, 1525628809,
                13455701, 3296626657, 521910174, 2364967601, 1781968745, 1399663633, 3043350501,
                1368246629, 2392664448, 1283732518, 785313394, 3034454976, 695088212, 1511797594,
                1863608029, 299100351, 2597420190, 989884842, 2042620176, 1636899254, 2378486752,
                402706413, 681449111, 3318018166, 1613374280, 2127967446, 289891229, 191268175,
                2824016875, 1141385569, 1160748059, 2298038638, 2273363044, 1083067452, 2227633073,
                3411833901, 2501670656, 1136686475, 449786314, 1206095141, 1428680228, 373851423,
                1065715962, 3842120141, 1446849052, 142137120, 2503522334, 2890167721, 489029335,
                2904499752, 3583810486, 141821369, 3975802804, 3139899326, 3360723646, 1325094173,
                1458543621, 3135728890, 1722244101, 546577431, 2431082502, 2423442975, 3716191600,
                4106127568, 1535072638, 3490647587, 690007845, 123509837, 3008940800, 2522129913,
                509564148, 3464677431, 2734250447, 2521445361, 2724421404, 1464248423, 4286188561,
                2041779154, 2040896472, 951622461, 2742066946, 3643978111, 3702076160, 3277267213,
                3516427880, 3288032742, 1694027041, 3062496840, 1755611164, 2144317315, 1840150810,
                3659412421, 269788590, 1685549590, 138245102, 3801925635, 2810327973, 3857961937,
                3773132978, 2859864128, 1937028826, 1803313773, 1721171315, 3641809479, 561594878,
                3883288939, 1615573909, 3567576946, 53427597, 3447054169, 924172132, 289810649,
                3166741000, 991317667, 72203781, 985172668, 3013352759, 2107570161, 3250293704,
                4114482787, 1050030772, 1057622762, 3438626748, 2519260970, 159154610, 888655185,
                471817829, 470991380, 2525869562, 257437760, 665926900, 2709862184, 3205674228,
                1381649365, 1803460892, 4134101678, 2543649326, 1209534353, 1226459212, 3664518300,
                2168714963, 3110951542, 2920091469, 280549216, 3763064171, 3139277729, 2961240010,
                3997887886, 2249335682, 4125195068, 2179174964, 4200864330, 1948058108, 1468274578,
                2376503735, 1402764211, 3508183492, 568398904, 3916597152, 1316008321, 3354808565,
                243276170, 383567360, 3854059575, 3533629121, 450497668, 1613229695, 1579942631,
                1479512959, 1708803214, 166236912, 3371361562, 1178374935, 3631449184, 1044231267,
                43160759, 2872462763, 386332526, 1454108301, 463466433, 2881621607, 1902397631,
                3675190003, 3262456635, 3682680678, 3921732891, 1604135368, 3949662129, 3129246190,
                1954536251, 1538666313, 2274928374, 1650180856, 3652524428, 1821056613, 911456961,
                840333318, 764118487, 2652399697, 2580502346, 2438391701, 2513677855, 2640798083,
                2778108413, 3625988619, 3121963132, 2016358782, 2026634297, 2454141008, 3719526468,
                2069512197, 595695222, 1372551058, 2654832919, 1312895472, 3449972978, 1039886392,
                1219309116, 2158257939, 161673294, 1466523266,
            ],
            &[
                1228082563, 3958970957, 2292561045, 1680572099, 795956301, 3199900361, 2775759977,
                470071915, 418570831, 1211920274, 3653536884, 1024252286, 2421732290, 2695210567,
                602247103, 4076240601, 547232254, 3118467901, 373262705, 2538006674, 3879907903,
                484206954, 2539623040, 4205486376, 1910552745, 3038212402, 2654312301, 3586427708,
                954791645, 2348064693, 1497313290, 2715388363, 3338088407, 2319307053, 1080519064,
                4159525507, 1284211779, 4015474700, 3753400642, 388134024, 2776075876, 552537674,
                1195536084, 1000211139, 3608292187, 456221898, 2979823937, 3666331215, 3448143527,
                752704015, 3181775208, 1221668864, 3658472905, 2038458530, 2182904194, 1539979012,
                1086813538, 1185254470, 810158065, 3448748698, 4194931499, 1623694312, 298685602,
                2265178291, 1937541694, 1775046588, 1544843229, 1529059357, 649269555, 2357792903,
                2571831955, 176354978, 1299551755, 830143712, 1015814111, 776566019, 2627651913,
                3960393788, 1268944216, 3414991379, 3922712735, 2519760646, 1906700144, 2590958602,
                353821006, 2218545353, 1375841084, 2092401658, 1639008622, 4082695593, 2141419111,
                3236669066, 1724206670, 419369846, 2835126061, 3041510267, 153991327, 2126200895,
                3461262411, 191209011, 1342692414, 154698036, 563023945, 1510300314, 2248068391,
                3846972081, 1992059708, 2646433655, 1714730200, 2303707509, 3981692650, 3517398169,
                2281282719, 2519619923, 4271369978, 293814410, 438829639, 3337765624, 622782672,
                944352733, 3715313213, 531335520, 113528832, 2419325895, 2984041163, 878536167,
                3214930707, 2146787348, 4917714, 3257269189, 2452274107, 2672157272, 1585645759,
                2131367341, 3585828795, 1333843792, 3923459029, 694088371, 1013702168, 1741059100,
                3997989379, 542853888, 1761645159, 406716499, 1694374453, 1624534824, 3459630459,
                802104445, 128207303, 144400385, 476582731, 3051345902, 1368383669, 1166299002,
                2707219053, 4004021138, 2679504095, 2592982338, 1033724773, 1157182117, 711981576,
                42503937, 2924924484, 3595784172, 3595204272, 2994216676, 4221872019, 3722581147,
                3333988566, 1523164764, 1080358318, 1413433846, 3738351350, 977402259, 1992977980,
                1559146947, 3211129812, 2160246550, 2367537106, 446281713, 2153747232, 397871847,
                3366573642, 2055448941, 41153636, 754933361, 2993598965, 3306066874, 3631977724,
                3123479847, 2585741316, 2994078662, 2509626417, 4066762390, 4211900185, 3742567686,
                3545119766, 949327829, 1947239775, 1596917691, 2428932126, 1055142932, 562149283,
                3199507769, 2908430793, 814804964, 398782122, 1053511625, 2957145782, 4214499480,
                2538107930, 3510188017, 3044050202, 1179016763, 3073719558, 1010197763, 2365480195,
                796718852, 2056040043, 872695428, 645007655, 3691376745, 104700630, 2649843250,
                4122935255, 642238345, 2295983257, 348265112, 2773179245, 898141051, 2579996826,
                2612225547, 3972451489, 2646202581, 3681992299, 181022653, 1485802997, 2440387741,
                2520682234, 51353550, 114076802, 51940680, 2817210994, 452896124, 3254045803,
                2864556183, 81661781, 237542081, 1973800766, 3657654720, 2530129707, 403307022,
                68172699, 332554330, 1181024212, 811837036, 3695906025, 1961935526, 3608053891,
                3566607807, 1505243326, 3952431950, 2229199298, 1258499123, 3907526592, 1202974947,
                4257231754, 383365712, 2370787478, 3966045621, 3709646864, 341562985, 2306743433,
                3087453648, 1119686719, 3010178775, 1966960488, 4005245264, 742100958, 1841989955,
                4073161558, 1387924175, 3136835241, 4153208836, 172275833, 118390136, 3068417534,
                3427994941, 1186924296, 3531763845, 1587276588, 2491453930, 3092663154, 186325597,
                3735008023, 2520603222, 141263570, 2586779772, 1097287985, 1184074419, 2231683844,
                1006316112, 4242375661, 3021145139, 2474020608, 3059475910, 4077499345, 2682549550,
                899267458, 2939020861, 212132728, 4070534479, 899246172, 3206389107, 738644506,
                1196824568, 4135770345, 665964490, 3404106178, 2800460425, 370991796, 6173656,
                989425002, 738558511, 1186448823, 1117986518, 3268400991, 694618816, 743869433,
                1081820528, 1169090980, 2808795201, 2626416762, 1852742088, 3500519845, 1862566642,
                2528685207, 38532995, 3254975580, 2293790115, 278388535, 4214498933, 3355793258,
                2429295061, 3055950106, 1916510220, 408474308, 1993547223, 3283433638, 2876081292,
                3535523705, 2101519467, 4222280709, 1877650206, 1362736623, 1125507149, 2753028888,
                2871670444, 3984235984, 2837413105, 2740068704, 2501544770, 2062713945, 1827003918,
                3387715121, 3978334051, 164380626, 911533483, 3159921130, 3896040725, 2453247705,
                1732359707, 97075111, 1167974376, 1292533086, 3978529628, 1173190459, 1180474283,
                4027781835, 1819164482, 1138188719, 2554004670, 2238689551, 2719133108, 827123216,
                3402746862, 364981183, 1215495008, 3697503228, 2459473144, 794939056, 2850414988,
                3880571940, 3446126388, 387496900, 4012258040, 233036233, 1295469109, 2236990087,
                289904073, 1533599469, 1786729109, 3155911485, 1361493542, 1709668750, 2979939253,
                899656352, 2488414909, 2345651638, 857006573, 2499927665, 3004854698, 2767508418,
                3057934317, 2570296632, 2340731830, 1704320439, 2217465736, 483270163, 433273029,
                3463124152, 2858495981, 2293137585, 3765138357, 2050975825, 1062202999, 2389813229,
                327867315, 3524908521, 1060359725, 2437188567, 4037791947, 265987565, 2531318664,
                3789582609, 1036190383, 359313632, 343266182, 3818075324, 1483429641, 3251308104,
                2231865653, 2088816062, 1363097078, 2619396780, 3922946100, 2087714470, 2714841575,
                313007644, 3053385186, 31524825, 420269932, 2184870970, 2633967376, 2976557270,
                3907847269, 1704768911, 845456817, 3013183512, 673429122, 1088006999, 4254909288,
                3477532731, 2633706423, 30604022, 381299887, 124029095, 2146491520, 810411389,
                1842896686, 1189234944, 490339649, 1115698075, 3923320995, 2822835404, 2863188964,
                2041216097, 3722786391, 1411085302, 643395602, 1892259907, 1276564050, 92834220,
                2113523130, 3750780619, 413882810, 4162989, 2342682023, 2496728931, 3765633586,
                1201219647, 1509483486, 1571999425, 2150766213, 4078947670, 1554603889, 2829344380,
                915004628, 2209136503, 1860939599, 1336190314, 3883277228, 3526987435, 1959059220,
                2644428109, 4106090871, 917923267, 1544296685, 710190597, 1252330700, 445060090,
                3748836645, 2225146599, 1869685424, 2948785336, 396398905, 4121416478, 120806631,
                76766006, 2336284840, 2353857164, 631928490, 2358081096, 2401392404, 1781483930,
                3507012756, 114196273, 761825995, 1747713254, 3582101597, 748625738, 2646455218,
                2905499938, 3230684494, 3213162530, 12062405, 2034846069, 2240074509, 3895726666,
                1559793991, 401560906, 1188895923, 3908766043, 3080529735, 1723996093, 3234235196,
                1524383480, 3006010429, 1021800042, 2598013312, 2404289459, 359714242, 2353150857,
                3214159696, 71259951, 3244867195, 1475212366, 1519569068, 396867142, 1704063457,
                1255619835, 1809747439, 2455947434, 2914124280, 490937656, 1909042102, 2425011492,
                1653816077, 1744426598, 3540268790, 1266922070, 3157358103, 764478931, 143507967,
                4138193217, 1618357750, 4064415341, 915914627, 379606079, 1684722693, 731091210,
                3441411920, 904319643, 4101866043, 1130761207, 2746556498, 2962076734, 2459719176,
                4014414287, 2306516630, 3241923533, 893098894, 155104880, 2462450145, 3698302787,
                2611896162, 3483738489, 1960417753, 3190054039, 3176206866, 2149242647, 241842249,
                3791458236, 266968864, 653002708, 3295229436, 720704829, 668777771, 2920041289,
                1616327007, 2614675119, 3120745852, 3703698323, 642045983, 664497190, 4138076932,
                416801804, 3836460143, 2512697726, 1321118683, 3790475422, 2372618883, 3906311778,
                3636945722, 93045717, 3245150294, 2203703812, 2876544088, 1482347470, 536620593,
                3055935093, 3219276551, 1736510361, 2882369741, 227297457, 2287462988, 1314417701,
                2698591585, 3562176889, 1108866670, 986625362, 3935882051, 2153826689, 4088091186,
                2094026213, 2614688936, 4293577301, 4053305951, 4075217449, 3960924855, 347332803,
                1968625524, 114389475, 430194382, 3252648209, 4018348764, 1840000995, 1589897244,
                258799598, 1737020958, 1683355155, 1473302633, 1904664311, 4282826162, 1231154140,
                4030919851, 1206926359, 3663795445, 2379135003, 303432555, 355307489, 1769635102,
                2552468836, 3490641321, 3099203148, 528813020, 3258352325, 1295334678, 3143722334,
                1978938927, 286181973, 2742706533, 1605086426, 1943464059, 2101290175, 2169564592,
                2507578488, 3835864045, 101762307, 2100748227, 3058433907, 3335629628, 2214316788,
                1268535268, 402136621, 1768704361, 1113090330, 3771703632, 3647202551, 2716086257,
                1380543566, 888137953, 3154815844, 1427117965, 4171112788, 1823391124, 1935813073,
                3498407768, 2295745053, 3209451097, 3427436731, 1760982025, 1197278449, 540450594,
                3647987196, 3703306058, 1018206619, 2476714098, 3182222236, 2163415625, 1564991911,
                377612233, 1240138195, 438211, 2660780499, 3842090366, 2254892076, 770175200,
                24158863, 2695586572, 1592642609, 6566621, 3696323406, 545103586, 1539983422,
                2835737393, 3243834056, 1307518947, 1449819027, 3732497678, 361142215, 560917662,
                1000073399, 2993529240, 2447753259, 277468387, 2097588385, 2296579141, 3491393176,
                593689188, 3981379323, 1199729884, 3155291067, 3484678877, 3241832730, 700414265,
                1991308981, 4120895059, 1897048619, 3149808222, 439364012, 344761676, 3062212838,
                1283609663, 4033828278, 1778135949, 2420787257, 893368411, 602240535, 1331176104,
                3252174301, 2911796787, 3606169310, 3656396589, 3672036583, 2975308991, 3008310252,
                1216481017, 3571455814, 917390807, 3398014016, 3881198175, 3246069043, 2018429161,
                2473741365, 115107297, 3264952157, 2580209049, 36273546, 3206338009, 305508401,
                1376925433, 2056571909, 1019775170, 2706062024, 2901924304, 2190222733, 2740737267,
                21015048, 1250529961, 4189046693, 1010891679, 1852727754, 2130616276, 548460973,
                1990672906, 1047266283, 1377617303, 2745241728, 3579697777, 4061895368, 2785622772,
                2769532205, 3150425811, 210098228, 799917387, 3243975475, 3585288930, 2961830047,
                3048068800, 3653640841, 3600794853, 2717549000, 2701285348, 3943817837, 1093998117,
                2069876461,
            ],
            &[
                1904169149, 2631229056, 3049906843, 1882970882, 1342610636, 348735230, 2030868119,
                308972916, 3291280440, 1713067370, 798189929, 267083738, 1426325271, 1400323459,
                4220917798, 2838399613, 2788016416, 1808463064, 3797033758, 4019522812, 2732377100,
                2865589386, 1858695675, 791228146, 3278919839, 1007346809, 2152870094, 4143135690,
                2156969365, 276568681, 768119249, 3720025676, 3691488609, 2122964639, 1090037461,
                1573203071, 1029758226, 512965488, 1081406960, 3875174920, 4202135603, 1561629768,
                144375534, 824852270, 2139340951, 2521611777, 617945581, 1174393067, 83560822,
                3171084584, 2743715748, 57600123, 2500345583, 509310341, 1466707920, 3965654944,
                1780152208, 2543890327, 3951358979, 4064884222, 1148693723, 731908693, 2303119198,
                2162132555, 3899764661, 4062906460, 2910202154, 3507799436, 3049585561, 1547101764,
                2240591447, 538691646, 3327231079, 4101167722, 3558467927, 632232393, 3069596916,
                792109379, 1443377440, 4063660922, 2403295483, 3242450069, 2054813912, 3224639109,
                2116127467, 3510867445, 4131878961, 554538806, 763384993, 4028933429, 784809516,
                2188214742, 1245086980, 232165771, 3893787601, 1616832299, 3354660858, 3756152253,
                695071424, 3616331020, 3728930728, 2300889664, 1134765807, 2568071856, 2230185436,
                1313073173, 3090697900, 2811549719, 2626884644, 3174004164, 3418927780, 1459400962,
                1170992180, 700259624, 2882894395, 3735934167, 64057275, 4285443281, 3858505044,
                3530830770, 3881898558, 1248666153, 4057784557, 825094518, 3954584560, 1379703941,
                456663582, 1936817375, 2100203590, 2269578911, 1927092754, 2056845231, 64996052,
                3180336408, 3382367590, 1579799629, 369271331, 3393685503, 1678462084, 3580453071,
                3344059212, 2603016988, 1704438831, 2960085271, 3944849185, 1984458477, 3159618129,
                1356105311, 3061973253, 1169634390, 1581525372, 2092399029, 3856589897, 2747272433,
                129370532, 3259112907, 2392093327, 4224720237, 2467960903, 3012864179, 657311189,
                792107047, 3702308235, 2589079343, 1977762240, 2054656079, 365049703, 1136316952,
                1766336156, 1574143327, 1448002399, 1545340743, 3343582998, 4266810491, 885565293,
                1012325697, 4265244667, 4164478481, 3171829328, 3052840557, 1524972073, 3381586754,
                3989036728, 1081734627, 3737298307, 1869630638, 3072103206, 3329790326, 3520758799,
                163463995, 3179586285, 2504600081, 2392849343, 2696495366, 77291649, 1524994513,
                4129364215, 2589017064, 563995388, 2948622336, 3478580619, 1302885151, 1885238682,
                3399987677, 3819885284, 291981185, 2438308465, 1131073201, 2094997380, 4030538680,
                2493835385, 781324886, 780626834, 788047573, 3251459753, 589598543, 530167431,
                691366057, 2997152103, 1895699987, 2067335840, 911810562, 3044146727, 1981642612,
                2744164616, 1268584352, 4091929647, 739635330, 2535146835, 1232134198, 2821166834,
                2694137328, 1845150759, 4145746520, 1570842207, 1877662863, 2624263192, 822008531,
                544782319, 313703935, 2549594582, 1507198513, 1165274204, 3706172942, 1025658022,
                1367415969, 3754039309, 4187050684, 1116191986, 1599395850, 4255758850, 3627566792,
                2013052489, 3678795519, 2570182055, 3933838202, 2878788816, 245983387, 3805875941,
                156152490, 2288310229, 213932492, 2816431456, 3032792377, 4098973047, 1987668121,
                2178466333, 3171514186, 1824097633, 2477633111, 905563455, 2561821790, 1164919073,
                3346223498, 85587270, 388762173, 2830714978, 587416024, 118417479, 985918121,
                2869840425, 1942696561, 1447188301, 1252144775, 1754507324, 2995197874, 348722845,
                1994558236, 3180590158, 3621098260, 2808142053, 664847652, 2216211159, 1812881783,
                3652176793, 1818451392, 1492863756, 4248433045, 1393154835, 2899742381, 1639554680,
                3891616188, 1401178839, 155094399, 3335589331, 3242149447, 1506620207, 4025305548,
                1378564899, 2250748936, 3892206821, 2999250953, 2404072212, 1227092115, 3842156829,
                1175300589, 1366215256, 3655797370, 555970590, 2216476284, 356175930, 2316653842,
                3511159891, 3242198801, 3709284219, 3992609721, 131038128, 561182178, 2366328214,
                2169412954, 1843648386, 1596245006, 590747798, 29988297, 1032233337, 4148540805,
                4287292895, 1784151615, 775442479, 3254055272, 1319462308, 1998762911, 462052502,
                3240867011, 1529884215, 2445458752, 687926411, 320372384, 1993875140, 1103187463,
                1101261370, 434642811, 3921005377, 476413110, 4114908941, 399340969, 550419121,
                2138268102, 1961648534, 2475107221, 812733153, 1013882638, 804382040, 597969578,
                3969389037, 1681594804, 3597283127, 3246865960, 2618922824, 2412709123, 2883379189,
                2268836289, 4041631960, 3932960611, 2819242006, 3434298940, 1965495785, 1801489474,
                2483685757, 525486136, 3103413787, 2524236016, 3297675542, 4250105246, 2163911845,
                868191034, 768077954, 1251877129, 2082725352, 2563716501, 324144134, 2949337083,
                629793518, 3585348714, 2283159799, 1662388577, 3211992651, 1893003272, 367507404,
                597480849, 3530706203, 2180056290, 3040505611, 3393423843, 962401948, 1880350816,
                1059318370, 2185874635, 834999744, 976189277, 2214236591, 1042067189, 3972166345,
                3379537993, 4180308634, 1894580429, 2768917877, 2304053036, 1074132791, 1172385654,
                3558332507, 4118553815, 1144817158, 1932880741, 139994662, 2006231438, 1878531442,
                1451662501, 190676819, 2374814207, 2111662756, 2422642399, 1219123380, 1437107644,
                3325772043, 803974620, 599430876, 2919848672, 1661638336, 1841139086, 1961142950,
                3330180086, 844957898, 2211184671, 1097521602, 488948427, 3209202495, 3087475496,
                2505815200, 1915071794, 989106472, 3460765890, 1592714830, 1577504527, 544612468,
                527148798, 3186590344, 2423036586,
            ],
            false,
            &[
                1274629765, 3141211094, 3066783437, 3586463614, 3484042397, 3524692172, 1849759418,
                639170343, 4042051785, 1786641195, 2781936314, 598559471, 4206822552, 3076839520,
                3426707763, 2541903555, 3985517971, 2924425523, 805503712, 2235352830, 2985073687,
                1986582861, 708824890, 508981633, 2929420962, 2821655200, 1435071022, 2815105969,
                3064101020, 669540051, 64719297, 2298557985, 2663556386, 2872778448, 1920581662,
                3964906867, 3545183326, 3734685799, 965493690, 2511488644, 1289889793, 2716496762,
                1482707283, 1243240515, 1600220728, 3386832682, 1230771057, 1851371335, 962673373,
                3303433511, 2971821380, 465715438, 1476479395, 4210224292, 3326701593, 262885511,
                2623286176, 2785619040, 3631756223, 2689408595, 895184011, 3039724640, 3256518757,
                3157339284, 2736033980, 2623616149, 2262942125, 4066660566, 2010739028, 294414070,
                468536368, 39081857, 488790327, 2978306577, 4076063380, 164990706, 1769246328,
                2404180723, 1910734795, 1212674812, 3651413973, 4107687624, 3562008089, 2495538965,
                1060913944, 700681324, 2213076011, 956710321, 3766900265, 1201745400, 1689241027,
                2023383937, 3309067962, 4290293260, 3262071778, 867200275, 3722256414, 2704572302,
                798356854, 4060154398, 2192265925, 1631346682, 3841392362, 364742914, 1350896170,
                3826205664, 1387850479, 2438144424, 1722720699, 3355734439, 281374639, 4294332167,
                2848655781, 2650822950, 52206106, 1267368119, 3786144635, 3997971973, 3766740222,
                157940553, 874086492, 567057084, 1468392762, 1319013026, 1763094857, 1258351011,
                4219111833, 2069011861, 1508267766, 1742493547, 3709667481, 244137977, 3867904379,
                2749217489, 1901868294, 3141009904, 1334349455, 318703881, 790854628, 2456409186,
                2729035424, 2140696710, 3057979010, 1943182218, 446440787, 3044060750, 3377747126,
                2650171384, 2030143427, 68841182, 3417107910, 1982395041, 213127592, 4263826627,
                3810676045, 2815565679, 4215729650, 2424656131, 2427868488, 3538613128, 2004058276,
                3156863142, 3493891883, 1282367517, 4021690990, 3880291659, 3234626473, 733983061,
                3094727704, 2181100156, 2419795021, 261213792, 1806943490, 2451407303, 2727992941,
                3870486736, 2318523062, 160305854, 3405051241, 3671726857, 3273962892, 3354100289,
                2703913540, 304014061, 2416130602, 1740666524, 1270481586, 829357964, 3389415821,
                1783014510, 3440915536, 2186635473, 1638518047, 2861195291, 1925018981, 267706283,
                1852657873, 3918895473, 3639936236, 1540281136, 3992865037, 1795928884, 535725314,
                2620251512, 3768070603, 342868542, 2807296004, 1944907465, 766931863, 507809586,
                1382623024, 3748022748, 809199766, 2606119767, 440758364, 808682457, 1891522267,
                2798966179, 1932040027, 3544577672, 1613760857, 2497954981, 3761568437, 2673674694,
                2267348907, 2169995118, 1082902734, 1924288552, 2560273581, 1328627426, 500474681,
                2740807968, 1058091958, 4193976709, 2145630875, 2850935242, 3475556484, 1444110200,
                2094948501, 3669224179, 3527535779, 1309727297, 3043349576, 2800927336, 798778876,
                2615924118, 1736199098, 4167626369, 3609129416, 3696542059, 2660961906, 3709573368,
                2742620902, 2002154977, 1840222458, 678539421, 391765530, 3711225631, 2336471984,
                808858486, 2107964482, 2120664214, 3475065201, 3782915227, 2313935531, 1140567569,
                1920486212, 469939343, 4127720462, 1046677730, 3365009246, 2650242485, 79281379,
                3069462836, 1131058884, 1346966266, 2182389628, 3425864155, 487991612, 4274615916,
                3585882986, 3882253255, 3299152123, 3923136894, 4158963676, 1993380396, 3025592126,
                3697510913, 26996074, 1666693894, 4128726650, 1349974160, 1162680197, 1002804513,
                2192715135, 3733784449, 1296058713, 756389024, 985468845, 1910174731, 3512126196,
                2889051038, 896547684, 1052365249, 1712208218, 2895783918, 4015271697, 4194906302,
                1607592000, 488260174, 1247101503, 2635736706, 101416663, 502456820, 3004088397,
                2217260735, 3689763077, 2750526303, 2814008209, 4290490637, 459845084, 194661656,
                3298271035, 499760349, 1457282007, 1720527994, 283878558, 114686420, 207781028,
                2101242696, 2475285413, 4066549966, 3571095625, 1456774526, 1957825881, 644287366,
                859324850, 2429216562, 4069493991, 978462144, 4019464424, 269773692, 4086951598,
                3169184115, 3840130624, 997907757, 3420447554, 999500052, 2700308046, 53871682,
                1856963, 1188612325, 3393695655, 2729360995, 4101441780, 3357241810, 3598434336,
                1257477782, 953991428, 4060500318, 1564349166, 1626434500, 1259685422, 4087690819,
                3327437017, 1630386771, 3761712654, 226730056, 3668971305, 2810327973, 3857961937,
                3773132978, 2859864128, 1937028826, 1803313773, 1721171315, 3641809479, 561594878,
                3883288939, 1615573909, 3567576946, 53427597, 3447054169, 924172132, 289810649,
                3166741000, 991317667, 72203781, 985172668, 3013352759, 2107570161, 3250293704,
                4114482787, 1050030772, 1057622762, 3438626748, 2519260970, 159154610, 888655185,
                471817829, 470991380, 2525869562, 257437760, 665926900, 2709862184, 3205674228,
                1381649365, 1803460892, 4134101678, 2543649326, 1209534353, 1226459212, 3664518300,
                2168714963, 3110951542, 2920091469, 280549216, 3763064171, 3139277729, 2961240010,
                3997887886, 2249335682, 4125195068, 2179174964, 4200864330, 1948058108, 1468274578,
                2376503735, 1402764211, 3508183492, 568398904, 3916597152, 1316008321, 3354808565,
                243276170, 383567360, 3854059575, 3533629121, 450497668, 1613229695, 1579942631,
                1479512959, 1708803214, 166236912, 3371361562, 1178374935, 3631449184, 1044231267,
                43160759, 2872462763, 386332526, 1454108301, 463466433, 2881621607, 1902397631,
                3675190003, 3262456635, 3682680678, 3921732891, 1604135368, 3949662129, 3129246190,
                1954536251, 1538666313, 2274928374, 1650180856, 3652524428, 1821056613, 911456961,
                840333318, 764118487, 2652399697, 2580502346, 2438391701, 2513677855, 2640798083,
                2778108413, 3625988619, 3121963132, 2016358782, 2026634297, 2454141008, 3719526468,
                2069512197, 595695222, 1372551058, 2654832919, 1312895472, 3449972978, 1039886392,
                1219309116, 2158257939, 161673294, 1466523266,
            ],
        );
        test(
            &[10; 6],
            &[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],
            &[3, 4, 5, 6, 7, 0x8000_0000],
            false,
            &[3614, 4294966768, 4294967005, 19, 22, 10],
        );
    }
    #[cfg(not(feature = "32_bit_limbs"))]
    {
        test(
            &[
                1976632771194112527,
                521304770361505402,
                6547459063177486272,
                16111887222588973398,
                11964828684918293857,
                9728747614510340318,
                4267206348672680192,
                10832398719275582210,
                14900216064213533822,
                6380760676681064593,
                2849541272450836814,
                18142033108417998751,
                5641128336349728868,
                2535172385342350806,
                15911904441417898191,
                9084408705773921949,
                15744864820799189887,
                4463837653601785361,
                2987490935632187606,
                11223238737559450353,
                5105094309856727876,
                1009868354752173181,
                13484596105692600309,
                238858926646454289,
                1059132889701728020,
                15279567309856499035,
                517773561239225477,
                13637839145813400305,
                7302869346647374900,
                1151876675162026587,
                9504208398199632979,
                8612638565635453711,
                2164322139068363749,
                15512475459854984520,
                6875534824714840095,
                16955948007577516702,
                6471458936191368235,
                10654427325707436522,
                15337657345435735346,
                15231031327469377800,
                16046593431914105744,
                8712679690677372756,
                15831996438112202870,
                14225387673292899684,
                17347546671830406364,
                7848557880774740728,
                15226813436071672038,
                14096480347669118219,
                16389437176481235757,
                7980211852778477130,
                16446026267287953606,
                7958418492797069881,
                2213403156236979508,
                8758841210279886543,
                5431207818821342199,
                10995901604046539947,
                18335471104239998694,
                13564698255420469178,
                5867947764049999258,
                1175284037301014819,
                12349712146059439945,
                6688979957099199180,
                15522195128263747693,
                11640494562411680106,
                15737920193718148078,
                3117055011815888766,
                13625786892636999921,
                12946533130762629275,
                2401319620356150536,
                15224229761057707791,
                9402116507951822726,
                17081785103310854839,
                18332791217613728290,
                400494137558561035,
                12279775278166901330,
                3814281798348375735,
                16512813422954004929,
                15443554440158194522,
                9668157500068914212,
                6053490056859889986,
                803053277491258716,
                13646927161616864743,
                12206129576276588469,
                8174515000911774339,
                3036848877312472711,
                11063940183681869708,
                6310270877191259165,
                9386179633193645060,
                9559132660384619200,
                8951064714492945869,
                14166616301229473652,
                13071629188826572782,
                11853790173693535149,
                209636673262143030,
                10441446179239151884,
                10420612973148232000,
                11908054025560012662,
                10909003530238644740,
                5352309958024461387,
                6231231241710103495,
                5817566191981122394,
                9966557507113270738,
                2526734084799877406,
                7119546382209824917,
                11004099504334912785,
                17101894178044846313,
                17623127824006159278,
                8521084772968581318,
                13811386822752437212,
                3432971939926452639,
                9600964573924347046,
                17748647615012039077,
                13689755186761681519,
                16574316982652951580,
                16782416719434018360,
                16144163416834277717,
                2756565693629327141,
                8059306003700661181,
                16267666526611427826,
                11909795646086424444,
                943806121593842977,
                13457826244859784108,
                7239747548483360443,
                16749825534693166168,
                14426083390114861929,
                17648467062688582919,
                15758353298227492958,
                8404753209561230712,
                17152753483008477565,
                1709121095849985814,
                9192526565401365977,
                5811560381076741655,
                7570776248350537723,
                10727029289681698856,
                10402933617834546815,
                8318965057148775598,
                13169231870647857793,
                12802647644833789786,
                3875248944583119534,
                12821268270102906356,
                6572470769294941231,
                647608152449604156,
                1871144685026941083,
                4032548946127357216,
                16395335442808140376,
                6736436429481567066,
                1079601411786263878,
                2504995255059825437,
                6763393428021343788,
                7715029394801749110,
                11780543684841254832,
                1383809532223095584,
                14972882189077591253,
                7800448071104479686,
                789117789337480564,
                14240769726663499540,
                11053104839957580124,
                14698906095810695206,
                11960947912669574992,
                12154539497540266947,
                14003595352222612163,
                9605483083077043861,
                1678324429116079639,
                18410093395270606595,
                17901794159659874459,
                4555659564807476615,
                5907892309603612114,
                6524803775567674587,
                341147093193233779,
                12996396640449564521,
                6720226112934991484,
                2388493664120597295,
                4290799651574648025,
                15852556922046266402,
                2246578851767626469,
                2920616190359978,
                1995918845898424965,
                10100917236583320084,
                7326568532476915731,
                15216155190727196226,
                12275242131304351295,
                5999272749153860391,
                16885847068579318746,
                2394902793719864009,
                5326879392776369400,
                15621103453348562573,
                316702208555392711,
                11540860887565649468,
                18366619672720535993,
                12809248756928885140,
                7645410389657248491,
                14015340112675676632,
                2512410450534100064,
                879480154877772022,
                11649289287186823201,
                3763895355294089425,
                6070847093240149275,
                1985095235894032224,
                6801453453040268360,
                2577579383099711197,
                402372101655687448,
                5644686065835595838,
                2514710250566535253,
                1911966914948814254,
                3687058531887005876,
                7434246748483727789,
                14122808689973017488,
                17766089471795036547,
                6666390546144059621,
                9594245591763828251,
                10442127131744522659,
                12010358916814662429,
                11623966019504805712,
                12883088750499797281,
                15648374317449757761,
                7443275395944491151,
                2162931565418953025,
                13144859518518203320,
                14371376174232659599,
                14565951115370759763,
                7113822803057100738,
                791629390390021149,
                17035680947686192637,
                16117534524053580299,
                16569219763811788776,
                12157015834931780538,
                10769346653748666149,
                1546686602678137333,
                13300226369383179632,
                6100259704952035034,
                3072644701407984585,
                4030070721794724661,
                4784297440480155258,
                8207888015979310860,
                7318324394866297710,
                1188255145714469504,
                7497067679833095894,
                831722367483141911,
                3342006775070786183,
                915228369324832271,
                12214752361799071858,
                7220077330608179732,
                13269901002361366384,
                13156705894018513856,
                14069485524218015587,
                16856376646412467543,
                5458014833622408772,
                16052033690985477131,
                3853276807297699899,
                4361733283329901315,
                17976611431135375864,
                7827211709974023187,
                2672179408451719014,
                13336920158316088067,
                13989361937721365460,
                17089134261482111299,
                717462569675369116,
                2677140142520744762,
                12527274888132316130,
                16020437139419307993,
                5109175831372656675,
                6967613605928103302,
                10707316610802880961,
                3751977410812504643,
                3338250566945759407,
                5483469392473217290,
                17852350745219193880,
                4273571006338555810,
                14355529799772896463,
                9097946801457959042,
                6170305947438052682,
                3686031910837362999,
                13659812758484650695,
                1078072280470978659,
                10977423862490226031,
                8329312879062820322,
                4304430845375483198,
                11670535966145436284,
                9843819566701342756,
                5423791105551635377,
                15484617895300773730,
                11737838788253883653,
                17352638972287011361,
                6417215765954491552,
                5210838541415799099,
                14459766465462519223,
                11293780554786569855,
                3913456812295604968,
                10038604499286389380,
                83285032545623676,
                532455486041684132,
                10447557457915823565,
                13091470210751298878,
                12472561867327718392,
                14986754996345557860,
                13353714167702784729,
                14933692721559793075,
                4392496650147061013,
                14233597247368097070,
                13776324136360206128,
                2519461559911558060,
                13447307564192855696,
                17414679919154962748,
            ],
            &[
                13564422861878112234,
                3275713182933072863,
                9034480898755624920,
                2219243711863369707,
                1414795403602489063,
                15894568837862895798,
                5479009852840249103,
                13548176561971981614,
                7335026045847382779,
                8888321385565889284,
                1374250446640957676,
                884800927779782031,
                8670348570372777926,
                13918154801540915789,
                10563048209614776992,
                13969791730415477716,
                3452835315790744420,
                7707311332988117775,
                4057795468009662220,
                503791220336896693,
                11739899866722757790,
                11508632709875839378,
                2046257727824251571,
                14147378955881967537,
                7621816326428068081,
                11992669611664635262,
                4065021093573908389,
                10481004349510473318,
                10475301724256756509,
                2524130821276975109,
                8593134939742261716,
                15623538309287845872,
                12317584420983773918,
                13199980610882090215,
                13443389318588629073,
                803739730193348834,
                17830865805659102381,
                11251151180776149719,
                5892904253365508433,
                17425282708969635181,
                7064424708573252994,
                11602656136970912939,
                9321057698061643115,
                11015344462881106465,
                10461212970348321643,
                14132875754655537304,
                15753277783360549383,
                12320964235023516733,
                15957290977412221921,
                15001559471941651986,
                14955046884332716974,
                10073992907091554325,
                4815480386394792639,
                2369717258966377146,
                9248685362922918367,
                11146342741382934626,
                10126995575484511675,
                10836902283955631137,
                18212311536097636051,
                4203660351079577016,
                7620879273947445884,
                3547199160053636344,
                322234022833908928,
                13570629391930072285,
                14555015649158595870,
                5365173841640051462,
                18270551664241964745,
                16860982171375384296,
                1073487768765270579,
                533079099712269200,
                18402112985722301945,
                5434269089519901126,
                13639392734635113987,
                8006521979690287885,
                1545872313913044683,
                15377554075787870730,
                751964771297808412,
                10798750359921054639,
                11281008050931496235,
                173570012084088260,
                3794273797618100167,
                7040606489685125833,
                2026261595126825272,
                4120208834527743861,
                539222748500084412,
                79750673604550443,
                17475108564705202581,
                7592139295506453445,
                5023893374592386852,
                2824914523935320076,
                3238624402000298552,
                14131756234617118206,
                8788539332133441603,
                12952024446070112298,
                10155295021066454828,
                3941570600498808512,
                6414922728964194522,
                4076629519262102829,
                7536766196851355087,
                6915125713337987783,
                4580280718549432890,
                10168080122054976212,
                15909510579919558189,
                14519226511270844173,
                2083762604858883168,
                13387991133148007718,
                16840836457014280191,
                13080359029893923590,
                11503510372644227919,
                7953484793188318118,
                9854115240624462348,
                5335772307682974862,
                4936183703810019894,
                15994627285462031439,
                10709370317657097612,
                16199196738320076993,
                14938272361213950876,
                15253370694640585418,
                10690065705918307042,
                9549292542903499984,
                8643187064435534254,
                11624928373665837384,
                8023398739766654926,
                17499066444790402375,
                9801044615559621440,
                14552811277630127749,
                13492161609355707245,
                9655752034551803175,
                1755722784425137866,
                11625636701478868329,
                3624227495361674626,
                16165268009822921837,
                8092810235043787525,
                5788572199295079813,
                6854648148487456329,
                14456461148456692547,
                14310121083997049160,
                7059162200334339773,
                14727298439147858639,
                2177197582567289597,
                6545559818086725189,
                10527371808810639250,
                4564586802867503950,
                2652020551780949632,
                6405684903154669518,
                1737731788352731098,
                3469893625756210544,
                15065635631347129418,
                13174028003011531358,
                15454741792218022113,
                14370595360570179099,
                18037934040444240682,
                2964154747013421979,
                13884952913031178416,
                597641522633545753,
                13985314547491780345,
                8360203218690496165,
                11794669667587913233,
                8996326275940748604,
                14117671113926503561,
                11301961759403099265,
                6700188071922378791,
                15385674866154542642,
                8468030983307924915,
                7377911706704156399,
                2604656541341801794,
                4418057625951919598,
                2110519074747192474,
                6101102874337817025,
                17886250954206311063,
                15712345996698736982,
                10487961467211158758,
                7074394084984481200,
                9751971849704663337,
                7679893214057488711,
                945225664530152672,
                1245168954077749403,
                9513611114031241898,
                10766452668861159380,
                10755131449239090448,
                16388278488885030616,
                2817843987791967489,
                11763453497935146995,
                1092574082244810895,
                1941447274495784860,
                13572786039056178918,
                15061182291913076311,
                6679943993103806154,
                15408371401907582553,
                177747470770242167,
                15593976009786423347,
                7461104255684909887,
                5044076910420087327,
                17630612657815416743,
                15051698319468276092,
                14951988637957301647,
                954336914910981662,
                10967373098940345847,
                2121680414874388243,
                6976201562796491998,
                6607602757564910564,
                2432806802785175299,
                11440086710224789398,
                2224788034891182999,
                5665602195014987730,
                3821334059850073126,
                8765713375749646572,
                933515038511209109,
                9433768612524189229,
                2467805208666126785,
                14871840927317419092,
                5154749137613554029,
                14265822875736809648,
                14610870159067374513,
                12698797236213924014,
                9569606658962541579,
                16162107306292390178,
                12212893918580781835,
                4614977216445016679,
                1352141803214945397,
                7426333917406258422,
                14520946858416385440,
                12446204685829260164,
                2067433179439046305,
                10861419565872522342,
                15042750574419434699,
                8969751642165063673,
                2375359711870752032,
                8547092847092151309,
                3254399133444460923,
                6176880426174028076,
                1267184736498266698,
                6443556206710696839,
                5582660421956028475,
                2003441447753754180,
                14408039201078176692,
                9878715208788868318,
                3156012596211387511,
                2621328682710618956,
                1343996423359983728,
                1659922365403643436,
                9104705095152231651,
                161254471946633022,
                17082420100696680164,
                12948458999893309534,
                169193814558716113,
                11181197557527273709,
                6214014612630290060,
                4852610222569086650,
                4759907655510719027,
                16416424951651935524,
                977804021685057099,
                11673776803881765160,
                4922236924628996318,
                17921361428612029549,
                9649330011870916482,
                620643376032400196,
                6391102220914894427,
                1331509376533438689,
                14618159860008486331,
                2457140428084980479,
                14239221334508169296,
                4552842402472365258,
                13656369860726864138,
                15616197149307562605,
                4979886663474976519,
                3721352528085365632,
                10207378704552161011,
                14450395034610232613,
                4394727065169978678,
                6225996635016717724,
                10125465703568602374,
                12627017260126529357,
                6034795013566274191,
                14507135436863373853,
                670092389362258666,
                16892179404337461285,
                17907525342655368510,
                6388033394429406697,
                14608221204689506984,
                9725811389591747512,
                15841826865041066838,
                12726453974670314753,
                5294708137059751589,
                12939898091011681833,
                17545561031992221346,
                12940997953067270813,
                8668645445261571392,
                17465976365740637310,
                3297459757903247617,
                5595819579374915626,
                4255310297204286682,
                13444083690317354200,
                13079687451729978985,
                17936788196509077492,
                4731803836376614325,
                8488258826257443557,
                15872298653522164970,
                6136303961972758860,
                8203587474223770207,
                6640840421159816678,
                5369017699494121011,
                13476518943592512132,
                18148180997156310554,
                16551428108902177352,
                10607422095455667650,
                18070526307796619350,
                592194588928348733,
                9500655832933342555,
                15906694991065813017,
                5672170756115546545,
                5164713544570924308,
                9654099190010511616,
                15467930191553249033,
                15324226386462646310,
                11654051669492811942,
                3845504882613220875,
                17995014637765041183,
                8451419834021139432,
                4831660661140974858,
                1270713005767677247,
                2854249945191704862,
                11336191586387214070,
                6230352080584748033,
                9904554377773225787,
                13646007744312337579,
                12876135209922183651,
                5590478105512035067,
                16683787122041782881,
                2912257455736462263,
                1161124723702057201,
                14599086761545813923,
                13759995150092530098,
                1187669969167762513,
                2025210147021211292,
                8404792573797774696,
                6043699170259360346,
                8567182735917474580,
                11673587056707375436,
                13729589792471955572,
                6040294236876235718,
                14118883879821257022,
                1472762515001555634,
                5772607514220590032,
                12005167700240721094,
                2562574981556592924,
                4322916215476956068,
                2931397736166450113,
                1981334131663903720,
                14008950785795439721,
                2258367698152396200,
                3193592957432138332,
                18147159661113326998,
                7636102688703700127,
                2455873680142820545,
                13327423214878219110,
                12145648468670490988,
                177980942656438245,
                7435164945754514167,
                14611156817208949574,
                9482801842425137904,
                17579649951803679316,
                4395194171697397116,
                2246099311908860608,
                2326078108126869227,
                11810587602203652970,
                16265527186229236462,
                4210697026328134418,
                15046104816787660106,
                5661711221409653164,
                13045157006959773220,
                6999069520359938726,
                5808420710659641279,
                15787347158818842535,
                2851830421850001378,
                5525485631561271262,
                711754543881977867,
                9906329062827899634,
                13595975648907914352,
                15095498981812294732,
                14827890138173702931,
                10114436220688049709,
                7728356353192609902,
                11254468346316497641,
                15153773712001763014,
                10207835043420703649,
                8801897675976972272,
                2550825610727592889,
                4806829881527541342,
            ],
            &[
                1408954216269482756,
                17495363275392015072,
                7569538419880562930,
                3159444535690624422,
                10539713616310108624,
                12287759471187878632,
                10762226695213450386,
                13702928698805429873,
                9308039037015276334,
                2693272575243867415,
                4495731759682297278,
                17957718702553480973,
                1695225019270301796,
                12538720478819195709,
                7355696648235750501,
                14609468359145504152,
                17713212205059712263,
                7067761757765748297,
                4455678910009476432,
                14940946772952633580,
                7353223946372247705,
                1966704175929577612,
                17788828899639927690,
                5873642145421053485,
                9432511011769375502,
                8011456734513040486,
                18383517818628757190,
                14804344175107599111,
                14453706668928035575,
                212174636863869640,
                18318201713407159667,
                15868508625313800988,
                794570724775389143,
                6890250104153732120,
                13215618552493662151,
                15355712080025289288,
                14989269405365678703,
                3440332781177776817,
                1547041711400466409,
                16949408083533983339,
                942645885575525869,
                3593963961417655151,
                4158508676658397508,
                13468348757333127520,
                11862936891535571513,
                4377454676311890507,
                13780065204467937543,
                15803361323352221769,
                953489208716892192,
                17364437917524369478,
                11384216985369504647,
                3360175615399279011,
                7215910295314039412,
                4449007827158713949,
                8690290001027040683,
                772293093052269703,
                6926666182768252467,
                7985255216129545232,
                6665284360882852586,
                15207741179893001845,
                15703767897436764321,
                7914253539478783255,
                5903013543557664007,
                4774214457440373599,
                14080179030683024826,
                9434035144822929636,
                5367813517486193633,
                3304878828952757511,
                10243535705902406930,
                1884627861659715947,
                4978189310017102374,
                1216698964122740709,
                15100941079818973803,
                1749141348527036567,
                8743320843818547513,
                9958778070878908244,
                7858295599866849905,
                15078222426471283656,
                7336868524011917281,
                10555852968409722407,
                6944256015177961916,
                17387864131687949624,
                632732732269768198,
                16900672962472231809,
                13484064257890193159,
                4044769021954392546,
                15294554445007953309,
                330214884931606053,
                8773227351193839544,
                9933428285510948540,
                2903959890557503867,
                6265719520493470019,
                14025203023893391008,
                11647283945890530059,
                13249598051183746227,
                2074546550971361923,
                12247825023511227150,
                2784768583222188866,
                6407637641382682182,
                9752576266849520115,
                15195951757710781232,
                13752087641373844065,
                15476511142100387305,
                14236723356162907578,
                10822337465577716429,
                12814664143156135314,
                10894509357772940167,
                12457195754516214135,
            ],
            false,
            &[
                13415846491005578619,
                13584292933077885365,
                441953663009890135,
                7210335717300495676,
                13057964354000775464,
                10292169585687982086,
                12251907425151490553,
                7386686741811236397,
                291437469999876541,
                1843506473757893895,
                1231339981456887992,
                7336311449497199296,
                7176633324357201366,
                658513238018005674,
                3117977571063681035,
                2261787922928337152,
                4069182574784670800,
                4786347950692670036,
                955338065659184695,
                17893231513983993127,
                15970449235194675852,
                18222079201306580439,
                7381385984359606163,
                13894071053001480008,
                17968185102194547794,
                9652567975385349040,
                4579378768094593374,
                2929413774035294909,
                4858585721157204024,
                432346869077563062,
                16632527599028610709,
                2969760407998231671,
                8723191162795424532,
                2205885763249224226,
                4090893610978417832,
                727335411538814681,
                692739901795118471,
                16185752384798441976,
                9407352218349207860,
                15954006133480937416,
                16002700437312273924,
                1803166211419435125,
                16572732079534009876,
                10103383220489568096,
                14055635057552795086,
                6204301430393608593,
                16304361060342210151,
                1077463458077785016,
                846584174947782921,
                14549143985217156839,
                4794451719446030954,
                15070589344871049989,
                11768766648218861349,
                193778540633917339,
                2069627918507475641,
                17004474480886564748,
                6387833454863576557,
                7403048767127663654,
                6361857152378524096,
                14590329534696373089,
                3264224706753004828,
                15794673518624161617,
                8471728032197957118,
                11123707683472607781,
                5926672570922373756,
                8353224757488864005,
                3920855214133136556,
                4088762124331852387,
                1351340558126331083,
                1064663312281497792,
                6722208927949900059,
                8191142535859454935,
                13932575231193375718,
                13250838834435891833,
                2482941775014508642,
                6361967846756283686,
                12230741962057003367,
                5322339673572617872,
                2461502783752535986,
                15456869581410217577,
                13516762109813035487,
                17722517240817407655,
                12006022535464060948,
                7693156444704391120,
                589139607677986600,
                10992862276542439592,
                15638442660969354281,
                6302046879465388504,
                18186347373545845422,
                17661768623582090594,
                11182202442217703360,
                10323032349274612161,
                351359225361309232,
                17208481651320700686,
                7762799900361196225,
                18130637050502143037,
                3527936976222881348,
                7787458878406549730,
                9785865244475232340,
                9313322536748638436,
                6628693715403354820,
                8155584772586242242,
                4298548228131846405,
                6216995875383402160,
                8745213713616642956,
                6205924554981340524,
                539046468165950413,
                9024163979699199629,
                7137709973749463062,
                4302338034003647906,
                13829701518024075554,
                3020599208667394924,
                2771484371923677669,
                1332418334924131169,
                15030111211658663300,
                8687405539746619117,
                3255425958083223853,
                17607580850311952887,
                6117457031153941598,
                9667238428907972490,
                16866165930381488058,
                9279876560625206616,
                7219817020774185353,
                15408311020361635593,
                10627051636551065581,
                15435960991076989754,
                2125427069228602466,
                14834800748267676770,
                8338000901565415696,
                9843107756445251924,
                11726258180166518722,
                13216133507413853832,
                9548542073000115784,
                4477904860207934342,
                11559138083775928810,
                14261941916295954455,
                2935454921278307407,
                14578760607502424030,
                1741904848044422540,
                10910867960823424013,
                16471597397244360629,
                5831225248121651892,
                12850983616913099920,
                4576475941872797279,
                10819576084838658923,
                9911449990461349025,
                8071318423647144806,
                12934895766920841548,
                1934332324237869529,
                1138130330895714883,
                7749002603757035655,
                6467404987016890639,
                11255316830064030538,
                3018235715458169811,
                15201809744582983527,
                16342498733210722843,
                7708152387679592258,
                9492172974580805134,
                5866422978520553541,
                16455719455662584469,
                13731761368830060542,
                18292973038079145164,
                9007521683809498606,
                11536176422926297746,
                17069970006150149865,
                2103718123709857344,
                9551485804718272266,
                12273976131107017479,
                1653874358479460972,
                10193109839436245173,
                17209319149808494347,
                2304536837571895652,
                6062765286861083817,
                4897491367356012054,
                10921490709194148600,
                7489492882796549046,
                15346457168511978884,
                15415284042926257534,
                3288025229571018975,
                5490937743897191968,
                12030244067941846502,
                6649465014690650122,
                13043829245604474765,
                16104656800587069133,
                15901113890052229676,
                3837090179127712297,
                2184801241947831767,
                14724333584011117924,
                18042748113599866974,
                15635242211549384225,
                11210521843889130992,
                9474616548314628408,
                7072588307383545068,
                7764739347402168434,
                6456269087620448997,
                13468842728337937173,
                10407803768686058347,
                58702129805853206,
                9751180010069185513,
                6064452714620219927,
                13392800693556694325,
                18372122025912817085,
                7516403896475345556,
                336160785595278081,
                16607869224650226242,
                4883984113455670464,
                7621647467206333443,
                7975633505870931502,
                10173870707804084376,
                15734058126402681870,
                13198172970791238175,
                6074102067907439304,
                7289841954562682843,
                16642477840387047386,
                17735102900144975086,
                4380312697910692464,
                17348779887199611248,
                3519767210720195345,
                3200318167890176110,
                8763164776273977859,
                6372373083461058525,
                7012561740996573104,
                16229141474971594905,
                1111767702608658668,
                10378536678592366267,
                9247600318566456250,
                17456358751309498336,
                8398075459962870518,
                398315841023187114,
                10277410686246662542,
                218781901157848211,
                618572494658903822,
                3804414506632334467,
                17482725095963661462,
                11945563631700693151,
                11377949134930807832,
                11388696917522764394,
                12397282866398662460,
                17984588793337249647,
                11852155346818929323,
                6282040579217154095,
                5865043035453987718,
                12490608990412245333,
                8662459463589993440,
                9703534627155947683,
                9083465368456889169,
                17385583284480619421,
                12619315429611258952,
                4780803560699965289,
                9760114025973133776,
                6710382011811335688,
                4756178837305619434,
                11338794508489062066,
                5806084365129173257,
                5858402760317423580,
                16972385428332971155,
                7980041598360573257,
                17539414382812231878,
                2807108495977968496,
                12347721638665260177,
                2657388420803290454,
                18291179742275985307,
                17290651979906283695,
                18248938193230918423,
                9700793153607985827,
                1581581530211316863,
                421641550279827055,
                3550734485990309734,
                8838675277867213091,
                2325841972611425748,
                12896051317905757266,
                2634241676839630629,
                9793375243415420023,
                4956535453535085870,
                1394001153426732084,
                12161423949049475376,
                3204414789776213360,
                3766999954663739543,
                2885444883803065223,
                17796581505208708505,
                7118003311319221436,
                11737838788253883653,
                17352638972287011361,
                6417215765954491552,
                5210838541415799099,
                14459766465462519223,
                11293780554786569855,
                3913456812295604968,
                10038604499286389380,
                83285032545623676,
                532455486041684132,
                10447557457915823565,
                13091470210751298878,
                12472561867327718392,
                14986754996345557860,
                13353714167702784729,
                14933692721559793075,
                4392496650147061013,
                14233597247368097070,
                13776324136360206128,
                2519461559911558060,
                13447307564192855696,
                17414679919154962748,
            ],
        );
        test(
            &[
                3218961335417250355,
                17081672491164411676,
                3707650621435880034,
                12226464081058805510,
                16651181251520783855,
                13640009159697172462,
                4751991872429123135,
                3148650123879180586,
                1277783667166791164,
                8130851378765417486,
                5973994279255982458,
                9850645253643520175,
                7138807895287208194,
                15375995502112115974,
                3398898578710810979,
                17572162751360544244,
                8819660083286717264,
                69135776031233389,
                9998360095371859020,
                1528928997031509791,
                12805160204156629031,
                8189615704171780683,
                2467675461409164019,
                782953727844991423,
                6355321416294201810,
                3548418573913501932,
                1385195069445654350,
                13512602943141297700,
                3524217759662463436,
                15981277851376785202,
                12068598413178807016,
                18233498041601520144,
            ],
            &[
                18165976559003511263,
                9223225080462702306,
                8750698670891994416,
                10120417502780222451,
                7032717053294267869,
                7737301656727013632,
                18225658593706260392,
                7369113716849300883,
                6897596754170972342,
                12718107066356504381,
                9547303833255868241,
                7363473626086637667,
                1289803166471838781,
                11172671997578955149,
                11576917227142009738,
                4808558430339823806,
                14087513123418218680,
                8335805388080937297,
                6817204158716710723,
                6461426422998966208,
                1365262330733891893,
                9676053381450021925,
                13152204186994838090,
                13956491013462127564,
                2322954839434490857,
                6310077930127744700,
                4095927283220333117,
                9197971078622697427,
                16090563028856198822,
                11899164972605215873,
                7553212707478476751,
                1757047503535568327,
                14107358592894281225,
            ],
            &[
                2828382444363234501,
                14019650302598222399,
                7149153771500111721,
                5808789510078375243,
                11746020933581287784,
                13963712573526024090,
                7948303882471336756,
                1363675852130084180,
                6084755510768204882,
                1350344795057047203,
                9774965847686534495,
                3240922473188564283,
                15530555198365657320,
                9503969704425173615,
            ],
            true,
            &[
                3405376264873912531,
                12732472809437054653,
                130818493222944537,
                1430180103580323943,
                11834290994594767473,
                16311544963273773940,
                14852866940109114958,
                11049173384187452405,
                17390023561952283067,
                8415736510262004193,
                7352370979091376738,
                10787900486113600253,
                15465246806979411530,
                12013049514342915482,
                15910934446693912634,
                13226375350164320552,
                12041814675416282230,
                17264487603347577556,
                8934954480948017545,
                1528928997031509791,
                12805160204156629031,
                8189615704171780683,
                2467675461409164019,
                782953727844991423,
                6355321416294201810,
                3548418573913501932,
                1385195069445654350,
                13512602943141297700,
                3524217759662463436,
                15981277851376785202,
                12068598413178807016,
                18233498041601520144,
            ],
        );
    }
}

#[test]
#[should_panic]
fn limbs_div_divide_and_conquer_approx_fail_1() {
    let ds = &[3, 4, 5, 6, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_divide_and_conquer_approx(
        &mut [10; 4],
        &mut [1, 2, 3, 4, 5, 6, 7, 8, 9],
        ds,
        inverse,
    );
}

#[test]
#[should_panic]
fn limbs_div_divide_and_conquer_approx_fail_2() {
    let ds = &[3, 4, 5, 6, 7, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_divide_and_conquer_approx(&mut [10; 4], &mut [1, 2, 3, 4, 5, 6], ds, inverse);
}

#[test]
#[should_panic]
fn limbs_div_divide_and_conquer_approx_fail_3() {
    let ds = &[3, 4, 5, 6, 7, 0x8000_0000];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_divide_and_conquer_approx(
        &mut [10, 10],
        &mut [1, 2, 3, 4, 5, 6, 7, 8, 9],
        ds,
        inverse,
    );
}

#[test]
#[should_panic]
fn limbs_div_divide_and_conquer_approx_fail_4() {
    let ds = &[3, 4, 5, 6, 7, 8];
    let inverse = limbs_two_limb_inverse_helper(ds[ds.len() - 1], ds[ds.len() - 2]);
    _limbs_div_divide_and_conquer_approx(
        &mut [10; 4],
        &mut [1, 2, 3, 4, 5, 6, 7, 8, 9],
        ds,
        inverse,
    );
}

fn verify_limbs_div_approx_2(
    qs_in: &[Limb],
    ns: &[Limb],
    ds: &[Limb],
    q_highest: bool,
    qs_out: &[Limb],
) {
    let n = Natural::from_limbs_asc(ns);
    let d = Natural::from_limbs_asc(ds);
    let (expected_q, expected_r) = (&n).div_mod(&d);
    let base_q_len = ns.len() - ds.len();
    let mut qs = qs_out[..base_q_len].to_vec();
    if q_highest {
        qs.push(1);
    }
    let q = Natural::from_owned_limbs_asc(qs);
    let q_is_too_large = q != expected_q;
    if q_is_too_large {
        assert!(q > expected_q);
        assert!(
            q - &expected_q <= 4 as Limb,
            "{:?} {:?} {:?} {:?}",
            qs_in,
            ns,
            ds,
            vec![0; _limbs_div_barrett_approx_scratch_len(ns.len(), ds.len(), 0)]
        );
        assert_eq!(expected_q * &d + expected_r, n);
    } else {
        assert_eq!(q * &d + expected_r, n);
    }
    assert_eq!(&qs_in[base_q_len..], &qs_out[base_q_len..]);
}

#[test]
fn test_limbs_div_barrett_approx() {
    let test = |qs_in: &[Limb], ns: &[Limb], ds: &[Limb], q_highest, qs_out: &[Limb]| {
        let mut qs = qs_in.to_vec();
        let mut scratch = vec![0; _limbs_div_barrett_approx_scratch_len(ns.len(), ds.len(), 0)];
        assert_eq!(
            _limbs_div_barrett_approx(&mut qs, ns, ds, &mut scratch),
            q_highest
        );
        assert_eq!(qs, qs_out);
        verify_limbs_div_approx_2(qs_in, ns, ds, q_highest, &qs);
    };
    #[cfg(feature = "32_bit_limbs")]
    {
        // q_len + 1 < d_len
        // d_len == i_len
        // !qh first time in _limbs_div_barrett_approx_preinverted
        // q_len == 0 first time in _limbs_div_barrett_approx_preinverted
        test(&[10; 3], &[1, 2], &[0, 0x8000_0000], false, &[10, 10, 10]);
        // q_len + 1 >= d_len
        // d_len != i_len
        // !cy
        // q_len != 0 first time in _limbs_div_barrett_approx_preinverted
        // q_len >= i_len in _limbs_div_barrett_approx_preinverted
        // q_len == 0 second time in _limbs_div_barrett_approx_preinverted
        // cy == 0 in _limbs_div_barrett_approx_preinverted
        test(&[10; 3], &[1, 2, 3], &[0, 0x8000_0000], false, &[8, 10, 10]);
        test(&[10; 3], &[1, 2, 3], &[3, 0x8000_0000], false, &[8, 10, 10]);
        // q_len != 0 second time in _limbs_div_barrett_approx_preinverted
        // i_len < MUL_TO_MULMOD_BNM1_FOR_2NXN_THRESHOLD in _limbs_div_barrett_approx_preinverted
        // d_len != i_len in _limbs_div_barrett_approx_preinverted
        // limbs_cmp_same_length(&rs[..d_len], &ds[..d_len]) < Ordering::Equal
        // q_len < i_len in _limbs_div_barrett_approx_preinverted
        test(
            &[10; 100],
            &[
                1940112928, 3379564708, 4199340399, 1881321211, 3929726949, 459862695, 1350630556,
                2137584308, 1243785894, 983397001, 140271427, 1266031183, 3559919295, 702977622,
                3883080853, 1830599918, 3030922777, 2650241556, 2807154392, 2218698435, 1904442293,
                2992923456, 1481791037, 4079300846, 2680084216, 656285791, 3396057405, 272065717,
                766725345, 1681255263, 1707458816, 1535744308, 3830462997, 1607479268, 3475252676,
                933054715, 4058518411, 1139150315, 1176656025, 2657461768, 3149905151, 2833828072,
                1407836276, 189062495, 3008111084, 3911286362, 3969377587, 520858887, 1921886086,
                2410034665, 1853865087, 1218625232, 3157059817, 1933332942, 1324005415, 2613648167,
                575584498, 1622716448, 2776523679, 1406325147, 1675354862, 559193409, 3342355233,
                2906475403, 692112491, 30493944, 2020871018, 3990740411, 1951624334, 522929143,
                339689612, 1674309350, 1834377980, 548522470, 1069818460, 3188037910, 3867849691,
                141774569, 2470564281, 821388456, 4277724930, 3388680598, 3502532015, 3274512650,
                734688334, 1114445519, 4090718315, 3618580673, 2579392987, 1832470019, 497126331,
                752679886, 3640533944, 1359185510, 2078361523, 766787155, 3847437498, 1508816472,
                3627438612, 1634541191, 742795696, 2960390854, 3550088312, 3226573591, 2822842868,
                3362189143, 3928024536, 2437449313, 2184757656, 3728018796, 3935919847, 948513362,
                2073970870, 135663041, 2352180020, 74067810, 2805347538, 2583013940, 2822521171,
                3940279282, 1038996723, 1890047439, 511776527, 3353284478, 2377633924, 1797661892,
                1357303377, 2035070964, 1462275246, 529813385, 240201619, 2189253653, 736920794,
            ],
            &[
                543800634, 2770754899, 3204213496, 689485059, 1826336873, 1076055628, 4272024858,
                559589670, 2749860031, 1191446963, 568428784, 3084221767, 2956512443, 3015109082,
                4142890122, 1553810981, 1616811544, 2640988818, 4239702102, 3215569246, 4002923809,
                2144877501, 1973532991, 4210632120, 245033969, 3777546533, 2341963108, 3264590407,
                2911498298, 3029909661, 3030243778, 3822448105, 3778161582, 4002513281, 405410583,
                2595147981, 1384025271, 2688968055, 1208777176, 1722256783, 1319267870, 3011578504,
                2249499744, 1245802205, 2315940873, 1685775875, 3654277152, 3113432869, 924331621,
                1024360203, 3411941166, 1488722938, 14894550, 2976848938, 1792408550, 1006468168,
                758547548, 2693569089, 268361906, 3490575936, 2248882501, 3137929560, 2509320863,
                2201587434, 926371577, 1243694325, 1112023631, 2791032478, 4081106682, 3051719441,
            ],
            false,
            &[
                2057668, 2838783492, 4112571934, 2985797927, 3502010766, 249276105, 2839050469,
                4137353790, 2017993048, 1573570544, 2879477808, 2277205117, 3638192330, 748457752,
                3491012018, 1271254053, 513425262, 1211823879, 867012819, 2598440433, 1263651369,
                2021347718, 4249300861, 2804939275, 2973559875, 4064802504, 1895088151, 3564064077,
                4027716297, 3914830075, 1990115176, 1854504344, 4070846044, 9890028, 3874191625,
                3177041731, 3239277327, 1987223315, 3008019786, 2383741649, 1213911302, 1443565130,
                976567504, 3330200204, 1895735680, 141240306, 4207639562, 4048459734, 2216965594,
                4199097617, 2357661853, 3838741723, 3334878567, 3391363083, 1245835070, 263088765,
                3602928895, 211195285, 1878503011, 3634753202, 1476824331, 2380710600, 1037136857,
                10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
                10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,
            ],
        );
        // d_len == i_len in _limbs_div_barrett_approx_preinverted
        // r != 0 in _limbs_div_barrett_approx_preinverted
        test(
            &[10; 28],
            &[
                1289672612, 59863601, 2751157317, 2012015018, 753744884, 727617566, 1322732201,
                3978203284, 2280484600, 3096956045, 3846897372, 4039916165, 3268087487, 2544740714,
                3583698031, 3555712249, 1472500374, 3434100279, 100408066, 1521129569, 3806609799,
                552198579, 2644816287, 1159339267, 3543498888, 171157498, 3510108197, 1568117536,
                1428232726, 2356104756, 64268959, 1999542893, 1166391479, 4277110967, 3494387915,
            ],
            &[
                2774518906, 1389562763, 2693574400, 665477625, 1306831105, 2326033317, 2701983394,
            ],
            true,
            &[
                1959935944, 2176722772, 2263227298, 52031251, 3734871887, 3327523565, 110124788,
                3702612244, 3495588882, 1155949119, 2274365757, 1700149681, 157693893, 1287343110,
                1404704510, 3815550465, 1225032011, 1088256607, 2172622843, 4270557118, 3435679666,
                4256455092, 679164912, 4183948729, 591513024, 2958428852, 959546540, 1259575285,
            ],
        );
    }
    #[cfg(not(feature = "32_bit_limbs"))]
    {
        // qh first time in _limbs_div_barrett_approx_preinverted
        // i_len >= MUL_TO_MULMOD_BNM1_FOR_2NXN_THRESHOLD in _limbs_div_barrett_approx_preinverted
        // wn > 0 in _limbs_div_barrett_approx_preinverted
        // limbs_cmp_same_length(&rs[..d_len], &ds[..d_len]) >= Ordering::Equal
        test(
            &[10; 100],
            &[
                2117335661666050915,
                12541399304153348003,
                946298540148951811,
                3706040940807058638,
                8245328193712015182,
                2995778607291858486,
                9642363239685223935,
                6402096640921797670,
                11712805591752250715,
                3201293761729543527,
                2067868456322875388,
                14022668248311848844,
                4632052274282811479,
                14328717146754990094,
                14774171516395200100,
                3932090441073088420,
                257112211266950213,
                8641538702124596212,
                3125093651287853737,
                17086253003900284664,
                13301324934271401692,
                17351307810524827327,
                10929578147013387375,
                15271667824914109078,
                14749348389589883650,
                6533201755640185223,
                2371674840347488671,
                4979324240277110920,
                735115859885293605,
                6735013534832335382,
                10119392873034328735,
                8587971333550618807,
                18370051728122323147,
                9585925514203520684,
                10610241536420552110,
                5468885590163205010,
                9820231198117134549,
                11691363752858795073,
                17305814922233352619,
                859726499782635315,
                191600792977201905,
                6645113919639439987,
                10186139014514132915,
                13892914247169168407,
                6236711305574503596,
                11144904233279320413,
                974401940116314268,
                626033050094744466,
                2363222200699405972,
                5179961716326453662,
                1671413606631599949,
                16140149794420865699,
                4525104777442472653,
                15677954115433676863,
                2638708390995098468,
                11988738016208980482,
                9157465979869425297,
                13700136748402110667,
                12843998927271872117,
                8172056912358636191,
                11114503332573068878,
                12203499984806198697,
                18293693840507282811,
                2347317225764209541,
                7620549999680469515,
                266221208971070149,
                7404318409115354801,
                11821070343886468455,
                16743495774393393347,
                10903651574167871901,
                8120955791898229966,
                6256918112663531036,
                4642094091398991189,
                17666442779793022150,
                6979752362584161816,
                738088006020097171,
                119461506395194534,
                2707265934504496803,
                3596152365672913357,
                14919229675768492176,
                15711892957093044137,
                4388966441873938872,
                7245386709333796615,
                977953205631793823,
                5781210341467685855,
                5753014960288580146,
                15207218610262659062,
                4952531357988639834,
                15654095960314850064,
                16211757785947051034,
                1847823176222065635,
                13267820071825624266,
                7825351897308816877,
                2314230949902785215,
                13036201409691464885,
                6084371089556728596,
                4297442532874624612,
                532433185229873311,
                3442779195445707888,
                2185935771567302024,
                13911571822971487392,
                6709028122157209948,
                8941147419783910451,
                10057960523899590670,
                3902932452596575823,
                18330616827289950879,
                16003030155941114765,
                14460484829934394726,
                3301932590566986553,
                2576945510271437558,
                338533333586368208,
                17133311687376929054,
                15155994049404735760,
                9946561124819597870,
                983339636912873569,
                7933316580780536493,
                10915381430875882064,
                12068808550152064359,
                1144295877076351834,
                6170469241760056335,
                1371470265702819753,
                8726850576136926792,
                10647848489928733096,
                8768829048069168648,
                13771635456188648954,
                17554939941431219329,
                9462385985825033541,
                748159237152854524,
                14199895651244313572,
                9044210482484213648,
                3880401870711113518,
                1694971440240542063,
                13547801197479934494,
            ],
            &[
                6673567349177488920,
                11342960606651398230,
                13810764753596302625,
                9212178722694740287,
                18084527251132181489,
                16224438820695147876,
                14021309035811827770,
                13013362906859690434,
                16417289605410335662,
                17190663644106068759,
                11146075708059454647,
                11549029857422506456,
                7397036559618436638,
                12934631186266104928,
                5350679730075628553,
                7240352255165061152,
                13372092351570783845,
                4399593574620862254,
                6394016331529930198,
                12785468835634740198,
                4322747866783581276,
                11568791147039875250,
                14991909491573471557,
                13477304839860990623,
                9455746029240930041,
                5341626453207818831,
                11987393219164946170,
                4239560960510469879,
                1182652798618482486,
                3574433530016984198,
                14570885001650188449,
                16721218276523736662,
                17582595396154395868,
                10645279465349745085,
                8467600286036697431,
                1335601409485137284,
                5427053117344459552,
                3050086815044747081,
                16544140034308828175,
                16944072159927844572,
                1776035917115670079,
                6854263689321209087,
                1395326973393056556,
                13328497288435313800,
                9104953879994634550,
                13847967313738589938,
                2043265995513605223,
                13193995464379134227,
                5009710316527156329,
                14279264770257730496,
                10408308917163910844,
                5580572910800173671,
                3609059974654018173,
                8878539685629369010,
                15620596077589725028,
                3646029498286920979,
                16172850651808491619,
                15245408082837971190,
                4561308773951735888,
                11261441942590830857,
                14221474405402406790,
                2504490064796610713,
                17165895347857529984,
                12091565718300353127,
                14873026879861808494,
                7208276890744094311,
                13958391986410864884,
                8096376858901544433,
                18161016816080485352,
                9946585096298233506,
            ],
            true,
            &[
                7142549011416014880,
                14684691169135507473,
                1822120729679146161,
                11841933122038769821,
                4526355225639296177,
                8468787586279727777,
                15714230407431964682,
                18333537779008451159,
                16040493219692071303,
                2049960712985714117,
                18060699260844232006,
                11436218371188111964,
                18247749997104652519,
                10208028585116703246,
                6519062707001442120,
                8663593385407998358,
                9429327332580418592,
                11147294715178482267,
                12622325713357218079,
                9917628001464406797,
                8948638694752077597,
                413202514200140930,
                13469381266876650437,
                10995920589784133757,
                10156568832733545237,
                7515628739788185693,
                3313803886141758450,
                16133860033309869788,
                13595249790827433309,
                1761826376674293671,
                9950121844277925507,
                7711011638364466454,
                12239101884168908635,
                9962222649144848616,
                9495651849838993161,
                10726943428780681871,
                3103236698633674082,
                18053635426183322245,
                14277576247420605289,
                17591792639916063380,
                11239385027227950840,
                4103032036605369386,
                266316975199678275,
                4262765348359631356,
                5507126713842059802,
                8339639832375105582,
                9642119792134182293,
                485127249403759007,
                3452585660397695342,
                17804977833202015222,
                1531864037104263565,
                12597964144177527097,
                2015301325553239081,
                1705158706504614015,
                3632321048208706170,
                2599148812642503905,
                18033201044296677048,
                10122148881615284352,
                12336433997173007311,
                8939795914080226824,
                9195323771605999386,
                1966840646595138765,
                6678745632744258779,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
                10,
            ],
        );
    }
}

#[test]
#[should_panic]
fn limbs_div_barrett_approx_fail_1() {
    let ns = &[1, 2];
    let ds = &[0x8000_0000];
    let mut scratch = vec![0; _limbs_div_barrett_approx_scratch_len(ns.len(), ds.len(), 0)];
    _limbs_div_barrett_approx(&mut [10, 10, 10], ns, ds, &mut scratch);
}

#[test]
#[should_panic]
fn limbs_div_barrett_approx_fail_2() {
    let ns = &[1];
    let ds = &[0, 0x8000_0000];
    let mut scratch = vec![0; _limbs_div_barrett_approx_scratch_len(ns.len(), ds.len(), 0)];
    _limbs_div_barrett_approx(&mut [10, 10, 10], ns, ds, &mut scratch);
}

#[test]
#[should_panic]
fn limbs_div_barrett_approx_fail_3() {
    let ns = &[1, 2];
    let ds = &[0, 1];
    let mut scratch = vec![0; _limbs_div_barrett_approx_scratch_len(ns.len(), ds.len(), 0)];
    _limbs_div_barrett_approx(&mut [10, 10, 10], ns, ds, &mut scratch);
}

#[test]
#[should_panic]
fn limbs_div_barrett_approx_fail_4() {
    let ns = &[1, 2, 3, 4];
    let ds = &[0, 0x8000_0000];
    let mut scratch = vec![0; _limbs_div_barrett_approx_scratch_len(ns.len(), ds.len(), 0)];
    _limbs_div_barrett_approx(&mut [10], ns, ds, &mut scratch);
}

#[test]
fn test_div() {
    let test = |u, v, quotient| {
        let mut x = Natural::from_str(u).unwrap();
        x /= Natural::from_str(v).unwrap();
        assert!(x.is_valid());
        assert_eq!(x.to_string(), quotient);

        let mut x = Natural::from_str(u).unwrap();
        x /= &Natural::from_str(v).unwrap();
        assert!(x.is_valid());
        assert_eq!(x.to_string(), quotient);

        let q = Natural::from_str(u).unwrap() / Natural::from_str(v).unwrap();
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);

        let q = Natural::from_str(u).unwrap() / &Natural::from_str(v).unwrap();
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);

        let q = &Natural::from_str(u).unwrap() / Natural::from_str(v).unwrap();
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);

        let q = &Natural::from_str(u).unwrap() / &Natural::from_str(v).unwrap();
        assert!(q.is_valid());
        assert_eq!(q.to_string(), quotient);

        let q = BigUint::from_str(u).unwrap() / &BigUint::from_str(v).unwrap();
        assert_eq!(q.to_string(), quotient);

        let q = rug::Integer::from_str(u).unwrap() / rug::Integer::from_str(v).unwrap();
        assert_eq!(q.to_string(), quotient);

        let q = Natural::from_str(u)
            .unwrap()
            .div_mod(Natural::from_str(v).unwrap())
            .0;
        assert_eq!(q.to_string(), quotient);
    };
    test("0", "1", "0");
    test("0", "123", "0");
    test("1", "1", "1");
    test("123", "1", "123");
    test("123", "123", "1");
    test("123", "456", "0");
    test("456", "123", "3");
    test("4294967295", "1", "4294967295");
    test("4294967295", "4294967295", "1");
    test("1000000000000", "1", "1000000000000");
    test("1000000000000", "3", "333333333333");
    test("1000000000000", "123", "8130081300");
    test("1000000000000", "4294967295", "232");
    test(
        "1000000000000000000000000",
        "1",
        "1000000000000000000000000",
    );
    test("1000000000000000000000000", "3", "333333333333333333333333");
    test("1000000000000000000000000", "123", "8130081300813008130081");
    test("1000000000000000000000000", "4294967295", "232830643708079");
    test("1000000000000000000000000", "1234567890987", "810000006723");
    test(
        "100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\
        0",
        "1234567890987654321234567890987654321",
        "810000006723000055638900467181273922269593923137018654",
    );
    test(
        "100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\
        0",
        "316049380092839506236049380092839506176",
        "3164062526261718967339454949926851258865601262253979",
    );
    test(
        "253640751230376270397812803167",
        "2669936877441",
        "94998781946290113",
    );
    test("3768477692975601", "11447376614057827956", "0");
    test("3356605361737854", "3081095617839357", "1");
    test("1098730198198174614195", "953382298040157850476", "1");
    test(
        "69738658860594537152875081748",
        "69738658860594537152875081748",
        "1",
    );
    test(
        "1000000000000000000000000",
        "1000000000000000000000000",
        "1",
    );
    test("0", "1000000000000000000000000", "0");
    test("123", "1000000000000000000000000", "0");
}

#[test]
#[should_panic]
fn div_assign_fail() {
    let mut x = Natural::from(10u32);
    x /= Natural::ZERO;
}

#[test]
#[should_panic]
fn div_assign_ref_fail() {
    let mut x = Natural::from(10u32);
    x /= &Natural::ZERO;
}

#[test]
#[should_panic]
#[allow(unused_must_use)]
fn div_fail() {
    Natural::from(10u32) / Natural::ZERO;
}

#[test]
#[should_panic]
#[allow(unused_must_use)]
fn div_val_ref_fail() {
    Natural::from(10u32) / &Natural::ZERO;
}

#[test]
#[should_panic]
#[allow(unused_must_use)]
fn div_ref_val_fail() {
    &Natural::from(10u32) / Natural::ZERO;
}

#[test]
#[should_panic]
#[allow(unused_must_use)]
fn div_ref_ref_fail() {
    &Natural::from(10u32) / &Natural::ZERO;
}

#[test]
fn limbs_div_schoolbook_properties() {
    test_properties(
        quadruples_of_three_unsigned_vecs_and_unsigned_var_1,
        |(ref qs_in, ref ns_in, ref ds, inverse)| {
            let mut qs = qs_in.clone();
            let mut ns = ns_in.clone();
            let q_highest = _limbs_div_schoolbook(&mut qs, &mut ns, ds, *inverse);
            verify_limbs_div(qs_in, ns_in, ds, q_highest, &qs);
        },
    );
}

#[test]
fn limbs_div_divide_and_conquer_properties() {
    test_properties(
        quadruples_of_three_unsigned_vecs_and_unsigned_var_2,
        |(ref qs_in, ref ns_in, ref ds, inverse)| {
            let mut qs = qs_in.clone();
            let mut ns = ns_in.clone();
            let q_highest = _limbs_div_divide_and_conquer(&mut qs, &mut ns, ds, *inverse);
            verify_limbs_div(qs_in, ns_in, ds, q_highest, &qs);
        },
    );
}

#[test]
fn limbs_div_schoolbook_approx_properties() {
    test_properties(
        quadruples_of_three_unsigned_vecs_and_unsigned_var_1,
        |(ref qs_in, ref ns_in, ref ds, inverse)| {
            let mut qs = qs_in.clone();
            let mut ns = ns_in.clone();
            let q_highest = _limbs_div_schoolbook_approx(&mut qs, &mut ns, ds, *inverse);
            verify_limbs_div_approx(qs_in, ns_in, ds, q_highest, &qs);
        },
    );
}

#[test]
fn limbs_div_divide_and_conquer_approx_properties() {
    test_properties_custom_scale(
        128,
        quadruples_of_three_unsigned_vecs_and_unsigned_var_2,
        |(ref qs_in, ref ns_in, ref ds, inverse)| {
            let mut qs = qs_in.clone();
            let mut ns = ns_in.clone();
            let q_highest = _limbs_div_divide_and_conquer_approx(&mut qs, &mut ns, ds, *inverse);
            verify_limbs_div_approx(qs_in, ns_in, ds, q_highest, &qs);
        },
    );
}

#[test]
fn limbs_div_barrett_approx_properties() {
    test_properties_custom_scale(
        512,
        triples_of_unsigned_vec_var_41,
        |(ref qs_in, ref ns, ref ds)| {
            let mut qs = qs_in.clone();
            let mut scratch = vec![0; _limbs_div_barrett_approx_scratch_len(ns.len(), ds.len(), 0)];
            let q_highest = _limbs_div_barrett_approx(&mut qs, &ns, ds, &mut scratch);
            verify_limbs_div_approx_2(qs_in, ns, ds, q_highest, &qs);
        },
    );
}

fn div_properties_helper(x: &Natural, y: &Natural) {
    let mut mut_x = x.clone();
    mut_x /= y;
    assert!(mut_x.is_valid());
    let quotient = mut_x;

    let mut mut_x = x.clone();
    mut_x /= y.clone();
    let quotient_alt = mut_x;
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);

    let quotient_alt = x / y;
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);

    let quotient_alt = x / y.clone();
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);

    let quotient_alt = x.clone() / y;
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);

    let quotient_alt = x.clone() / y.clone();
    assert!(quotient_alt.is_valid());
    assert_eq!(quotient_alt, quotient);

    let quotient_alt = x.div_mod(y).0;
    assert_eq!(quotient_alt, quotient);

    let num_quotient = natural_to_biguint(x) / &natural_to_biguint(y);
    assert_eq!(biguint_to_natural(&num_quotient), quotient);

    let rug_quotient = natural_to_rug_integer(x) / natural_to_rug_integer(y);
    assert_eq!(rug_integer_to_natural(&rug_quotient), quotient);

    let remainder = x - &quotient * y;
    assert!(remainder < *y);
    assert_eq!(quotient * y + remainder, *x);
}

#[test]
fn div_properties() {
    test_properties_custom_scale(
        512,
        pairs_of_natural_and_positive_natural,
        |&(ref x, ref y)| {
            div_properties_helper(x, y);
        },
    );

    test_properties_custom_scale(
        512,
        pairs_of_natural_and_positive_natural_var_1,
        |&(ref x, ref y)| {
            div_properties_helper(x, y);
        },
    );

    test_properties(naturals, |n| {
        assert_eq!(n / Natural::ONE, *n);
    });

    test_properties(positive_naturals, |n| {
        assert_eq!(n / n, Natural::ONE);
        assert_eq!(Natural::ZERO / n, Natural::ZERO);
        if *n > 1 as Limb {
            assert_eq!(Natural::ONE / n, Natural::ZERO);
        }
    });
}
